(function(){function __addNamespace(t,e){for(k in e)t[k]||(t[k]={}),__addNamespace(t[k],e[k])}var __bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1},__extends=function(t,e){function r(){this.constructor=t}for(var n in e)__hasProp.call(e,n)&&Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n));return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};__addNamespace(this,{cms:{ui:{attributes:{},tag:{attributes:{}},tags:{form:{},"interface":{},visualizer:{}}},core:{}},slikland:{mara:{}}}),cms.ui.Base=function(){function t(){this._instances=[],this._plugins={}}return t.prototype.update=function(){var t,e,r,n,i,s,o,a,l,h,u,c,d;if(this.constructor.SELECTOR){for(i=document.body.querySelectorAll(this.constructor.SELECTOR),n=[],c=0,d=i.length;d>c;c++)r=i[c],r.matches("[cloned]")||n.push(r);for(s=n.length,e=[],l=[],u=[],t=0,a=0,h=0;s-->0;)r=n[s],(o=this._instances.indexOf(r))>=0?(u[h++]=this._instances[o],this._instances.splice(o,1)):e[t++]=r;return l=[].concat(this._instances),this._instances=[].concat(e,u),this._update({add:e,remove:l,unchanged:u,current:n})}},t.prototype._update=function(){throw new Error("Please override this method.")},t}();var Debug,__slice=[].slice;Debug=function(){function Debug(){}return Debug.debug=!1,Debug.light=4764196,Debug.dark=2884445,Debug.init=function(){var err,re,_ref;Debug._console=window.console;try{Debug._log=Function.prototype.bind.call(null!=(_ref=Debug._console)?_ref.log:void 0,Debug._console)}catch(_error){err=_error}return null==window.Debug&&(window.Debug=Debug),Debug.check()||eval("window[Math.random()]()"),re=new RegExp(/debug=(1|true)/i),Debug.debug=re.test(window.location.search),re=new RegExp(/debug=(0|false)/i),Debug.debug||re.test(window.location.search)||(re=new RegExp(/([\.|\/]local\.|localhost|127\.0\.0\.1|192\.\d+\.\d+\.\d+|dev\.slikland\.)/i),Debug.debug=re.test(window.location.href)),Debug.debug&&window.console?void 0:window.console={assert:function(){},clear:function(){},count:function(){},debug:function(){},dir:function(){},dirxml:function(){},error:function(){},exception:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){},info:function(){},log:function(){},profile:function(){},profileEnd:function(){},table:function(){},time:function(){},timeEnd:function(){},timeStamp:function(){},trace:function(){},warn:function(){}}},Debug.check=function(t){var e,r,n,i;for(null==t&&(t=null),n="",e="",r=this.light;r>0;)e=String.fromCharCode(255&r)+e,r>>=8;for(n+=btoa(e),e="",r=this.dark;r>0;)e=String.fromCharCode(255&r)+e,r>>=8;return n+=btoa(e),i=n.toLowerCase(),t?i===t.toLowerCase():"s"===i.charAt(0)&&"l"===i.charAt(1)},Debug.log=function(){if(null!=Debug._log)return"function"==typeof Debug._log?Debug._log.apply(Debug,arguments):void 0;try{return console.log.apply(console,arguments)}catch(t){}},Debug.logTime=function(){var t,e,r,n,i,s;for(t=1<=arguments.length?__slice.call(arguments,0):[],i=(new Date).getTime(),this.itm||(this.itm=this.ctm=i),r=i-this.ctm,s=r.toString();s.length<6;)s=" "+s;for(e=s+"|",s=(this.ctm-this.itm).toString();s.length<6;)s=" "+s;return e+=s,e=["%c"+e+":"],n="font-weight: bold;",r>100?n+="color: red;":r>50&&(n+="color: orange;"),e.push(n),Debug.log.apply(this,[].concat(e,t)),this.ctm=i},Debug}(),window.atob||(window.atob=function(t){var e,r,n,i,s,o,a,l,h,u,c;for(l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=t.length,h=0,c="";u>h;)i=t.charAt(h),s=t.charAt(h+1),o=t.charAt(h+2),a=t.charAt(h+3),i=l.indexOf(i),s=l.indexOf(s),o=l.indexOf(o),a=l.indexOf(a),0>o&&(o=0),0>a&&(a=0),e=i<<2&255|s>>4,r=s<<4&255|o>>2,n=o<<6&255|63&a,c+=String.fromCharCode(e),c+=String.fromCharCode(r),c+=String.fromCharCode(n),h+=4;return c},window.btoa=function(t){var e,r,n,i,s,o,a,l,h,u,c;for(l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=t.length,h=0,c="";u>h;)e=255&t.charCodeAt(h+0),r=255&t.charCodeAt(h+1),n=255&t.charCodeAt(h+2),i=e>>2&63,s=63&(e<<4|r>>4),o=63&(r<<2|n>>6),a=63&n,c+=l.charAt(i)+l.charAt(s)+l.charAt(o)+l.charAt(a),h+=3;return h=u%3,u=c.length,1===h?c=c.substr(0,u-2)+"==":2===h&&(c=c.substr(0,u-1)+"="),c}),window.Debug=Debug,Debug.init();var isIE,__scopeIE8;isIE=function(){var t;return t=navigator.userAgent.toLowerCase(),-1!==t.indexOf("msie")?parseInt(t.split("msie")[1]):!1},8===isIE()&&(__scopeIE8=document.createElement("IE8_"+Math.random())),Function.prototype["const"]=function(t){var e,r,n,i;i=__scopeIE8?__scopeIE8:this;for(e in t)n=t[e],r={},r.get=function(){return n},r.set=function(){throw new Error("Can't set const "+e)},r.configurable=!0,r.enumerable=!0,Object.defineProperty(i,e,r);return null},Function.prototype.get=function(t,e){var r,n,i,s;r=!1,e?(r=!0,s=t):(e=t,s=__scopeIE8?__scopeIE8:this.prototype);for(i in e)n=e[i],Object.defineProperty(s,i,{get:n,configurable:!0,enumerable:r});return null},Function.prototype.set=function(t,e){var r,n,i,s;r=!1,e?(r=!0,s=t):(e=t,s=__scopeIE8?__scopeIE8:this.prototype);for(n in e)i=e[n],Object.defineProperty(s,n,{set:i,configurable:!0,enumerable:r});return null},"bind"in Function.prototype||(Function.prototype.bind=function(t){var e,r;return r=this,arguments_.length<=1?function(){return r.apply(t,arguments_)}:(e=Array.prototype.slice.call(arguments_,1),function(){return r.apply(t,0===arguments_.length?e:e.concat(Array.prototype.slice.call(arguments_)))})}),String.prototype.trim=function(t){return null==t&&(t=null),this.ltrim(t).rtrim(t)},String.prototype.ltrim=function(t){var e;return null==t&&(t=null),t||(t="\\s"),e=new RegExp("^"+t+"*"),e.global=!0,e.multiline=!0,this.replace(e,"")},String.prototype.rtrim=function(t){var e;return null==t&&(t=null),t||(t="\\s"),e=new RegExp(t+"*$"),e.global=!0,e.multiline=!0,this.replace(e,"")},String.prototype.padLeft=function(t,e){var r;for(null==e&&(e=" "),0===e.length&&(e=" "),r=this;r.length<t;)r=e+r;return r},String.prototype.padRight=function(t,e){var r;for(null==e&&(e=" "),0===e.length&&(e=" "),r=this;r.length<t;)r+=e;return r},"isArray"in Array.prototype||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(t,e){var r;for(void 0===e&&(e=0),0>e&&(e+=this.length),0>e&&(e=0),r=this.length;r>e;){if(e in this&&this[e]===t)return e;e++}return-1}),"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(t,e){for(void 0===e&&(e=this.length-1),0>e&&(e+=this.length),e>this.length-1&&(e=this.length-1),e++;e-->0;)if(e in this&&this[e]===t)return e;return-1}),"forEach"in Array.prototype||(Array.prototype.forEach=function(t,e){var r,n,i;for(r=0,n=this.length,i=[];n>r;)r in this&&t.call(e,this[r],r,this),i.push(r++);return i}),"map"in Array.prototype||(Array.prototype.map=function(t,e){var r,n,i;for(i=new Array(this.length),r=0,n=this.length;n>r;)r in this&&(i[r]=t.call(e,this[r],r,this)),r++;return i}),"filter"in Array.prototype||(Array.prototype.filter=function(t,e){var r,n,i,s;for(i=[],s=void 0,r=0,n=this.length;n>r;)r in this&&t.call(e,s=this[r],r,this)&&i.push(s),r++;return i}),"every"in Array.prototype||(Array.prototype.every=function(t,e){var r,n;for(r=0,n=this.length;n>r;){if(r in this&&!t.call(e,this[r],r,this))return!1;r++}return!0}),"some"in Array.prototype||(Array.prototype.some=function(t,e){var r,n;for(r=0,n=this.length;n>r;){if(r in this&&t.call(e,this[r],r,this))return!0;r++}return!1}),Node.prototype.on=Node.prototype.addEventListener,Node.prototype.off=Node.prototype.removeEventListener,Node.prototype.trigger=function(t,e){var r;return r=new Event(t),r.data=e,this.dispatchEvent(r)},null==navigator.mediaDevices&&(navigator.mediaDevices={}),navigator.getUserMedia=navigator.mediaDevices.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var EventDispatcher;EventDispatcher||(EventDispatcher=function(){function t(){this._triggerStacked=__bind(this._triggerStacked,this),this.trigger=__bind(this.trigger,this)}return t.prototype._events=null,t.prototype.on=function(t,e){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),__indexOf.call(this._events[t],e)>=0?void 0:this._events[t].unshift(e)},t.prototype.off=function(t,e){var r,n;if(null==t&&(t=null),null==e&&(e=null),!this._events)return void(this._events={});if(null!=t&&Boolean(this._events[t])){if(r=this._events[t],e){for(;(n=r.indexOf(e))>=0;)r.splice(n,1);return this._events[t]=r}return this._events[t].length=0}return this._events={}},t.prototype.trigger=function(t,e,r,n){var i,s,o,a,l,h,u,c;if(null==e&&(e=null),null==r&&(r=null),null==n&&(n=null),Array.isArray(t))for(h=0,u=t.length;u>h;h++)i=t[h],this.trigger(t,e);else if(this._events||(this._events={}),s=this._events[t],s&&0!==s.length){if(r||(r=this),i={type:t,target:r,currentTarget:this,originalEvent:n},null!=n&&(i.preventDefault=function(){return"function"==typeof n.preventDefault?n.preventDefault():void 0},i.stopPropagation=function(){return"function"==typeof n.stopPropagation?n.stopPropagation():void 0}),"object"==typeof e)for(a in e)l=e[a],i[a]||(i[a]=l);for(o=s.length,c=[];o-->0;)c.push("function"==typeof s[o]?s[o](i,e):void 0);return c}},t.prototype.hasEvent=function(t,e){var r;if(!this._events)return void(this._events={});for(r in this._events)if(r===t&&this._events[r].indexOf(e)>-1)return!0;return!1},t.prototype.stackTrigger=function(t,e,r){return null==e&&(e=null),null==r&&(r=null),this._stackTriggerer||(this._stackTriggerer=[]),this._stackTriggerer.push([t,e,r]),clearTimeout(this._stackTriggerTimeout),this._stackTriggerTimeout=setTimeout(this._triggerStacked,0)},t.prototype._triggerStacked=function(){var t,e;for(e=this._stackTriggerer.length,t=-1;++t<e;)this.trigger.apply(this,this._stackTriggerer[t]);return this._stackTriggerer.length=0},t}());var App,app,windowLoaded;App=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.project_version_raw="SL_PROJECT_VERSION:1.1.0",e.project_date_raw="SL_PROJECT_DATE:1480954286745",e.FRAMEWORK_VERSION="2.2.15",e.prototype.getInfo=function(){var t;return t={},t.versionRaw=void 0===e.project_version_raw||"undefined"===e.project_version_raw?"SL_PROJECT_VERSION:Not versioned":e.project_version_raw,t.version=t.versionRaw.replace("SL_PROJECT_VERSION:",""),t.lastUpdateRaw=void 0===e.project_date_raw||"undefined"===e.project_date_raw?"SL_PROJECT_DATE:Not versioned":e.project_date_raw,t.lastUpdate=new Date(parseFloat(t.lastUpdateRaw.replace("SL_PROJECT_DATE:",""))),t},e.prototype._checkWindowActivity=function(){var t,e,r,n;return this._hidden="hidden",t=this._hidden,__indexOf.call(document,t)>=0?document.addEventListener("visibilitychange",this._windowVisibilityChange):(e=this._hidden="mozHidden",__indexOf.call(document,e)>=0?document.addEventListener("mozvisibilitychange",this._windowVisibilityChange):(r=this._hidden="webkitHidden",__indexOf.call(document,r)>=0?document.addEventListener("webkitvisibilitychange",this._windowVisibilityChange):(n=this._hidden="msHidden",__indexOf.call(document,n)>=0?document.addEventListener("msvisibilitychange",this._windowVisibilityChange):__indexOf.call(document,"onfocusin")>=0?document.onfocusin=document.onfocusout=this._windowVisibilityChange:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=this._windowVisibilityChange))),void 0!==document[this._hidden]?this._windowVisibilityChange.call(window,{type:document[this._hidden]?"blur":"focus"}):void 0},e.prototype._windowVisibilityChange=function(t){var e,r,n,i,s,o,a,l;a="visible",i="hidden",n={focus:!1,focusin:!1,pageshow:!1,blur:!0,focusout:!0,pagehide:!0},t=t||window.event,l=t.type,s=__indexOf.call(n,l)>=0?n[t.type]:document[this._hidden],r=s?"windowInactive":"windowActive";try{return this.dispatchEvent(new Event(r))}catch(h){return e=h,o=document.createEvent("Event"),o.initEvent(r,!0,!0),this.dispatchEvent(o)}},e}(EventDispatcher),app||(app=new App),windowLoaded=function(){return function(){return window.remove?window.remove("load",windowLoaded):window.detachEvent?window.detachEvent("onload",windowLoaded):window.onload=null,app.trigger("windowLoad")}}(this),window.addEventListener?window.addEventListener("load",windowLoaded):window.attachEvent?window.attachEvent("onload",windowLoaded):window.onload=windowLoaded;var NavigationRouter;NavigationRouter=function(t){function e(){this._onPathChange=__bind(this._onPathChange,this),this._routes=[],this._numRoutes=0,this._trigger=!0,e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.CHANGE="route_path_change",e.CHANGE_ROUTE="route_match",e.prototype.setup=function(t,e){var r,n,i,s;if(null==t&&(t=null),null==e&&(e=!1),!t){t=window.location.href;try{r=document.getElementsByTagName("base"),r.length>0&&(r=r[0],t=r.getAttribute("href"))}catch(o){n=o,console.log(n.stack)}}return this._rootPath=t.replace(/^(.*?)\/*$/,"$1/"),this._rawPath="",this._usePushState=e?!1:null!=("undefined"!=typeof window&&null!==window&&null!=(s=window.history)?s.pushState:void 0),this._usePushState?(this._rootPath!==window.location.href&&(i=this._getPath(),this.goto(i,!1)),window.addEventListener?window.addEventListener("popstate",this._onPathChange):window.attachEvent("onpopstate",this._onPathChange)):(this._rootPath!==window.location.href&&(i=this._getPath(),window.location=this._rootPath+"#!/"+i),window.addEventListener?window.addEventListener("hashchange",this._onPathChange):window.attachEvent("onhashchange",this._onPathChange)),this._onPathChange(),this},e.prototype._getPath=function(){var t;return t=window.location.href.replace(/\/*$/g,""),0===t.indexOf(this._rootPath.replace(/\/*$/g,""))&&(t=t.substr(this._rootPath.length)),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1")},e.prototype._parsePath=function(t){var e,r,n;return n=/^(?:#?!?\/*)([^?]*)\??(.*?)$/.exec(t),r=n[1],e=this._parseParams(n[2]),{rawPath:t,path:r,params:e}},e.prototype._parseParams=function(t){var e,r,n,i;if(i={},t)for(n=/&?([^=&]+)=?([^=&]*)/g,e=0;r=n.exec(t);)i[r[1]]=r[2];return i},e.prototype._onPathChange=function(t){return null==t&&(t=null),this._currentPath=this._getPath(),this._trigger&&this._triggerPath(this._currentPath),this._trigger=!0,this._replaceData?(this.goto(this._replaceData[0],!1),this._replaceData=null):this.trigger(e.CHANGE,this._parsePath(this._currentPath)),!1},e.prototype._triggerPath=function(t){var r,n,i,s,o,a;if(n=this._parsePath(t),a=this._checkRoutes(n.path),o=a[0],s=a[1],o)for(r=o.length;r-->0;)i=o[r],this.trigger(e.CHANGE_ROUTE,{route:i.route,routeData:s,path:t,pathData:n,data:i.data});return!1},e.prototype.getCurrentPath=function(){return this._currentPath},e.prototype.getParsedPath=function(){return this._parsePath(this._currentPath)},e.prototype.goto=function(t,e){return null==e&&(e=!0),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1"),t!==this._currentPath?(this._currentPath=t,this._trigger=e,this._usePushState?(history.pushState({},t,this._rootPath+t),this._trigger&&this._onPathChange(),this._trigger=!0):window.location.hash="!/"+t,!1):void 0},e.prototype.replace=function(t,e){return null==e&&(e=!1),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1"),t!==this._currentPath&&(this._currentPath=t,this._usePushState?history.replaceState({},t,this._rootPath+t):(this._trigger=!1,history.back(),this._replaceData=[t])),e&&this.triggerPath(t),!1},e.prototype.triggerPath=function(t){return this._triggerPath(t),!1},e.prototype.triggerCurrentPath=function(){return this._triggerPath(this._getPath()),!1},e.prototype.addRoute=function(t,e){var r,n,i,s,o,a,l;if(null==e&&(e=null),"string"!=typeof t)for(n=t.length;n-->0;)this.addRoute(t[n],e);for(a=/\{(.*?)\}/g,i=[],o=0;s=a.exec(t);)i[o++]=s[1];a=t,"*"===a&&(a=".*");try{a=a.replace(/(.*?)\/*$/,"$1"),l=new RegExp("(?:"+a.replace(/\{.*?\}/g,"(.+?)")+"$)","g")}catch(h){return r=h,void console.log(r.stack)}return this._routes[this._numRoutes++]={data:e,route:t,routeRE:l,labels:i,numLabels:i.length,numSlashes:t.split("/").length},this._routes.sort(this._sortRoutes),!1},e.prototype.removeRoute=function(t){var e,r;for(e=this._numRoutes;e-->0;)r=this._routes[e],r.route===t&&this._routes.splice(e,1);return this._numRoutes=this._routes.length,!1},e.prototype.removeAllRoutes=function(){return this._routes.length=0,this._numRoutes=this._routes.length},e.prototype._checkRoutes=function(t){var e,r,n,i,s,o,a,l,h,u,c,d,_,p;for(n=this._numRoutes,r=null,e=null,h=[],u=0,t="/"+t;n-->0;){if(l=this._routes[n],r){if(l.route!==r)break;h[u++]=l}if(a=l.routeRE,a.lastIndex=0,o=a.exec(t))for(e={},h[u++]=l,r=l.route,p=l.labels,i=d=0,_=p.length;_>d;i=++d)s=p[i],c=o[i+1],e[s]=c}return[h,e]},e.prototype._sortRoutes=function(t,e){return t.numLabels<e.numLabels?-1:t.numLabels>e.numLabels?1:t.numSlashes<e.numSlashes?-1:t.numSlashes>e.numSlashes?1:t.route===e.route?0:t.route<e.route?-1:t.route>e.route?1:0},e.prototype._getParams=function(){var t,e,r,n,i;n=this._parsePath(this._currentPath),r=n.params;for(e in r){i=r[e],i=decodeURIComponent(i);try{t=JSON.parse(i),"string"!=typeof t&&(i=t)}catch(s){}r[e]=i}return r},e.prototype._setParams=function(t){var e,r,n,i,s;i=this._parsePath(this._currentPath),r=[];for(e in t){s=t[e];try{"string"!=typeof s&&(s=JSON.stringify(s))}catch(o){}r.push(e+"="+encodeURIComponent(s)),t[e]=s}return n=i.path,r.length>0&&(n=n+"?"+r.join("&")),this.replace(n)},e.prototype.getParam=function(t){var e;return e=this._getParams(),e[t]},e.prototype.setParam=function(t,e){var r;return r=this._getParams(),r[t]=e,this._setParams(r)},e.prototype.removeParam=function(t){var e;return e=this._getParams(),e[t]=null,delete e[t],this._setParams(e)},e}(EventDispatcher);var KTObject,KTween;KTween=function(){function t(){}return t.tweenTypes={},t.numValues=100,t.inited=!1,t.items=[],t.queued=[],t.numQueued=0,t.numItems=0,t.index=0,t.div=1/16777215,t.init=function(t){return this.timeout=null!=t?t:1e3/60,this.inited?void 0:(this.initTime=(new Date).getTime(),setInterval(this.update,this.timeout),this.inited=!0)},t.update=function(){var e,r,n,i,s,o,a,l,h,u,c,d,_,p,f;for(c=(new Date).getTime()-t.initTime,a=t.numQueued;a-->0;)t.queued[a].initTime<=c&&(t.numQueued--,t.numItems++,t.queued[a].init(),t.items.push(t.queued.splice(a,1)[0]));for(a=t.numItems,f=[];a-->0;)if(r=!1,o=t.items[a]){for(d=o.target,_=(c-o.initTime)*o.iDuration,0>_&&(_=0),_>1&&(_=1),p=t.tweenTypes[o.transition][0],n=t.tweenTypes[o.transition][1],h=_*t.numValues,e=h>>0,h=(p[e]+n[e]*(h-e))*t.div,l=o.numParams,u=o.params,i=o.distances,s=o.initValues;l-->0;)d[u[l]]=i[l]*h+s[l];o.onUpdate&&(u=o.onUpdateParams,o.onUpdate.apply(o.target,u)),1===_?(t.numItems--,t.items.splice(a,1),o.onComplete&&void 0!==o.onComplete?(u=o.onCompleteParams,u||(u=[]),f.push(o.onComplete.apply(o.target,u))):f.push(void 0)):f.push(void 0)}return f},t.tween=function(t,e,r,n,i){var s,o;return null==r&&(r="linear"),null==n&&(n=0),null==i&&(i=0),this.inited||this.init(),this.tweenTypes[r]||this.populateEasing(r),o=(new Date).getTime()-this.initTime+1e3*i>>0,s=new KTObject(this.index++,t,o,1e3*n>>0,e,r),0===i?(s.init(),this.numItems++,this.items.push(s)):(this.numQueued++,this.queued.push(s))},t.populateEasing=function(e){var r,n,i,s,o,a,l,h;if(n=t[e]){for(l=[],r=[],s=this.numValues,i=h=0;s>=0?s>h:h>s;i=s>=0?++h:--h)a=l[i]=n(i,0,16777215,s)+.5>>0,i>0&&(r[i-1]=a-o),o=a;return l[s]=16777215,l[s+1]=0,r[s-1]=16777215-o,r[s]=0,this.tweenTypes[e]=[l,r]}},t.tweenSequence=function(t,e,r,n){var i,s,o,a;return null==n&&(n=null),t&&r?0===r.length?void(e&&e.apply(t,n)):(s=r.shift(),a="linear",s.transition&&(a=s.transition),o=0,s.time&&(o=s.time),i=0,s.delay&&(i=s.delay),this.tween(t,s,a,o,i,tweenSequence,[t,e,r,n])):void 0},t.remove=function(t,e){var r,n,i;for(null==e&&(e=null),r=this.numQueued;r-->0;)n=this.queued[r],n.target===t&&n.remove(e)&&(this.numQueued--,this.queued.splice(r,1));for(r=this.numItems,i=[];r-->0;)n=this.items[r],n.target===t&&n.remove(e)?(this.numItems--,i.push(this.items.splice(r,1))):i.push(void 0);return i},t.getByTime=function(t,e,r){var n,i,s,o,a;return a=this.tweenTypes[t],i=e/r*this.numValues,n=i>>0,s=a[n],o=a[n+1],(o-s)*(i-n)+s},t.getByPosition=function(t,e){var r,n,i;return this.inited||this.init(),this.tweenTypes[t]||this.populateEasing(t),i=this.tweenTypes[t][0],n=this.tweenTypes[t][1],e*=this.numValues,r=e>>0,(i[r]+n[r]*(e-r))*this.div},t.linear=function(t,e,r,n,i){return null==i&&(i=null),r*t/n+e},t.easeInQuad=function(t,e,r,n,i){return null==i&&(i=null),r*(t/=n)*t+e},t.easeOutQuad=function(t,e,r,n,i){return null==i&&(i=null),-r*(t/=n)*(t-2)+e},t.easeInOutQuad=function(t,e,r,n,i){return null==i&&(i=null),(t/=n/2)<1?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e},t.easeOutInQuad=function(t,e,r,n,i){return null==i&&(i=null),n/2>t?this.easeOutQuad(2*t,e,r/2,n,i):this.easeInQuad(2*t-n,e+r/2,r/2,n,i)},t.easeInCubic=function(t,e,r,n,i){return null==i&&(i=null),r*(t/=n)*t*t+e},t.easeOutCubic=function(t,e,r,n,i){return null==i&&(i=null),r*((t=t/n-1)*t*t+1)+e},t.easeInOutCubic=function(t,e,r,n,i){return null==i&&(i=null),(t/=n/2)<1?r/2*t*t*t+e:r/2*((t-=2)*t*t+2)+e},t.easeOutInCubic=function(t,e,r,n,i){return null==i&&(i=null),n/2>t?this.easeOutCubic(2*t,e,r/2,n,i):this.easeInCubic(2*t-n,e+r/2,r/2,n,i)},t.easeInQuart=function(t,e,r,n,i){return null==i&&(i=null),r*(t/=n)*t*t*t+e},t.easeOutQuart=function(t,e,r,n,i){return null==i&&(i=null),-r*((t=t/n-1)*t*t*t-1)+e},t.easeInOutQuart=function(t,e,r,n,i){return null==i&&(i=null),(t/=n/2)<1?r/2*t*t*t*t+e:-r/2*((t-=2)*t*t*t-2)+e},t.easeOutInQuart=function(t,e,r,n,i){return null==i&&(i=null),n/2>t?this.easeOutQuart(2*t,e,r/2,n,i):this.easeInQuart(2*t-n,e+r/2,r/2,n,i)},t.easeInQuint=function(t,e,r,n,i){return null==i&&(i=null),r*(t/=n)*t*t*t*t+e},t.easeOutQuint=function(t,e,r,n,i){return null==i&&(i=null),r*((t=t/n-1)*t*t*t*t+1)+e},t.easeInOutQuint=function(t,e,r,n,i){return null==i&&(i=null),(t/=n/2)<1?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e},t.easeOutInQuint=function(t,e,r,n,i){return null==i&&(i=null),n/2>t?this.easeOutQuint(2*t,e,r/2,n,i):this.easeInQuint(2*t-n,e+r/2,r/2,n,i)},t.easeInSine=function(t,e,r,n,i){return null==i&&(i=null),-r*Math.cos(t/n*(Math.PI/2))+r+e},t.easeOutSine=function(t,e,r,n,i){return null==i&&(i=null),r*Math.sin(t/n*(Math.PI/2))+e},t.easeInOutSine=function(t,e,r,n,i){return null==i&&(i=null),-r/2*(Math.cos(Math.PI*t/n)-1)+e},t.easeOutInSine=function(t,e,r,n,i){return null==i&&(i=null),n/2>t?this.easeOutSine(2*t,e,r/2,n,i):this.easeInSine(2*t-n,e+r/2,r/2,n,i)},t.easeInExpo=function(t,e,r,n,i){return null==i&&(i=null),0===t?e:r*Math.pow(2,10*(t/n-1))+e-.001*r},t.easeOutExpo=function(t,e,r,n,i){return null==i&&(i=null),t===n?e+r:1.001*r*(-Math.pow(2,-10*t/n)+1)+e},t.easeInOutExpo=function(t,e,r,n,i){return null==i&&(i=null),0===t?e:t===n?e+r:(t/=n/2)<1?r/2*Math.pow(2,10*(t-1))+e-5e-4*r:r/2*1.0005*(-Math.pow(2,-10*--t)+2)+e},t.easeOutInExpo=function(t,e,r,n,i){return null==i&&(i=null),n/2>t?this.easeOutExpo(2*t,e,r/2,n,i):this.easeInExpo(2*t-n,e+r/2,r/2,n,i)},t.easeInCirc=function(t,e,r,n,i){return null==i&&(i=null),-r*(Math.sqrt(1-(t/=n)*t)-1)+e},t.easeOutCirc=function(t,e,r,n,i){return null==i&&(i=null),r*Math.sqrt(1-(t=t/n-1)*t)+e},t.easeInOutCirc=function(t,e,r,n,i){return null==i&&(i=null),(t/=n/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+e:r/2*(Math.sqrt(1-(t-=2)*t)+1)+e},t.easeOutInCirc=function(t,e,r,n,i){return null==i&&(i=null),n/2>t?this.easeOutCirc(2*t,e,r/2,n,i):this.easeInCirc(2*t-n,e+r/2,r/2,n,i)},t.easeInBack=function(t,e,r,n,i){return null==i&&(i=1.70158),r*(t/=n)*t*((i+1)*t-i)+e},t.easeOutBack=function(t,e,r,n,i){return null==i&&(i=1.70158),r*((t=t/n-1)*t*((i+1)*t+i)+1)+e},t.easeInOutBack=function(t,e,r,n,i){return null==i&&(i=1.70158),(t/=n/2)<1?r/2*t*t*(((i*=1.525)+1)*t-i)+e:r/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)+e},t}(),KTObject=function(){function t(t,e,r,n,i,s){var o;this.id=t,this.target=e,this.initTime=r,this.duration=n,this.transition=s,this.iDuration=1/this.duration,this.params=[],this.endValues=[],this.distances=[],this.initValues=[],this.numParams=0,this.onComplete=i.onComplete,this.onCompleteParams=i.onCompleteParams,this.onUpdate=i.onUpdate,this.onUpdateParams=i.onUpdateParams,this.onInit=i.onInit,delete i.onComplete,delete i.onCompleteParams,delete i.onUpdate,delete i.onInit;for(o in i)(this.target.hasOwnProperty(o)||null!=this.target[o])&&(this.params.push(o),this.endValues.push(Number(i[o])),this.distances.push(0),this.initValues.push(0),this.numParams++)}return t.prototype.remove=function(t){var e,r;if(null==t&&(t=null),e=!0,t){for(r=this.numParams;r-->0;)this.params[r]===t&&(this.params.splice(r,1),this.endValues.splice(r,1),this.distances.splice(r,1),this.initValues.splice(r,1),this.numParams--);e=this.numParams<=0}return e?(this.dispose(),!0):!1},t.prototype.dispose=function(){return this.target=null,this.transition=null,this.onComplete=null,this.onCompleteParams=null,this.params=null,this.endValues=null,this.distances=null,this.initValues=null,delete this.target,delete this.transition,delete this.onComplete,delete this.onCompleteParams,delete this.params,delete this.endValues,delete this.distances,delete this.initValues},t.prototype.init=function(){var t,e,r;for(this.onInit&&this.onInit.apply(this.target),t=this.numParams,r=[];t-->=0;)e=this.initValues[t]=Number(this.target[this.params[t]]),r.push(this.distances[t]=this.endValues[t]-e);return r},t}(),window.KTween=KTween;var ObjectUtils;ObjectUtils=function(){function t(){}return t.count=function(t){var e,r;r=0;for(e in t)r++;return r},t.toArray=function(t){var e,r,n;r=[];for(e in t)n=t[e],r.push(t[e]);return r},t.merge=function(t,e){var r;if("object"==typeof t&&"object"==typeof e)for(r in e)t.hasOwnProperty(r)||(t[r]=e[r]);return t},t.clone=function(t){var e,r,n,i,s,o;try{if(!t||"object"!=typeof t)return t;if(e=null,t instanceof Array){for(e=[],n=0,s=t.length;s>n;)e[n]=this.clone(t[n]),n++;return e}if(t instanceof Object){e={};for(i in t)o=t[i],e[i]="object"!==o?o:this.clone(o);return e}}catch(a){return r=a,JSON.parse(JSON.stringify(t))}},t.hasSameKey=function(t,e){return Object.getOwnPropertyNames(t)[0]===Object.getOwnPropertyNames(e)[0]?!0:!1},t.isEqual=function(t,e){return JSON.stringify(t)===JSON.stringify(e)},t.parseLinkedArray=function(t){var e,r,n,i,s,o,a;if(!t||t&&t.length<1)return[];for(e=t.length,i=t[0],s=i.length,a=[];e-->1;){for(o={},n=s,r=t[e];n-->0;)o[i[n]]=r[n];a[e-1]=o}return a},t.find=function(t,e,r,n){var i,s;return null==r&&(r=null),null==n&&(n=!1),t?(/^\//.test(e)?(e=e.replace(/^\//,""),r||(r=t),s=this.find(t,e)):(i=e.split("."),s=t[i[0]],i.length>1&&s?(i.shift(),e=i.join("."),s=this.find(s,e,n)):i.length>1&&(s=null)),n&&console.log(">>>>>",s),s):null},t}();var NumberUtils;NumberUtils=function(){function t(){}return t.isEven=function(t){return t%2===0?!0:!1},t.isZero=function(t){return Math.abs(t)<1e-5},t.toPercent=function(t,e,r){return(t-e)/(r-e)*100},t.percentToValue=function(t,e,r){return(r-e)*t+e},t.getBytesAsMegabytes=function(t){return Math.floor(t/1024/1024*100)/100+" MB"},t.bytesTo=function(t){return t>=1e9?(t/1e9).toFixed(2)+" GB":t>=1e6?(t/1e6).toFixed(2)+" MB":t>=1e3?(t/1e3).toFixed(2)+" KB":t>1?t+" bytes":1===t?t+" byte":"0 byte"},t.rangeRandom=function(t,e,r){return null==r&&(r=!1),r?Math.round(Math.round(Math.random()*(e-t))+t):Math.random()*(e-t)+t},t.distanceBetweenCoordinates=function(t,e,r){var n,i,s,o,a;switch(null==r&&(r="km"),r){case"km":a=6371;break;case"meters":a=6378e3;break;case"feet":a=20925525;break;case"miles":a=3963}return s=(e.x-t.x)*Math.PI/180,o=(e.y-t.y)*Math.PI/180,n=Math.sin(s/2)*Math.sin(s/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(t.x*Math.PI/180)*Math.cos(e.x*Math.PI/180),i=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n)),a*i},t}();var ArrayUtils;ArrayUtils=function(){function t(){}return t.removeItem=function(t,e,r){var n,i,s,o,a;for(null==r&&(r=!1),i=r?t.slice(0):t,s=o=0,a=i.length;a>o;s=++o)n=i[s],n===e&&i.splice(s,1);return i},t.removeItemByIndex=function(t,e,r){var n;return null==r&&(r=!1),n=r?e.slice(0):e,n.splice(t,1),n},t.removeDuplicateStrings=function(t,e){return null==e&&(e=!1),t.filter(function(t,e,r){return r.indexOf(t)===e})},t.hasItem=function(t,e){return e.indexOf(t)>-1},t.merge=function(t,e){var r,n,i;for(r=0,n=0,i=[];r<t.length||n<e.length;)r<t.length&&(i.push(t[r]),r++),n<e.length&&(i.push(e[n]),n++);return i},t.randomIndex=function(t){return NumberUtils.rangeRandom(0,t.length-1,!0)},t.randomItem=function(e){return e[t.randomIndex(e)]},t.shuffle=function(t,e){var r,n,i,s,o,a,l;for(null==e&&(e=!1),s=e?t.slice(0):t,r=a=0,l=s.length;l>a;r=++a)n=s[r],i=Math.floor(Math.random()*s.length),o=s[r],s[r]=s[i],s[i]=o;return s},t.move=function(t,e,r,n){var i,s;if(null==n&&(n=!1),s=n?t.slice(0):t,r>=s.length)for(i=new_index-s.length;i--+1;)s.push(void 0);return s.splice(r,0,s.splice(e,1)[0]),s},t.fromMiddleToEnd=function(t){var e,r,n,i,s;return n=t.length,s=Math.floor(.5*n),e=t.slice(s,n),r=t.slice(0,s).reverse(),i=this.merge(e,r)},t.fromEndToMiddle=function(t){return this.fromMiddleToEnd(t).reverse()},t.lastIndexOf=function(t,e){var r,n,i;for(r=0,i=t.length,n=-1;r!==i;)t[r]===e&&(n=r),r++;return n},t.toArray=function(t){var e,r;if(r=[],t.length)for(e=t.length;e-->0;)r[e]=t[e];return r},t}();var StringUtils,__slice=[].slice;StringUtils=function(){function t(){}return t.hasString=function(t,e){return 1!==t.split(e).length?!0:!1},t.replace=function(t,e,r){return t.split(e).join(r)},t.reverse=function(t){return t?t.split("").reverse().join(""):""},t.toCamelCase=function(t){var e;return e=t.replace(/([\+\-_ ][a-z])/g,function(t){return t.toUpperCase().replace(/[\+\-_ ]/,"")}),e.charAt(0).toUpperCase()+e.slice(1)},t.removeWhiteSpace=function(t){return t?this.trim(t).replace(/\s+/g,""):""},t.removeHTMLTag=function(t){return t.replace(/<.*?>/g,"")},t.removeSpecialChars=function(t){return t.replace(/[^a-zA-Z 0-9]+/g,"")},t.convertToCPF=function(t){return t=this.removeSpecialChars(t),t=t.length>9?t.replace(/(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,"$1.$2.$3-$4"):t.length>6?t.replace(/(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,"$1.$2.$3"):t.length>3?t.replace(/(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,"$1.$2"):t.replace(/(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,"$1")},t.convertToCEP=function(t){return t=this.removeSpecialChars(t),t=t.length>5?t.replace(/(\d{0,5})(\d{0,3})/,"$1-$2"):t.replace(/(\d{0,5})(\d{0,3})/,"$1")},t.convertToDate=function(t){return t=this.removeSpecialChars(t),t=t.length>4?t.replace(/(\d{0,2})(\d{0,2})(\d{0,4})/,"$1/$2/$3"):t.length>2?t.replace(/(\d{0,2})(\d{0,2})(\d{0,4})/,"$1/$2"):t.replace(/(\d{0,2})(\d{0,2})(\d{0,4})/,"$1")},t.isEmpty=function(t){return t&&""!==t?!1:!0},t.toCapitalizeCase=function(t){var e;return e=this.trimLeft(t),e.replace(/(^\w)/,this._upperCase)},t.toTimeFormat=function(t,e){var r,n;return null==e&&(e=!0),r=Math.floor(t/60),n=Math.floor(t%60),String(e?this.addDecimalZero(r)+":"+this.addDecimalZero(n):r+":"+n)},t.addDecimalZero=function(t){return 10>t?"0"+t:String(t)},t.abbreviate=function(t,e,r,n){var i,s,o,a,l;if(null==e&&(e=50),null==r&&(r="..."),null==n&&(n=" "),!t)return"";if(t.length<e)return t;for(l="",o=0,a=t.split(n),s=a[o].length;e>s&&o<a.length;)l+=a[o]+n,s+=a[++o].length+n.length;if(o<a.length){for(i=["-","—",",","."," ",":","?","!","","\n"," ",String.fromCharCode(10),String.fromCharCode(13)];-1!==i.indexOf(l.charAt(l.length-1));)l=l.slice(0,-1);l=this.trim(l)+r}return 0===o&&(l=t.slice(0,e)+r),l},t.toBoolean=function(t){var e;return e=["yes","true","1",1,!0],t&&ArrayUtils.hasItem(t,e)?!0:!1},t.random=function(t){var e,r,n;for(null==t&&(t=10),r="",e=n=t;1>=t?1>=n:n>=1;e=1>=t?++n:--n)r+=String.fromCharCode(65+Math.floor(25*Math.random()));return r},t.trim=function(t,e){return null===t?"":this.trimRight(this.trimLeft(t,e),e)},t.trimRight=function(t,e){var r;return t?(r=new RegExp(e+"*$"),r.global=!0,r.multiline=!0,t.replace(r,"")):""},t.trimLeft=function(t,e){var r;return t?(r=new RegExp("^"+e+"*"),r.global=!0,r.multiline=!0,t.replace(r,"")):""},t.replaceSpecialCharacters=function(t){var e,r;this.substitionDict||this._initDict();
for(e in this.substitionDict)console.log(e),r=new RegExp(e,"g"),t=t.replace(r,this.substitionDict[e]);return t},t._upperCase=function(){var t,e;return e=arguments[0],t=2<=arguments.length?__slice.call(arguments,1):[],e.toUpperCase()},t.substitionDict=null,t._initDict=function(){var t,e;this.substitionDict=[],this.substitionDict["ã"]="a",this.substitionDict["á"]="a",this.substitionDict["â"]="a",this.substitionDict["ä"]="a",this.substitionDict["à"]="a",this.substitionDict["é"]="e",this.substitionDict["ê"]="e",this.substitionDict["ë"]="e",this.substitionDict["è"]="e",this.substitionDict["í"]="i",this.substitionDict["î"]="i",this.substitionDict["ï"]="i",this.substitionDict["ì"]="i",this.substitionDict["õ"]="o",this.substitionDict["ó"]="o",this.substitionDict["ô"]="o",this.substitionDict["ö"]="o",this.substitionDict["ò"]="o",this.substitionDict["ú"]="u",this.substitionDict["û"]="u",this.substitionDict["ü"]="u",this.substitionDict["ù"]="u",this.substitionDict["ç"]="c",this.substitionDict["ñ"]="n",e=[];for(t in this.substitionDict)e.push(this.substitionDict[t.toUpperCase()]=String(this.substitionDict[t]).toUpperCase());return e},t}();var JSONUtils;JSONUtils=function(){function t(){}return t.parseJSON=function(e){var r;return r=!1,"string"==typeof e&&(r=!0,e=t.replaceMultiline(e)),e=t.removeComments(e),r&&(e=JSON.parse(e)),e},t.replaceMultiline=function(t){return"string"!=typeof t?t:(t=t.replace(/^(\s*.*?""")(?:[\s\t]*\n)?([\t\s]*)(\S[\s\S]*)\n?[\s]*(""")/gim,this._replaceMultilinePart),t=t.replace(/^(\s*.*?)"""([\s\S]*?)"""/gim,this._replaceEmptyMultiline))},t._replaceMultilinePart=function(t,e,r,n,i){var s;return s=new RegExp(r+"?([^\n]*)","g"),n=n.replace(s,"$1"),e+n+i},t._replaceEmptyMultiline=function(t,e,r){return r=r.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t"),e+'"'+r+'"'},t.removeComments=function(t){var e;return e=!0,"string"!=typeof t&&(e=!1,t=JSON.stringify(t)),t=t.replace(/(^|\s)(\/\/.*$)|(\/\*(.|\s)*?\*\/?)/gim,""),e?t:JSON.parse(t)},t.filterObject=function(t,e,r,n,i){var s,o,a,l;null==r&&(r=null),null==n&&(n=null),null==i&&(i=!1),a=[],e=[].concat(e),n&&(n=[].concat(n));for(o in t)l=t[o],n&&n.indexOf(o)>=0||(e.indexOf(o)>=0&&(s=!0,r&&typeof l!==r&&(s=!1),s&&(i?a.indexOf(t)<0&&a.push(t):a.push(l))),("array"==typeof l||"object"==typeof l)&&(a=[].concat(a,this.filterObject(l,e,r,n,i))));return a},t}(),this.createjs=this.createjs||{},function(){"use strict";var t=createjs.PreloadJS=createjs.PreloadJS||{};t.version="0.6.1",t.buildDate="Thu, 21 May 2015 16:17:37 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(t,e){"use strict";function r(){this.constructor=t}return r.prototype=e.prototype,t.prototype=new r},this.createjs=this.createjs||{},createjs.promote=function(t,e){"use strict";var r=t.prototype,n=Object.getPrototypeOf&&Object.getPrototypeOf(r)||r.__proto__;if(n){r[(e+="_")+"constructor"]=n.constructor;for(var i in n)r.hasOwnProperty(i)&&"function"==typeof n[i]&&(r[e+i]=n[i])}return t},this.createjs=this.createjs||{},createjs.indexOf=function(t,e){"use strict";for(var r=0,n=t.length;n>r;r++)if(e===t[r])return r;return-1},this.createjs=this.createjs||{},function(){"use strict";createjs.proxy=function(t,e){var r=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(r))}}}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"BrowserDetect cannot be instantiated"}var e=t.agent=window.navigator.userAgent;t.isWindowPhone=e.indexOf("IEMobile")>-1||e.indexOf("Windows Phone")>-1,t.isFirefox=e.indexOf("Firefox")>-1,t.isOpera=null!=window.opera,t.isChrome=e.indexOf("Chrome")>-1,t.isIOS=(e.indexOf("iPod")>-1||e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&!t.isWindowPhone,t.isAndroid=e.indexOf("Android")>-1&&!t.isWindowPhone,t.isBlackberry=e.indexOf("Blackberry")>-1,createjs.BrowserDetect=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,r){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!r,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,r){this.Event_constructor("error"),this.title=t,this.message=e,this.data=r}var e=createjs.extend(t,createjs.Event);e.clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,r){var n;n=r?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var i=n[t];return i&&this.removeEventListener(t,e,r),i=n[t],i?i.push(e):n[t]=[e],e},e.on=function(t,e,r,n,i,s){return e.handleEvent&&(r=r||e,e=e.handleEvent),r=r||this,this.addEventListener(t,function(t){e.call(r,t,i),n&&t.remove()},s)},e.removeEventListener=function(t,e,r){var n=r?this._captureListeners:this._listeners;if(n){var i=n[t];if(i)for(var s=0,o=i.length;o>s;s++)if(i[s]==e){1==o?delete n[t]:i.splice(s,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t){if("string"==typeof t){var e=this._listeners;if(!e||!e[t])return!1;t=new createjs.Event(t)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(r){}if(t.bubbles&&this.parent){for(var n=this,i=[n];n.parent;)i.push(n=n.parent);var s,o=i.length;for(s=o-1;s>=0&&!t.propagationStopped;s--)i[s]._dispatchEvent(t,1+(0==s));for(s=1;o>s&&!t.propagationStopped;s++)i[s]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,r=this._captureListeners;return!!(e&&e[t]||r&&r[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var r,n=1==e?this._captureListeners:this._listeners;if(t&&n){var i=n[t.type];if(!i||!(r=i.length))return;try{t.currentTarget=this}catch(s){}try{t.eventPhase=e}catch(s){}t.removed=!1,i=i.slice();for(var o=0;r>o&&!t.immediatePropagationStopped;o++){var a=i[o];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1==e),t.removed=!1)}}},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}var e=createjs.extend(t,createjs.Event);e.clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(t,"Event")}(window),function(){function t(e,n){function s(t){if(s[t]!==g)return s[t];var e;if("bug-string-char-index"==t)e="a"!="a"[0];else if("json"==t)e=s("json-stringify")&&s("json-parse");else{var r,i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var l=n.stringify,u="function"==typeof l&&y;if(u){(r=function(){return 1}).toJSON=r;try{u="0"===l(0)&&"0"===l(new o)&&'""'==l(new a)&&l(v)===g&&l(g)===g&&l()===g&&"1"===l(r)&&"[1]"==l([r])&&"[null]"==l([g])&&"null"==l(null)&&"[null,null,null]"==l([g,v,null])&&l({a:[r,!0,!1,null,"\x00\b\n\f\r	"]})==i&&"1"===l(null,r)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new h(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new h(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new h(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new h(-1))}catch(c){u=!1}}e=u}if("json-parse"==t){var d=n.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){r=d(i);var _=5==r.a.length&&1===r.a[0];if(_){try{_=!d('"	"')}catch(c){}if(_)try{_=1!==d("01")}catch(c){}if(_)try{_=1!==d("1.")}catch(c){}}}}catch(c){_=!1}e=_}}return s[t]=!!e}e||(e=i.Object()),n||(n=i.Object());var o=e.Number||i.Number,a=e.String||i.String,l=e.Object||i.Object,h=e.Date||i.Date,u=e.SyntaxError||i.SyntaxError,c=e.TypeError||i.TypeError,d=e.Math||i.Math,_=e.JSON||i.JSON;"object"==typeof _&&_&&(n.stringify=_.stringify,n.parse=_.parse);var p,f,g,m=l.prototype,v=m.toString,y=new h(-0xc782b5b800cec);try{y=-109252==y.getUTCFullYear()&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(b){}if(!s("json")){var E="[object Function]",w="[object Date]",L="[object Number]",T="[object String]",C="[object Array]",P="[object Boolean]",A=s("bug-string-char-index");if(!y)var S=d.floor,O=[0,31,59,90,120,151,181,212,243,273,304,334],j=function(t,e){return O[e]+365*(t-1970)+S((t-1969+(e=+(e>1)))/4)-S((t-1901+e)/100)+S((t-1601+e)/400)};if((p=m.hasOwnProperty)||(p=function(t){var e,r={};return(r.__proto__=null,r.__proto__={toString:1},r).toString!=v?p=function(t){var e=this.__proto__,r=t in(this.__proto__=null,this);return this.__proto__=e,r}:(e=r.constructor,p=function(t){var r=(this.constructor||e).prototype;return t in this&&!(t in r&&this[t]===r[t])}),r=null,p.call(this,t)}),f=function(t,e){var n,i,s,o=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,i=new n;for(s in i)p.call(i,s)&&o++;return n=i=null,o?f=2==o?function(t,e){var r,n={},i=v.call(t)==E;for(r in t)i&&"prototype"==r||p.call(n,r)||!(n[r]=1)||!p.call(t,r)||e(r)}:function(t,e){var r,n,i=v.call(t)==E;for(r in t)i&&"prototype"==r||!p.call(t,r)||(n="constructor"===r)||e(r);(n||p.call(t,r="constructor"))&&e(r)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(t,e){var n,s,o=v.call(t)==E,a=!o&&"function"!=typeof t.constructor&&r[typeof t.hasOwnProperty]&&t.hasOwnProperty||p;for(n in t)o&&"prototype"==n||!a.call(t,n)||e(n);for(s=i.length;n=i[--s];a.call(t,n)&&e(n));}),f(t,e)},!s("json-stringify")){var x={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},R="000000",I=function(t,e){return(R+(e||0)).slice(-t)},M="\\u00",k=function(t){for(var e='"',r=0,n=t.length,i=!A||n>10,s=i&&(A?t.split(""):t);n>r;r++){var o=t.charCodeAt(r);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=x[o];break;default:if(32>o){e+=M+I(2,o.toString(16));break}e+=i?s[r]:t.charAt(r)}}return e+'"'},D=function(t,e,r,n,i,s,o){var a,l,h,u,d,_,m,y,b,E,A,O,x,R,M,N;try{a=e[t]}catch(B){}if("object"==typeof a&&a)if(l=v.call(a),l!=w||p.call(a,"toJSON"))"function"==typeof a.toJSON&&(l!=L&&l!=T&&l!=C||p.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&1/0>a){if(j){for(d=S(a/864e5),h=S(d/365.2425)+1970-1;j(h+1,0)<=d;h++);for(u=S((d-j(h,0))/30.42);j(h,u+1)<=d;u++);d=1+d-j(h,u),_=(a%864e5+864e5)%864e5,m=S(_/36e5)%24,y=S(_/6e4)%60,b=S(_/1e3)%60,E=_%1e3}else h=a.getUTCFullYear(),u=a.getUTCMonth(),d=a.getUTCDate(),m=a.getUTCHours(),y=a.getUTCMinutes(),b=a.getUTCSeconds(),E=a.getUTCMilliseconds();a=(0>=h||h>=1e4?(0>h?"-":"+")+I(6,0>h?-h:h):I(4,h))+"-"+I(2,u+1)+"-"+I(2,d)+"T"+I(2,m)+":"+I(2,y)+":"+I(2,b)+"."+I(3,E)+"Z"}else a=null;if(r&&(a=r.call(e,t,a)),null===a)return"null";if(l=v.call(a),l==P)return""+a;if(l==L)return a>-1/0&&1/0>a?""+a:"null";if(l==T)return k(""+a);if("object"==typeof a){for(R=o.length;R--;)if(o[R]===a)throw c();if(o.push(a),A=[],M=s,s+=i,l==C){for(x=0,R=a.length;R>x;x++)O=D(x,a,r,n,i,s,o),A.push(O===g?"null":O);N=A.length?i?"[\n"+s+A.join(",\n"+s)+"\n"+M+"]":"["+A.join(",")+"]":"[]"}else f(n||a,function(t){var e=D(t,a,r,n,i,s,o);e!==g&&A.push(k(t)+":"+(i?" ":"")+e)}),N=A.length?i?"{\n"+s+A.join(",\n"+s)+"\n"+M+"}":"{"+A.join(",")+"}":"{}";return o.pop(),N}};n.stringify=function(t,e,n){var i,s,o,a;if(r[typeof e]&&e)if((a=v.call(e))==E)s=e;else if(a==C){o={};for(var l,h=0,u=e.length;u>h;l=e[h++],a=v.call(l),(a==T||a==L)&&(o[l]=1));}if(n)if((a=v.call(n))==L){if((n-=n%1)>0)for(i="",n>10&&(n=10);i.length<n;i+=" ");}else a==T&&(i=n.length<=10?n:n.slice(0,10));return D("",(l={},l[""]=t,l),s,o,i,"",[])}}if(!s("json-parse")){var N,B,q=a.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},H=function(){throw N=B=null,u()},F=function(){for(var t,e,r,n,i,s=B,o=s.length;o>N;)switch(i=s.charCodeAt(N)){case 9:case 10:case 13:case 32:N++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=A?s.charAt(N):s[N],N++,t;case 34:for(t="@",N++;o>N;)if(i=s.charCodeAt(N),32>i)H();else if(92==i)switch(i=s.charCodeAt(++N)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=U[i],N++;break;case 117:for(e=++N,r=N+4;r>N;N++)i=s.charCodeAt(N),i>=48&&57>=i||i>=97&&102>=i||i>=65&&70>=i||H();t+=q("0x"+s.slice(e,N));break;default:H()}else{if(34==i)break;for(i=s.charCodeAt(N),e=N;i>=32&&92!=i&&34!=i;)i=s.charCodeAt(++N);t+=s.slice(e,N)}if(34==s.charCodeAt(N))return N++,t;H();default:if(e=N,45==i&&(n=!0,i=s.charCodeAt(++N)),i>=48&&57>=i){for(48==i&&(i=s.charCodeAt(N+1),i>=48&&57>=i)&&H(),n=!1;o>N&&(i=s.charCodeAt(N),i>=48&&57>=i);N++);if(46==s.charCodeAt(N)){for(r=++N;o>r&&(i=s.charCodeAt(r),i>=48&&57>=i);r++);r==N&&H(),N=r}if(i=s.charCodeAt(N),101==i||69==i){for(i=s.charCodeAt(++N),(43==i||45==i)&&N++,r=N;o>r&&(i=s.charCodeAt(r),i>=48&&57>=i);r++);r==N&&H(),N=r}return+s.slice(e,N)}if(n&&H(),"true"==s.slice(N,N+4))return N+=4,!0;if("false"==s.slice(N,N+5))return N+=5,!1;if("null"==s.slice(N,N+4))return N+=4,null;H()}return"$"},X=function(t){var e,r;if("$"==t&&H(),"string"==typeof t){if("@"==(A?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=F(),"]"!=t;r||(r=!0))r&&(","==t?(t=F(),"]"==t&&H()):H()),","==t&&H(),e.push(X(t));return e}if("{"==t){for(e={};t=F(),"}"!=t;r||(r=!0))r&&(","==t?(t=F(),"}"==t&&H()):H()),(","==t||"string"!=typeof t||"@"!=(A?t.charAt(0):t[0])||":"!=F())&&H(),e[t.slice(1)]=X(F());return e}H()}return t},V=function(t,e,r){var n=J(t,e,r);n===g?delete t[e]:t[e]=n},J=function(t,e,r){var n,i=t[e];if("object"==typeof i&&i)if(v.call(i)==C)for(n=i.length;n--;)V(i,n,r);else f(i,function(t){V(i,t,r)});return r.call(t,e,i)};n.parse=function(t,e){var r,n;return N=0,B=""+t,r=X(F()),"$"!=F()&&H(),N=B=null,e&&v.call(e)==E?J((n={},n[""]=r,n),"",e):r}}}return n.runInContext=t,n}var e="function"==typeof define&&define.amd,r={"function":!0,object:!0},n=r[typeof exports]&&exports&&!exports.nodeType&&exports,i=r[typeof window]&&window||this,s=n&&r[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(!s||s.global!==s&&s.window!==s&&s.self!==s||(i=s),n&&!e)t(i,n);else{var o=i.JSON,a=i.JSON3,l=!1,h=t(i,i.JSON3={noConflict:function(){return l||(l=!0,i.JSON=o,i.JSON3=a,o=a=null),h}});i.JSON={parse:h.parse,stringify:h.stringify}}e&&define(function(){return h})}.call(this),function(){var t={};t.appendToHead=function(e){t.getHead().appendChild(e)},t.getHead=function(){return document.head||document.getElementsByTagName("head")[0]},t.getBody=function(){return document.body||document.getElementsByTagName("body")[0]},createjs.DomUtils=t}(),function(){var t={};t.parseXML=function(t,e){var r=null;try{if(window.DOMParser){var n=new DOMParser;r=n.parseFromString(t,e)}}catch(i){}if(!r)try{r=new ActiveXObject("Microsoft.XMLDOM"),r.async=!1,r.loadXML(t)}catch(i){r=null}return r},t.parseJSON=function(t){if(null==t)return null;try{return JSON.parse(t)}catch(e){throw e}},createjs.DataUtils=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=r.LOAD_TIMEOUT_DEFAULT}var e=t.prototype={},r=t;r.LOAD_TIMEOUT_DEFAULT=8e3,r.create=function(e){if("string"==typeof e){var n=new t;return n.src=e,n}if(e instanceof r)return e;if(e instanceof Object&&e.src)return null==e.loadTimeout&&(e.loadTimeout=r.LOAD_TIMEOUT_DEFAULT),e;throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},createjs.LoadItem=r}(),function(){var t={};t.ABSOLUTE_PATT=/^(?:\w+:)?\/{2}/i,t.RELATIVE_PATT=/^[.\/]*?\//i,t.EXTENSION_PATT=/\/?[^\/]+\.(\w{1,5})$/i,t.parseURI=function(e){var r={absolute:!1,relative:!1};if(null==e)return r;var n=e.indexOf("?");n>-1&&(e=e.substr(0,n));var i;return t.ABSOLUTE_PATT.test(e)?r.absolute=!0:t.RELATIVE_PATT.test(e)&&(r.relative=!0),(i=e.match(t.EXTENSION_PATT))&&(r.extension=i[1].toLowerCase()),r},t.formatQueryString=function(t,e){if(null==t)throw new Error("You must specify data.");var r=[];for(var n in t)r.push(n+"="+escape(t[n]));return e&&(r=r.concat(e)),r.join("&")},t.buildPath=function(t,e){if(null==e)return t;var r=[],n=t.indexOf("?");if(-1!=n){var i=t.slice(n+1);r=r.concat(i.split("&"))}return-1!=n?t.slice(0,n)+"?"+this._formatQueryString(e,r):t+"?"+this._formatQueryString(e,r)},t.isCrossDomain=function(t){var e=document.createElement("a");e.href=t.src;var r=document.createElement("a");r.href=location.href;var n=""!=e.hostname&&(e.port!=r.port||e.protocol!=r.protocol||e.hostname!=r.hostname);return n},t.isLocal=function(t){var e=document.createElement("a");return e.href=t.src,""==e.hostname&&"file:"==e.protocol},t.isBinary=function(t){switch(t){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},t.isImageTag=function(t){return t instanceof HTMLImageElement},t.isAudioTag=function(t){return window.HTMLAudioElement?t instanceof HTMLAudioElement:!1},t.isVideoTag=function(t){return window.HTMLVideoElement?t instanceof HTMLVideoElement:!1},t.isText=function(t){switch(t){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:case createjs.AbstractLoader.SPRITESHEET:return!0;default:return!1}},t.getTypeByExtension=function(t){if(null==t)return createjs.AbstractLoader.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}},createjs.RequestUtils=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,r){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=r,this.resultFormatter=null,this._item=t?createjs.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var e=createjs.extend(t,createjs.EventDispatcher),r=t;r.POST="POST",r.GET="GET",r.BINARY="binary",r.CSS="css",r.IMAGE="image",r.JAVASCRIPT="javascript",r.JSON="json",r.JSONP="jsonp",r.MANIFEST="manifest",r.SOUND="sound",r.VIDEO="video",r.SPRITESHEET="spritesheet",r.SVG="svg",r.TEXT="text",r.XML="xml",e.getItem=function(){return this._item},e.getResult=function(t){return t?this._rawResult:this._result},e.getTag=function(){return this._tag},e.setTag=function(t){this._tag=t},e.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new createjs.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},e.cancel=function(){this.canceled=!0,this.destroy()},e.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},e.getLoadedItems=function(){return this._loadedItems},e._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._createTag=function(){return null},e._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},e._sendProgress=function(t){if(!this._isCanceled()){var e=null;"number"==typeof t?(this.progress=t,e=new createjs.ProgressEvent(this.progress)):(e=t,this.progress=t.loaded/t.total,e.progress=this.progress,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e)}},e._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var t=new createjs.Event("complete");t.rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t)}},e._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},e._isCanceled=function(){return null==window.createjs||this.canceled?!0:!1},e.resultFormatter=null,e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this),r=this;e instanceof Function?e(function(t){r._result=t,r._sendComplete()}):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(t.type)}},e.buildPath=function(t,e){return createjs.RequestUtils.buildPath(t,e)},e.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,r){this.AbstractLoader_constructor(t,e,r),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src"}var e=createjs.extend(t,createjs.AbstractLoader);e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._formatResult=function(t){return this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(t.getTag().src=t.getResult(!0)),t.getTag()},createjs.AbstractMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";var t=function(t){this._item=t},e=createjs.extend(t,createjs.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},createjs.AbstractRequest=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,r){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=r,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var e=createjs.extend(t,createjs.AbstractRequest);e.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var t=new createjs.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._hideTag(),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0)},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleError=function(){this._clean(),this.dispatchEvent("error")},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},e._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},e._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},e._showTag=function(){this._tag.style.visibility=this._startTagVisibility},e._handleStalled=function(){},createjs.TagRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,r){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=r,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var e=createjs.extend(t,createjs.TagRequest);e.load=function(){var t=createjs.proxy(this._handleStalled,this);this._stalledCallback=t;var e=createjs.proxy(this._handleProgress,this);this._handleProgress=e,this._tag.addEventListener("stalled",t),this._tag.addEventListener("progress",e),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),!this._createXHR(t)}var e=createjs.extend(t,createjs.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},e.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},e.load=function(){if(null==this._request)return void this._handleError();null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,t))}},e.setResponseType=function(t){"blob"===t&&(t=window.URL?"blob":"arraybuffer",this._responseType=t),this._request.responseType=t},e.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},e.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._handleLoadStart=function(){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},e._handleAbort=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,t))},e._handleError=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(t.message))},e._handleReadyStateChange=function(){4==this._request.readyState&&this._handleLoad()},e._handleLoad=function(){if(!this.loaded){this.loaded=!0;var t=this._checkError();if(t)return void this._handleError(t);if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(e){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===e.name&&window.BlobBuilder){var r=new BlobBuilder;r.append(this._response),this._response=r.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},e._handleTimeout=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,t))},e._checkError=function(){var t=parseInt(this._request.status);switch(t){case 404:case 0:return new Error(t)}return null},e._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},e._createXHR=function(t){var e=createjs.RequestUtils.isCrossDomain(t),r={},n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest,e&&void 0===n.withCredentials&&window.XDomainRequest&&(n=new XDomainRequest);else{for(var i=0,o=s.ACTIVEX_VERSIONS.length;o>i;i++){var a=s.ACTIVEX_VERSIONS[i];try{n=new ActiveXObject(a);break}catch(l){}}if(null==n)return!1}null==t.mimeType&&createjs.RequestUtils.isText(t.type)&&(t.mimeType="text/plain; charset=utf-8"),t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType),this._xhrLevel="string"==typeof n.responseType?2:1;
var h=null;if(h=t.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(t.src,t.values):t.src,n.open(t.method||createjs.AbstractLoader.GET,h,!0),e&&n instanceof XMLHttpRequest&&1==this._xhrLevel&&(r.Origin=location.origin),t.values&&t.method==createjs.AbstractLoader.POST&&(r["Content-Type"]="application/x-www-form-urlencoded"),e||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var u in t.headers)r[u]=t.headers[u];for(u in r)n.setRequestHeader(u,r[u]);return n instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(n.withCredentials=t.withCredentials),this._request=n,!0},e._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},e.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,r){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[createjs.ImageLoader,createjs.JavaScriptLoader,createjs.CSSLoader,createjs.JSONLoader,createjs.JSONPLoader,createjs.SoundLoader,createjs.ManifestLoader,createjs.SpriteSheetLoader,createjs.XMLLoader,createjs.SVGLoader,createjs.BinaryLoader,createjs.VideoLoader,createjs.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(t,e,r)}var e=createjs.extend(t,createjs.AbstractLoader),r=t;e.init=function(t,e,r){this.useXHR=!0,this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(t),this._paused=!1,this._basePath=e,this._crossOrigin=r,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=0/0},r.loadTimeout=8e3,r.LOAD_TIMEOUT=0,r.BINARY=createjs.AbstractLoader.BINARY,r.CSS=createjs.AbstractLoader.CSS,r.IMAGE=createjs.AbstractLoader.IMAGE,r.JAVASCRIPT=createjs.AbstractLoader.JAVASCRIPT,r.JSON=createjs.AbstractLoader.JSON,r.JSONP=createjs.AbstractLoader.JSONP,r.MANIFEST=createjs.AbstractLoader.MANIFEST,r.SOUND=createjs.AbstractLoader.SOUND,r.VIDEO=createjs.AbstractLoader.VIDEO,r.SVG=createjs.AbstractLoader.SVG,r.TEXT=createjs.AbstractLoader.TEXT,r.XML=createjs.AbstractLoader.XML,r.POST=createjs.AbstractLoader.POST,r.GET=createjs.AbstractLoader.GET,e.registerLoader=function(t){if(!t||!t.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(t))throw new Error("loader already exists.");this._availableLoaders.unshift(t)},e.unregisterLoader=function(t){var e=this._availableLoaders.indexOf(t);-1!=e&&e<this._defaultLoaderLength-1&&this._availableLoaders.splice(e,1)},e.setUseXHR=function(t){return this.setPreferXHR(t)},e.setPreferXHR=function(t){return this.preferXHR=0!=t&&null!=window.XMLHttpRequest,this.preferXHR},e.removeAll=function(){this.remove()},e.remove=function(t){var e=null;if(!t||t instanceof Array){if(t)e=t;else if(arguments.length>0)return}else e=[t];var r=!1;if(e){for(;e.length;){var n=e.pop(),i=this.getResult(n);for(s=this._loadQueue.length-1;s>=0;s--)if(o=this._loadQueue[s].getItem(),o.id==n||o.src==n){this._loadQueue.splice(s,1)[0].cancel();break}for(s=this._loadQueueBackup.length-1;s>=0;s--)if(o=this._loadQueueBackup[s].getItem(),o.id==n||o.src==n){this._loadQueueBackup.splice(s,1)[0].cancel();break}if(i)this._disposeItem(this.getItem(n));else for(var s=this._currentLoads.length-1;s>=0;s--){var o=this._currentLoads[s].getItem();if(o.id==n||o.src==n){this._currentLoads.splice(s,1)[0].cancel(),r=!0;break}}}r&&this._loadNext()}else{this.close();for(var a in this._loadItemsById)this._disposeItem(this._loadItemsById[a]);this.init(this.preferXHR,this._basePath)}},e.reset=function(){this.close();for(var t in this._loadItemsById)this._disposeItem(this._loadItemsById[t]);for(var e=[],r=0,n=this._loadQueueBackup.length;n>r;r++)e.push(this._loadQueueBackup[r].getItem());this.loadManifest(e,!1)},e.installPlugin=function(t){if(null!=t&&null!=t.getPreloadHandlers){this._plugins.push(t);var e=t.getPreloadHandlers();if(e.scope=t,null!=e.types)for(var r=0,n=e.types.length;n>r;r++)this._typeCallbacks[e.types[r]]=e;if(null!=e.extensions)for(r=0,n=e.extensions.length;n>r;r++)this._extensionCallbacks[e.extensions[r]]=e}},e.setMaxConnections=function(t){this._maxConnections=t,!this._paused&&this._loadQueue.length>0&&this._loadNext()},e.loadFile=function(t,e,r){if(null==t){var n=new createjs.ErrorEvent("PRELOAD_NO_FILE");return void this._sendError(n)}this._addItem(t,null,r),this.setPaused(e!==!1?!1:!0)},e.loadManifest=function(t,e,n){var i=null,s=null;if(t instanceof Array){if(0==t.length){var o=new createjs.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(o)}i=t}else if("string"==typeof t)i=[{src:t,type:r.MANIFEST}];else{if("object"!=typeof t){var o=new createjs.ErrorEvent("PRELOAD_MANIFEST_NULL");return void this._sendError(o)}if(void 0!==t.src){if(null==t.type)t.type=r.MANIFEST;else if(t.type!=r.MANIFEST){var o=new createjs.ErrorEvent("PRELOAD_MANIFEST_TYPE");this._sendError(o)}i=[t]}else void 0!==t.manifest&&(i=t.manifest,s=t.path)}for(var a=0,l=i.length;l>a;a++)this._addItem(i[a],s,n);this.setPaused(e!==!1?!1:!0)},e.load=function(){this.setPaused(!1)},e.getItem=function(t){return this._loadItemsById[t]||this._loadItemsBySrc[t]},e.getResult=function(t,e){var r=this._loadItemsById[t]||this._loadItemsBySrc[t];if(null==r)return null;var n=r.id;return e&&this._loadedRawResults[n]?this._loadedRawResults[n]:this._loadedResults[n]},e.getItems=function(t){var e=[];for(var r in this._loadItemsById){var n=this._loadItemsById[r],i=this.getResult(r);(t!==!0||null!=i)&&e.push({item:n,result:i,rawResult:this.getResult(r,!0)})}return e},e.setPaused=function(t){this._paused=t,this._paused||this._loadNext()},e.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=0/0},e._addItem=function(t,e,r){var n=this._createLoadItem(t,e,r);if(null!=n){var i=this._createLoader(n);null!=i&&("plugins"in i&&(i.plugins=this._plugins),n._loader=i,this._loadQueue.push(i),this._loadQueueBackup.push(i),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&n.type==createjs.LoadQueue.JAVASCRIPT||n.maintainOrder===!0)&&(this._scriptOrder.push(n),this._loadedScripts.push(null)))}},e._createLoadItem=function(t,e,r){var n=createjs.LoadItem.create(t);if(null==n)return null;var i="",s=r||this._basePath;if(n.src instanceof Object){if(!n.type)return null;if(e){i=e;var o=createjs.RequestUtils.parseURI(e);null==s||o.absolute||o.relative||(i=s+i)}else null!=s&&(i=s)}else{var a=createjs.RequestUtils.parseURI(n.src);a.extension&&(n.ext=a.extension),null==n.type&&(n.type=createjs.RequestUtils.getTypeByExtension(n.ext));var l=n.src;if(!a.absolute&&!a.relative)if(e){i=e;var o=createjs.RequestUtils.parseURI(e);l=e+l,null==s||o.absolute||o.relative||(i=s+i)}else null!=s&&(i=s);n.src=i+n.src}n.path=i,(void 0===n.id||null===n.id||""===n.id)&&(n.id=l);var h=this._typeCallbacks[n.type]||this._extensionCallbacks[n.ext];if(h){var u=h.callback.call(h.scope,n,this);if(u===!1)return null;u===!0||null!=u&&(n._loader=u),a=createjs.RequestUtils.parseURI(n.src),null!=a.extension&&(n.ext=a.extension)}return this._loadItemsById[n.id]=n,this._loadItemsBySrc[n.src]=n,null==n.crossOrigin&&(n.crossOrigin=this._crossOrigin),n},e._createLoader=function(t){if(null!=t._loader)return t._loader;for(var e=this.preferXHR,r=0;r<this._availableLoaders.length;r++){var n=this._availableLoaders[r];if(n&&n.canLoadItem(t))return new n(t,e)}return null},e._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var t=0;t<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);t++){var e=this._loadQueue[t];this._canStartLoad(e)&&(this._loadQueue.splice(t,1),t--,this._loadItem(e))}}},e._loadItem=function(t){t.on("fileload",this._handleFileLoad,this),t.on("progress",this._handleProgress,this),t.on("complete",this._handleFileComplete,this),t.on("error",this._handleError,this),t.on("fileerror",this._handleFileError,this),this._currentLoads.push(t),this._sendFileStart(t.getItem()),t.load()},e._handleFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleFileError=function(t){var e=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,t.item);this._sendError(e)},e._handleError=function(t){var e=t.target;this._numItemsLoaded++,this._finishOrderedItem(e,!0),this._updateProgress();var r=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,e.getItem());this._sendError(r),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(e),this._cleanLoadItem(e),this._loadNext())},e._handleFileComplete=function(t){var e=t.target,r=e.getItem(),n=e.getResult();this._loadedResults[r.id]=n;var i=e.getResult(!0);null!=i&&i!==n&&(this._loadedRawResults[r.id]=i),this._saveLoadedItems(e),this._removeLoadItem(e),this._finishOrderedItem(e)||this._processFinishedLoad(r,e),this._cleanLoadItem(e)},e._saveLoadedItems=function(t){var e=t.getLoadedItems();if(null!==e)for(var r=0;r<e.length;r++){var n=e[r].item;this._loadItemsBySrc[n.src]=n,this._loadItemsById[n.id]=n,this._loadedResults[n.id]=e[r].result,this._loadedRawResults[n.id]=e[r].rawResult}},e._finishOrderedItem=function(t,e){var r=t.getItem();if(this.maintainScriptOrder&&r.type==createjs.LoadQueue.JAVASCRIPT||r.maintainOrder){t instanceof createjs.JavaScriptLoader&&(this._currentlyLoadingScript=!1);var n=createjs.indexOf(this._scriptOrder,r);return-1==n?!1:(this._loadedScripts[n]=e===!0?!0:r,this._checkScriptLoadOrder(),!0)}return!1},e._checkScriptLoadOrder=function(){for(var t=this._loadedScripts.length,e=0;t>e;e++){var r=this._loadedScripts[e];if(null===r)break;if(r!==!0){var n=this._loadedResults[r.id];r.type==createjs.LoadQueue.JAVASCRIPT&&createjs.DomUtils.appendToHead(n);var i=r._loader;this._processFinishedLoad(r,i),this._loadedScripts[e]=!0}}},e._processFinishedLoad=function(t,e){this._numItemsLoaded++,this.maintainScriptOrder||t.type!=createjs.LoadQueue.JAVASCRIPT||createjs.DomUtils.appendToHead(t.result),this._updateProgress(),this._sendFileComplete(t,e),this._loadNext()},e._canStartLoad=function(t){if(!this.maintainScriptOrder||t.preferXHR)return!0;var e=t.getItem();if(e.type!=createjs.LoadQueue.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;for(var r=this._scriptOrder.indexOf(e),n=0;r>n;){var i=this._loadedScripts[n];if(null==i)return!1;n++}return this._currentlyLoadingScript=!0,!0},e._removeLoadItem=function(t){for(var e=this._currentLoads.length,r=0;e>r;r++)if(this._currentLoads[r]==t){this._currentLoads.splice(r,1);break}},e._cleanLoadItem=function(t){var e=t.getItem();e&&delete e._loader},e._handleProgress=function(t){var e=t.target;this._sendFileProgress(e.getItem(),e.progress),this._updateProgress()},e._updateProgress=function(){var t=this._numItemsLoaded/this._numItems,e=this._numItems-this._numItemsLoaded;if(e>0){for(var r=0,n=0,i=this._currentLoads.length;i>n;n++)r+=this._currentLoads[n].progress;t+=r/e*(e/this._numItems)}this._lastProgress!=t&&(this._sendProgress(t),this._lastProgress=t)},e._disposeItem=function(t){delete this._loadedResults[t.id],delete this._loadedRawResults[t.id],delete this._loadItemsById[t.id],delete this._loadItemsBySrc[t.src]},e._sendFileProgress=function(t,e){if(!this._isCanceled()&&!this._paused&&this.hasEventListener("fileprogress")){var r=new createjs.Event("fileprogress");r.progress=e,r.loaded=e,r.total=1,r.item=t,this.dispatchEvent(r)}},e._sendFileComplete=function(t,e){if(!this._isCanceled()&&!this._paused){var r=new createjs.Event("fileload");r.loader=e,r.item=t,r.result=this._loadedResults[t.id],r.rawResult=this._loadedRawResults[t.id],t.completeHandler&&t.completeHandler(r),this.hasEventListener("fileload")&&this.dispatchEvent(r)}},e._sendFileStart=function(t){var e=new createjs.Event("filestart");e.item=t,this.hasEventListener("filestart")&&this.dispatchEvent(e)},e.toString=function(){return"[PreloadJS LoadQueue]"},createjs.LoadQueue=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.TEXT)}var e=(createjs.extend(t,createjs.AbstractLoader),t);e.canLoadItem=function(t){return t.type==createjs.AbstractLoader.TEXT},createjs.TextLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.BINARY),this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.BINARY},e._updateXHR=function(t){t.loader.setResponseType("arraybuffer")},createjs.BinaryLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=document.createElement(e?"style":"link"),this._tag.rel="stylesheet",this._tag.type="text/css"}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.CSS},e._formatResult=function(t){if(this._preferXHR){var e=t.getTag();if(e.styleSheet)e.styleSheet.cssText=t.getResult(!0);else{var r=document.createTextNode(t.getResult(!0));e.appendChild(r)}}else e=this._tag;return createjs.DomUtils.appendToHead(e),e},createjs.CSSLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",createjs.RequestUtils.isImageTag(t)?this._tag=t:createjs.RequestUtils.isImageTag(t.src)?this._tag=t.src:createjs.RequestUtils.isImageTag(t.tag)&&(this._tag=t.tag),null!=this._tag?this._preferXHR=!1:this._tag=document.createElement("img"),this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.IMAGE},e.load=function(){if(""!=this._tag.src&&this._tag.complete)return void this._sendComplete();var t=this._item.crossOrigin;1==t&&(t="Anonymous"),null==t||createjs.RequestUtils.isLocal(this._item.src)||(this._tag.crossOrigin=t),this.AbstractLoader_load()},e._updateXHR=function(t){t.loader.mimeType="text/plain; charset=x-user-defined-binary",t.loader.setResponseType&&t.loader.setResponseType("blob")},e._formatResult=function(t){var e=this;return function(r){var n=e._tag,i=window.URL||window.webkitURL;if(e._preferXHR)if(i){var s=i.createObjectURL(t.getResult(!0));n.src=s,n.onload=function(){i.revokeObjectURL(e.src)}}else n.src=t.getItem().src;n.complete?r(n):n.onload=function(){r(this)}}},createjs.ImageLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(document.createElement("script"))}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JAVASCRIPT},e._formatResult=function(t){var e=t.getTag();return this._preferXHR&&(e.text=t.getResult(!0)),e},createjs.JavaScriptLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.JSON),this.resultFormatter=this._formatResult}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JSON&&!t._loadAsJSONP},e._formatResult=function(t){var e=null;try{e=createjs.DataUtils.parseJSON(t.getResult(!0))}catch(r){var n=new createjs.ErrorEvent("JSON_FORMAT",null,r);return this._sendError(n),r}return e},createjs.JSONLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!1,createjs.AbstractLoader.JSONP),this.setTag(document.createElement("script")),this.getTag().type="text/javascript"}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JSONP||t._loadAsJSONP},e.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},e.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=window[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=createjs.proxy(this._handleLoad,this),window.document.body.appendChild(this._tag),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},e._handleLoad=function(t){this._result=this._rawResult=t,this._sendComplete(),this._dispose()},e._handleTimeout=function(){this._dispose(),this.dispatchEvent(new createjs.ErrorEvent("timeout"))},e._dispose=function(){window.document.body.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},createjs.JSONPLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,null,createjs.AbstractLoader.MANIFEST),this.plugins=null,this._manifestQueue=null}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.MANIFEST_PROGRESS=.25,r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.MANIFEST},e.load=function(){this.AbstractLoader_load()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(r.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=r.MANIFEST_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._loadManifest=function(t){if(t&&t.manifest){var e=this._manifestQueue=new createjs.LoadQueue;e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("complete",this._handleManifestComplete,this,!0),e.on("error",this._handleManifestError,this,!0);for(var r=0,n=this.plugins.length;n>r;r++)e.installPlugin(this.plugins[r]);e.loadManifest(t)}else this._sendComplete()},e._handleManifestFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleManifestComplete=function(){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-r.MANIFEST_PROGRESS)+r.MANIFEST_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new createjs.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},createjs.ManifestLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(t)?this._tag=t:createjs.RequestUtils.isAudioTag(t.src)?this._tag=t:createjs.RequestUtils.isAudioTag(t.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=createjs.extend(t,createjs.AbstractMediaLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SOUND},e._createTag=function(t){var e=document.createElement("audio");return e.autoplay=!1,e.preload="none",e.src=t,e},createjs.SoundLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.VIDEO),createjs.RequestUtils.isVideoTag(t)||createjs.RequestUtils.isVideoTag(t.src)?(this.setTag(createjs.RequestUtils.isVideoTag(t)?t:t.src),this._preferXHR=!1):this.setTag(this._createTag())}var e=createjs.extend(t,createjs.AbstractMediaLoader),r=t;e._createTag=function(){return document.createElement("video")},r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.VIDEO},createjs.VideoLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,null,createjs.AbstractLoader.SPRITESHEET),this._manifestQueue=null}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.SPRITESHEET_PROGRESS=.25,r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SPRITESHEET},e.destroy=function(){this.AbstractLoader_destroy,this._manifestQueue.close()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t&&t instanceof Function?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(r.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=r.SPRITESHEET_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e._loadManifest=function(t){if(t&&t.images){var e=this._manifestQueue=new createjs.LoadQueue;e.on("complete",this._handleManifestComplete,this,!0),e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("error",this._handleManifestError,this,!0),e.loadManifest(t.images)}},e._handleManifestFileLoad=function(t){var e=t.result;if(null!=e){var r=this.getResult().images,n=r.indexOf(t.item.src);r[n]=e}},e._handleManifestComplete=function(){this._result=new createjs.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-r.SPRITESHEET_PROGRESS)+r.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new createjs.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},createjs.SpriteSheetLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",e?this.setTag(document.createElement("svg")):(this.setTag(document.createElement("object")),this.getTag().type="image/svg+xml")}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SVG},e._formatResult=function(t){var e=createjs.DataUtils.parseXML(t.getResult(!0),"text/xml"),r=t.getTag();return!this._preferXHR&&document.body.contains(r)&&document.body.removeChild(r),null!=e.documentElement?(r.appendChild(e.documentElement),r.style.visibility="visible",r):e},createjs.SVGLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.XML),this.resultFormatter=this._formatResult}var e=createjs.extend(t,createjs.AbstractLoader),r=t;r.canLoadItem=function(t){return t.type==createjs.AbstractLoader.XML},e._formatResult=function(t){return createjs.DataUtils.parseXML(t.getResult(!0),"text/xml")},createjs.XMLLoader=createjs.promote(t,"AbstractLoader")}(),function(){"use strict";var t,e;t=function(){},e=t,e.getPreloadHandlers=function(){return{callback:e.preloadHandler,types:["binary","image","javascript","json","jsonp","sound","video","svg","text","xml"]}},e.preloadHandler=function(t,e){var r,n,i,s,o,a,l;return a="undefined"!=typeof app&&null!==app&&null!=(l=app.config)?l.views:void 0,o=null!=a?a[e.id]:void 0,i=null!=a?a[null!=o?o.parentView:void 0]:void 0,n=!1,null!=t.cache?t.cache===!1&&(n=!0):null!=(null!=o?o.cache:void 0)?(null!=o?o.cache:void 0)===!1&&(n=!0):null!=(null!=i?i.cache:void 0)&&(null!=i?i.cache:void 0)===!1&&(n=!0),-1===t.src.indexOf("?v=")&&(s=(new Date).getTime(),r=n?"?v="+app.getInfo().version+"&noCache="+s:"?v="+app.getInfo().version,t.src+=r),!0},createjs.CacheControllerPlugin=t}(),this.createjs=this.createjs||{},function(){var t,e,r;t=function(t,e,r){this.fullBuffer=t.fullBuffer,this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=r,this._complete=createjs.proxy(this._handleTagComplete,this)},e=createjs.extend(t,createjs.TagRequest),r=t,e.load=function(){var t,e,r,n;e=createjs.proxy(this._handleProgress,this),this._handleProgress=e,r=createjs.proxy(this._handleStalled,this),this._handleStalled=r,t=createjs.proxy(this._handleError,this),this._handleError=t,n=createjs.proxy(this._handleTimeout,this),this._handleTimeout=n,this.____timer=setInterval(e,10),this._tag.addEventListener?(this._tag.addEventListener("progress",e),this._tag.addEventListener("stalled",r),this._tag.addEventListener("error",t)):(this._tag.onprogress=e,this._tag.onstalled=r,this._tag.onerror=t),this.fullBuffer||void 0===this.fullBuffer?this._tag.addEventListener?(this._tag.addEventListener("ended",this._complete,!1),this._tag.addEventListener("complete",this._complete,!1)):this._tag.onended=this._tag.oncomplete=this._complete:this._tag.addEventListener?this._tag.addEventListener("canplaythrough",this._complete,!1):this._tag.oncanplaythrough=this._complete,this.TagRequest_load()},e._handleTimeout=function(){},e._handleStalled=function(){},e._handleError=function(t){var e;try{throw console.log(t.data),new Error(t.title)}catch(r){return e=r,console.log(e.stack)}},e._handleProgress=function(){var t,e,r;try{e=this._tag.buffered.end(this._tag.buffered.length-1),r=this._tag.duration,this._tag.currentTime=e,this.dispatchEvent(new createjs.ProgressEvent(e,r))}catch(n){t=n}Math.round(e)>=Math.round(r)&&this._complete()},e.destroy=function(){this.TagRequest_destroy()},e._handleTagComplete=function(){this.TagRequest__handleTagComplete()},e._clean=function(){var t,e,r,n;try{e=this._tag.buffered.end(this._tag.buffered.length-1),r=this._tag.duration}catch(i){t=i}Math.round(e)>=Math.round(r)&&(clearInterval(this.____timer),this.____timer=null,this._tag.removeEventListener?(this._tag.removeEventListener("progress",this._handleProgress),this._tag.removeEventListener("stalled",this._handleStalled),this._tag.removeEventListener("error",this._handleError),this._tag.removeEventListener("ended",this._complete),this._tag.removeEventListener("complete",this._complete),this._tag.removeEventListener("canplaythrough",this._complete)):(this._tag.onended=null,this._tag.oncanplaythrough=null,this._tag.onprogress=null,this._tag.onstalled=null,this._tag.onerror=null),null!=(n=this._tag)&&(n.currentTime=1e-4),this.TagRequest__clean())},createjs.MediaRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){var t,e;t=function(t,e,r){this.AbstractLoader_constructor(t,e,r),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src"},e=createjs.extend(t,createjs.AbstractLoader),e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._request=new createjs.MediaRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._formatResult=function(t){return this._tag.removeEventListener&&this._tag.removeEventListener("complete",this._loadedHandler),this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(t.getTag().src=t.getResult(!0)),t.getTag()},createjs.TagMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){var t,e,r;t=function(t,e){this.___item=t,"video"===t.type?(this.TagMediaLoader_constructor(t,e,createjs.AbstractLoader.VIDEO),createjs.RequestUtils.isVideoTag(t)||createjs.RequestUtils.isVideoTag(t.src)?(this.setTag(createjs.RequestUtils.isVideoTag(t)?t:t.src),this._preferXHR=!1):this.setTag(this._createTag())):(this.TagMediaLoader_constructor(t,e,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(t)?this._tag=t:createjs.RequestUtils.isAudioTag(t.src)?this._tag=t:createjs.RequestUtils.isAudioTag(t.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(t)?t:t.src),null!==this._tag&&(this._preferXHR=!1))},r=t,e=createjs.extend(t,createjs.TagMediaLoader),e._createTag=function(t){var e;return"video"===this.___item.type?(e=document.createElement("video"),e.type="video/mp4",e.preload="auto"):(e=document.createElement("audio"),e.type="audio/mpeg",e.preload="none",e.src=t),null!=this.___item.id&&(e.id=this.___item.id),e.autoplay=this.___item.autoplay&&void 0!==this.___item.autoplay?this.___item.autoplay:!1,e.loop=this.___item.loop&&void 0!==this.___item.loop?this.___item.loop:!1,e.volume=this.___item.volume&&void 0!==this.___item.volume?this.___item.volume:1,e},r.canLoadItem=function(t){return"video"===this.___item.type?t.type===createjs.AbstractLoader.VIDEO:t.type===createjs.AbstractLoader.SOUND},createjs.MediaLoader=createjs.promote(t,"TagMediaLoader")}(),function(){"use strict";var t,e;t=function(){},e=t,e.getPreloadHandlers=function(){return{callback:t.handlers,types:["sound","video"],extensions:["mp3","mp4"]}},e.handlers=function(t){var e;return e=new createjs.MediaLoader(t,!1)},createjs.MediaPlugin=t}();var AssetLoader;AssetLoader=function(t){function e(){this._fileLoad=__bind(this._fileLoad,this),this._onFileError=__bind(this._onFileError,this),this._onError=__bind(this._onError,this),this._groups={}}return __extends(e,t),e.INITIALIZE="initialize",e.COMPLETE_ALL="complete",e.COMPLETE_FILE="fileload",e.PROGRESS_ALL="progress",e.PROGRESS_FILE="fileprogress",e.START_ALL="loadstart",e.START_FILE="filestart",e.ERROR="error",e.FILE_ERROR="fileerror",e.getInstance=function(){return null!=e._instance?e._instance:e._instance=function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(e,arguments,function(){})},e.prototype._groups=null,e.prototype.loadGroup=function(t,e){var r;return r=this.getGroup(t),r.loadManifest(e),r},e.prototype.getGroup=function(t,r,n){var i;return null==r&&(r=3),null==n&&(n=!0),i=this._groups[t],i||(i=new createjs.LoadQueue(n),i.installPlugin(createjs.CacheControllerPlugin),i.installPlugin(createjs.MediaPlugin),i.id=t,this._groups[t]=i,i.on(e.COMPLETE_FILE,this._fileLoad),i.on(e.ERROR,this._onError),i.on(e.FILE_ERROR,this._onFileError)),i.setMaxConnections(r),i
},e.prototype.preferXHR=function(t,e){var r;return null==e&&(e=!0),r=this.getGroup(t).setPreferXHR=e},e.prototype._onError=function(t){throw t.currentTarget.off(e.ERROR,this._onError),t.currentTarget.off(e.COMPLETE_FILE,this._fileLoad),console.log(t),new Error(t.title).stack},e.prototype._onFileError=function(t){throw t.currentTarget.off(e.FILE_ERROR,this._onFileError),t.currentTarget.off(e.COMPLETE_FILE,this._fileLoad),console.log(t),new Error(t.title).stack},e.prototype._fileLoad=function(t){return t.currentTarget.off(e.COMPLETE_FILE,this._fileLoad),t.currentTarget.off(e.ERROR,this._onError),t.currentTarget.off(e.FILE_ERROR,this._onFileError),t.item.tag=t.result,!1},e.prototype.getItem=function(t,e){var r,n,i,s,o;if(null==e&&(e=null),e)return null!=(s=this._groups[e])?s.getItem(t):void 0;o=this._groups;for(n in o)if(i=o[n],r=i.getItem(t))return r},e.prototype.getResult=function(t,e){var r,n,i,s,o,a;null==e&&(e=null),i=null,e&&(i=null!=(o=this._groups[e])?o.getResult(t):void 0),a=this._groups;for(n in a)s=a[n],(r=s.getResult(t))&&(i=r);return i},e.addFiles=function(t,e){var r,n,i,s,o,a;for(n=/.*\.(js|css|svg)$/g,i=/.*\.(mp4)$/g,o=0,a=t.length;a>o;o++)r=t[o],s={id:"",src:""},n.lastIndex=0,s.id=r.id||"item",s.src=r.src,i.test(s.src)&&(s.type="video"),r.src&&n.test(r.src)&&(s.type="text"),s.src&&e.loadFile(s,!1);return t.length>0&&e.load(),!1},e}(EventDispatcher);var BaseDOM,__slice=[].slice;Node.prototype.__appendChild__=Node.prototype.appendChild,Node.prototype.appendChild=function(t){var e;return e=t,t instanceof BaseDOM&&(e=t.element,t.parent=this),Node.prototype.__appendChild__.call(this,e)},Node.prototype.__removeChild__=Node.prototype.removeChild,Node.prototype.removeChild=function(t){var e;e=t,t instanceof BaseDOM&&(e=t.element,t.parent=this);try{return this.__removeChild__.call(this,e)}catch(r){}},Element.prototype.matches=Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector,Node.prototype.findParents=function(t){var e;return null!=(null!=(e=this.parentNode)?e.matches:void 0)?this.parentNode.matches(t)?this.parentNode:this.parentNode.findParents(t):null},BaseDOM=function(t){function e(){var t,r,n,i,s,o;if(o=1<=arguments.length?__slice.call(arguments,0):[],e.__super__.constructor.apply(this,arguments),r="div",t=null,i=null,"string"==typeof o[0]||o[0]instanceof HTMLElement)r=o[0];else for(n=o.length;n--;)s=o[n],null!=s.element&&(r=s.element),null!=s.className&&(t=s.className),null!=s.namespace&&(i=s.namespace);"string"==typeof r?i?(this._namespace=i,this._element=document.createElementNS(this._namespace,r)):this._element=document.createElement(r):r instanceof HTMLElement&&(this._element=r),t&&this.addClass(t),this._element.__instance__=this}return __extends(e,t),e.get({element:function(){return this._element}}),e.get({namespace:function(){return this._namespace}}),e.get({childNodes:function(){return this.element.childNodes}}),e.get({width:function(){return this.getBounds().width}}),e.get({height:function(){return this.getBounds().height}}),e.get({left:function(){return this.getBounds().left}}),e.get({top:function(){return this.getBounds().top}}),e.get({x:function(){return this.getBounds().left}}),e.get({y:function(){return this.getBounds().top}}),e.get({parent:function(){return this._parent}}),e.set({parent:function(t){if(!(t instanceof e||t instanceof Node))throw new Error("Parent instance is not either Node or BaseDOM");return this._parent=t}}),e.get({className:function(){return this.element.className}}),e.set({className:function(t){return this.element.className=t.trim()}}),e.get({text:function(){return this.html}}),e.set({text:function(t){return this.html=t}}),e.get({html:function(){return this.element.innerHTML}}),e.set({html:function(t){return this.element.innerHTML=t}}),e.get({isAttached:function(){return("function"==typeof document.contains?document.contains(this.element):void 0)||document.body.contains(this.element)}}),e.get({attributes:function(){return this.element.attributes}}),e.prototype.appendChild=function(t){return this.appendChildAt(t)},e.prototype.appendChildAt=function(t,r){var n;return null==r&&(r=-1),n=t,t instanceof e&&(n=t.element),-1===r||r>=this.childNodes.length?this.element.appendChild(n):this.element.insertBefore(n,this.childNodes[r]),t instanceof e&&(t.parent=this),t},e.prototype.remove=function(){var t;return null!=(t=this.parent)&&"function"==typeof t.removeChild?t.removeChild(this):void 0},e.prototype.removeChild=function(t){var r;r=t,t instanceof e&&(r=t.element);try{return this.element.removeChild(r)}catch(n){}},e.prototype.removeChildAt=function(t){return null==t&&(t=-1),t<this.childNodes.length?this.removeChild(this.childNodes[i]):void 0},e.prototype.removeAll=function(){var t,e,r;for(t=this.childNodes,e=t.length,r=[];e-->0;)r.push(this.removeChild(t[e]));return r},e.prototype.matches=function(t){return this.element.matches(t)},e.prototype.findParents=function(t){return this.element.findParents(t)},e.prototype.find=function(t,e){var r;return null==e&&(e=!1),r=this.element.querySelector(t),e?null!=r?r.__instance__:void 0:r},e.prototype.findAll=function(t,e){var r,n,i,s,o;if(null==e&&(e=!1),r=this.element.querySelectorAll(t),e){for(n=[],i=-1,s=r.length,o=0;++i<s;)r[i].__instance__&&(n[o++]=r[i].__instance__);r=n}return r},e.prototype.attr=function(t,e,r){var n,i,s;if(null==e&&(e="nonenonenone"),null==r&&(r=!1),"string"==typeof t)return this._attr(t,e,r);if("object"==typeof t){s=[];for(n in t)i=t[n],s.push(this._attr(n,i,r));return s}},e.prototype._attr=function(t,e,r){return null==e&&(e="nonenonenone"),null==r&&(r=!1),r===!1&&(r=this.namespace),"nonenonenone"!==e&&(r?this.element.setAttributeNS(r,t,e):this.element.setAttribute(t,e)),r?this.element.getAttributeNS(r,t):this.element.getAttribute(t)},e.prototype._css=function(t,e){return null==e&&(e=null),null!==e&&(this.element.style[t]=e),this.element.style[t]},e.prototype.css=function(t,e){var r,n,i;if(null==e&&(e=null),"string"==typeof t)return this._css(t,e);if("object"==typeof t){i=[];for(r in t)n=t[r],i.push(this._css(r,n));return i}},e.prototype.addClass=function(t){var e,r,n;if("string"==typeof t)t=t.replace(/\s+/gi," ").split(" ");else if("Array"!=typeof t)return;for(e=this.className.replace(/\s+/gi," ").split(" "),n=e.length,r=t.length;r-->0;)e.indexOf(t[r])>=0||(e[n++]=t[r]);return this.className=e.join(" ")},e.prototype.removeClass=function(t){var e,r,n;if("string"==typeof t)t=t.replace(/\s+/gi," ").split(" ");else if("Array"!=typeof t)return;for(e=this.className.replace(/\s+/gi," ").split(" "),r=t.length;r-->0;)(n=e.indexOf(t[r]))>=0&&e.splice(n,1);return this.className=e.join(" ")},e.prototype.toggleClass=function(t,e){var r,n;if(null==e&&(e=null),null!==e)return void(e?this.addClass(t):this.removeClass(t));if("string"==typeof t)t=t.replace(/\s+/gi," ").split(" ");else if("Array"!=typeof t)return;for(r=t.length,n=[];r-->0;)n.push(this.hasClass(t[r])?this.removeClass(t[r]):this.addClass(t[r]));return n},e.prototype.hasClass=function(t){var e,r,n;if("string"==typeof t)t=t.replace(/\s+/gi," ").split(" ");else if("Array"!=typeof t)return;for(e=this.className.replace(/\s+/gi," ").split(" "),n=t.length,r=!0;n-->0;)r&=e.indexOf(t[n])>=0;return r},e.prototype.getBounds=function(t){var r,n,i,s,o;null==t&&(t=null),n={},r=this.element.getBoundingClientRect();for(i in r)o=r[i],n[i]=o;return t&&(t instanceof e?s=t.getBounds():t instanceof HTMLElement&&(s=t.getBoundingClientRect())),s&&(n.top-=s.top,n.left-=s.left,n.bottom-=s.top,n.right-=s.left),n.width=n.right-n.left,n.height=n.bottom-n.top,n},e.prototype.destroy=function(){return"function"==typeof this.off&&this.off(),"function"==typeof this.remove?this.remove():void 0},e}(EventDispatcher);var BaseView;BaseView=function(t){function e(t,r){null==t&&(t=null),null==r&&(r=null),this.destroyComplete=__bind(this.destroyComplete,this),this.destroy=__bind(this.destroy,this),this.hideComplete=__bind(this.hideComplete,this),this.hide=__bind(this.hide,this),this.hideStart=__bind(this.hideStart,this),this.showComplete=__bind(this.showComplete,this),this.show=__bind(this.show,this),this.showStart=__bind(this.showStart,this),this.createComplete=__bind(this.createComplete,this),this.create=__bind(this.create,this),this.createStart=__bind(this.createStart,this),this.getReverseParentList=__bind(this.getReverseParentList,this),this._created=!1,this._data=t?t:{},this._id=null!=this._data.id?this._data.id:void 0,this._content=null!=this._data.content?this._data.content:void 0,this._route=null!=this._data.route?this._data.route:void 0,this._parent=null!=this._data.parent?this._data.parent:void 0,this._subviews=null!=this._data.subviews?this._data.subviews:void 0,this._destroyable=null!=this._data.destroyable?this._data.destroyable:void 0,e.__super__.constructor.call(this,{element:"div",className:r+"-view"})}return __extends(e,t),e.CREATE_START="create_start",e.CREATE="create",e.CREATE_COMPLETE="create_complete",e.SHOW_START="show_start",e.SHOW="show",e.SHOW_COMPLETE="show_complete",e.HIDE_START="hide_start",e.HIDE="hide",e.HIDE_COMPLETE="hide_complete",e.DESTROY="destroy",e.DESTROY_COMPLETE="destroy_complete",e.get({data:function(){return this._data}}),e.set({data:function(t){return this._data=ObjectUtils.clone(t)}}),e.get({id:function(){return this._id}}),e.set({id:function(t){return this._id=t}}),e.get({content:function(){return this._content}}),e.set({content:function(t){return this._content=t}}),e.get({route:function(){return this._route}}),e.set({route:function(t){return this._route=t}}),e.get({parent:function(){return this._parent}}),e.set({parent:function(t){return this._parent=t}}),e.get({loader:function(){var t;return null!=this._id&&"undefined"!=typeof app&&null!==app&&null!=(t=app.loader)?t.getGroup(this.id):void 0}}),e.get({created:function(){return this._created}}),e.get({subviews:function(){return this._subviews}}),e.set({subviews:function(t){return this._subviews=t}}),e.get({destroyable:function(){return this._destroyable}}),e.set({destroyable:function(t){return this._destroyable=t}}),e.get({type:function(){return this._type}}),e.set({type:function(t){return this._type=t}}),e.get({meta:function(){var t;return null!=(null!=(t=this.content)?t.meta:void 0)?this.content.meta:void 0}}),e.set({meta:function(t){return this._meta=t}}),e.get({progress:function(){return this._progress}}),e.set({progress:function(t){return this._progress=t}}),e.get({openedSubview:function(){return this._openedSubviewID}}),e.set({openedSubview:function(t){return this._openedSubviewID=t}}),e.get({reverseParentPath:function(){return this.getReverseParentList(this),this._parentPath.reverse()}}),e.get({parentPath:function(){return this.getReverseParentList(this),this._parentPath}}),e.prototype.getReverseParentList=function(t){return null==t&&(t=null),this._parentPath=[],null!=(null!=t?t.parent:void 0)&&(this.getReverseParentList(t.parent),this._parentPath.push(t.id)),!1},e.prototype.createStart=function(t){return null==t&&(t=null),this.trigger(e.CREATE_START,this),this.create(),!1},e.prototype.create=function(t){return null==t&&(t=null),this.trigger(e.CREATE,this),this.createComplete(),!1},e.prototype.createComplete=function(t){return null==t&&(t=null),this._created=!0,this.trigger(e.CREATE_COMPLETE,this),!1},e.prototype.showStart=function(t){return null==t&&(t=null),this.trigger(e.SHOW_START,this),this.show(),!1},e.prototype.show=function(t){return null==t&&(t=null),this.trigger(e.SHOW,this),this.showComplete(),!1},e.prototype.showComplete=function(t){return null==t&&(t=null),this.trigger(e.SHOW_COMPLETE,this),!1},e.prototype.hideStart=function(t){return null==t&&(t=null),this.trigger(e.HIDE_START,this),this.hide(),!1},e.prototype.hide=function(t){return null==t&&(t=null),this.trigger(e.HIDE,this),this.hideComplete(),!1},e.prototype.hideComplete=function(t){return null==t&&(t=null),this.trigger(e.HIDE_COMPLETE,this),!1},e.prototype.destroy=function(t){var r;return null==t&&(t=null),this.removeAll(),null!=(r=this._parentPath)&&(r.length=0),this._parentPath=null,this._data=null,this.trigger(e.DESTROY,this),this.destroyComplete(),!1},e.prototype.destroyComplete=function(t){return null==t&&(t=null),this._created=!1,this.trigger(e.DESTROY_COMPLETE,this),this.off(),!1},e}(BaseDOM);var TemplateNode;TemplateNode=function(_super){function TemplateNode(t){this.nodeData=t,this._id=this.nodeData.id,this._external=this.nodeData.external,this._use=this.nodeData.use,this._attributes=this.nodeData.attributes,this._element=this.nodeData.element,this._content=this.nodeData.content,this._condition=this.nodeData.condition,this._conditionData=this.nodeData.conditionData,this._children=[],this._contextSelector=this.nodeData.contextSelector,this._parseNode(this.nodeData)}return __extends(TemplateNode,_super),TemplateNode.get({id:function(){return this._id}}),TemplateNode.get({external:function(){return this._external}}),TemplateNode.get({use:function(){return this._use}}),TemplateNode.get({attributes:function(){return this._attributes}}),TemplateNode.get({element:function(){return this._element}}),TemplateNode.get({content:function(){return this._content}}),TemplateNode.get({condition:function(){return this._condition}}),TemplateNode.get({children:function(){return this._children}}),TemplateNode.set({children:function(t){return this._children=t}}),TemplateNode.prototype._parseNode=function(){},TemplateNode.prototype.find=function(t,e){var r,n,i,s,o,a,l,h,u,c,d,_;for(null==t&&(t=null),null==e&&(e=null),n=null,c=this._children,a=0,h=c.length;h>a;a++)if(r=c[a],!t||r.element===t){if(e){i=!0;for(s in e)o=e[s],(!r.attributes[s]||(null!=(d=r.attributes[s])?d.indexOf(o):void 0)<0)&&(i=!1);if(!i)continue}n=r;break}if(!n)for(_=this._children,l=0,u=_.length;u>l&&(r=_[l],!(n=r.find(t,e)));l++);return n},TemplateNode.prototype.clear=function(){var t,e;for(t=this._childContext.childNodes,e=[];this._childContext.childNodes.length;)e.push(this._childContext.removeChild(this._childContext.childNodes[0]));return e},TemplateNode.prototype.render=function(context,data,originalData,ignoreUse){var attrs,cData,childContext,e,foundData,initialData,k,o,v,_i,_len;if(null==originalData&&(originalData=null),null==ignoreUse&&(ignoreUse=!1),!originalData&&data&&(originalData=data),null==this._condition||null==this._conditionData||(cData=this._conditionData,cData=cData.replace(/\#\{(.*?)\}/gi,"data['$1']"),eval(cData))){if(initialData=data,context.data=data,this.originalData=originalData,foundData=data,!ignoreUse&&this._use&&(o=/([\*\@])?(.*?)$/.exec(this._use))){if(foundData=this._findObjectData(foundData,this._use),null==foundData)return;Array.isArray(foundData)||"object"==typeof foundData?(data=foundData,this._content=""):this._content=foundData}if(this._contextSelector&&(context=(context||document.body).querySelector(this._contextSelector)),this.data=data,context.data=data,Array.isArray(data)||Array.isArray(initialData)||data instanceof String||initialData instanceof String||(initialData=ObjectUtils.merge(initialData,data)),childContext=context,this._element&&(childContext=document.createElement(this._element),context.appendChild(childContext),childContext.templateNode=this),this._content&&(childContext.innerHTML=this._replaceData(this._content,data)),this._attributes){attrs=this._replaceData(this._attributes,initialData);for(k in attrs)if(v=attrs[k],v&&0!==v.length)try{childContext.setAttribute(k,v)}catch(_error){e=_error,console.log(k,v),childContext[k]=v}}if(childContext.data=data,!context)throw new Error("Context was not found.");if(!ignoreUse&&this._use&&data&&Array.isArray(data))for(_i=0,_len=data.length;_len>_i;_i++)v=data[_i],this._renderChildren(childContext,v,originalData);else this._renderChildren(childContext,data,originalData);return this._childContext=childContext}},TemplateNode.prototype.update=function(t){var e,r,n;if(this.clear(),t&&("object"==typeof t||Array.isArray(t)))for(r=0,n=t.length;n>r;r++)e=t[r],this._renderChildren(this._childContext,e,t,!0);else this._renderChildren(this._childContext,t,t,!0);return this.data=t},TemplateNode.prototype._replaceData=function(t,e){var r,n;for(t=JSON.stringify(t);r=/\#\{(.*?)\}/.exec(t);)n=ObjectUtils.findChild(e,r[1]),n||(n=""),n=n.toString().replace(/\"/g,'\\"'),t=t.replace(new RegExp("#\\{"+r[1]+"\\}","g"),n),t=t.replace(new RegExp("\r\n","g"),"\n"),t=t.replace(new RegExp("[\n|\r]","g"),"\\n");return JSON.parse(t)},TemplateNode.prototype._findObjectData=function(t,e){var r;if(!t)return null;if(e&&(r=/([\*\@])?(.*?)$/.exec(e)))switch(r[1]){case"*":break;case"@":break;default:t=ObjectUtils.findChild(t,r[2])}return t},TemplateNode.prototype._renderChildren=function(t,e,r,n){var i,s,o;for(null==n&&(n=!1),s=this._children.length,i=-1,o=[];++i<s;)o.push(this._children[i].render(t,e,r,n));return o},TemplateNode}(EventDispatcher);var TemplateParser;TemplateParser=function(t){function e(t){null==t&&(t=null),this._replaceStringMultilines=__bind(this._replaceStringMultilines,this),this._replaceObject=__bind(this._replaceObject,this),this._parseObjectRecursive=__bind(this._parseObjectRecursive,this),this._loadComplete=__bind(this._loadComplete,this),this._externalTemplateLoadError=__bind(this._externalTemplateLoadError,this),this._externalTemplateLoaded=__bind(this._externalTemplateLoaded,this),this._replaceNodeExternals=__bind(this._replaceNodeExternals,this),this._loadExternalTemplates=__bind(this._loadExternalTemplates,this),this._templateLoadError=__bind(this._templateLoadError,this),this._templateLoadComplete=__bind(this._templateLoadComplete,this),e.rules||e._parseTemplateRules(),this._renderQueue=[],this._loaded=!1,this.id=t,t&&this.loadTemplate(t)}return __extends(e,t),e.LOAD_COMPLETE="templateParser_loadComplete",e.LOAD_ERROR="templateParser_loadError",e._parseTemplateRules=function(){var t,e,r,n;for(r=Template.RULES.replace(/^\s*$/g,""),t=/^[^\s].*?\n(^[\s+].*?(\n|$))+/gm,this._rules=[],n=[];e=t.exec(r);)n.push(this._parseBlock(e[0]));return n},e._parseBlock=function(t){var e,r,n,i;if(e=/^([^\s]+)\s*\:/.exec(t)){for(e=e[1],i={name:e},n=/^\s+([^\s]+)\s*\:\s*(.*?)\s*$/gm;r=n.exec(t);)i[r[1]]=r[2];return this._rules.push(i)}},e.get({loaded:function(){return this._loaded}}),e.prototype.parse=function(t){return this._templateLoadComplete(null,t)},e.prototype.loadTemplate=function(t,e){var r,n;return null==e&&(e=null),/\.tpl$/.test(t)||(t=t.replace(/\./,"/")+Template.EXTENSION),n=0!==t.indexOf("/")?Template.ROOT_PATH:"",r=n+t,API.call({url:r,onComplete:this._templateLoadComplete,onError:this._templateLoadError,type:"template"})},e.prototype.render=function(t,e){var r,n,i;if(this._loaded){for(n=this._nodes.length,r=-1,i=[];++r<n;)i.push(this._nodes[r].render(t,e));return i}return this._renderQueue.push(arguments)},e.prototype._templateLoadComplete=function(t,e){return e+="\n",this._externalTemplates=[],this._nodes=this._parseBlocks(e),this._loadExternalTemplates()},e.prototype._templateLoadError=function(){return this._loaded=!0,this.trigger(e.LOAD_ERROR)},e.prototype._findTemplate=function(t){var e,r;for(e=this._nodes.length;e-->0;)if((null!=(r=this._nodes[e])?r.id:void 0)===t)return this._nodes[e];return Template.find(t)},e.prototype._loadExternalTemplates=function(){var t,r,n;for(t=this._externalTemplates.length;t-->0;){if(r=this._externalTemplates[t],!this._findTemplate(r))return n=new e(this._externalTemplates[t]),n.on(e.LOAD_ERROR,this._externalTemplateLoadError),n.on(e.LOAD_COMPLETE,this._externalTemplateLoaded),Template.addTemplate(this._externalTemplates[t],n),void this._externalTemplates.splice(t,1);this._externalTemplates.splice(t,1)}return 0===this._externalTemplates.length?(this._replaceNodeExternals(this._nodes),this._loadComplete()):this._loadExternalTemplates()},e.prototype._replaceNodeExternals=function(t){var r,n,i,s;for(n=t.length,s=[];n-->0;)i=t[n],i.external&&(r=this._findTemplate(i.external),r&&(r instanceof e?i.children=r.nodes:r instanceof TemplateNode&&(i.children=r.children)),i.children&&0!==i.children.length||t.splice(n,1)),s.push(i.children.length?this._replaceNodeExternals(i.children):void 0);return s},e.prototype._externalTemplateLoaded=function(t){var r;return r=t.currentTarget,r instanceof e&&Template.addTemplate(r.id,r),this._loadExternalTemplates()},e.prototype._externalTemplateLoadError=function(t){return Template.addTemplate(t.target.id,""),this._loadExternalTemplates()},e.prototype._loadComplete=function(){var t,r;for(this._loaded=!0,t=this._nodes.length;t-->0;)this._nodes[t].id&&this._nodes.splice(t,1);for(r=this._renderQueue.length,t=-1;++t<r;)this.render.apply(this,this._renderQueue[t]);return this.trigger(e.LOAD_COMPLETE)},e.prototype._parseBlocks=function(t){var e,r,n,i,s,o,a,l;for(t=t.replace(/\/\*[\s\S]*?\*\//gm,""),t=t.replace(/^\s*$[\n|\r]/gm,""),e=/(\s*)([^\s].*?\n)((?:\1\s[\s\S].*?(?:\n|$))*)/gm,o=this._escapeCharacters(t,this._escapeMap||[]),t=o[0],this._escapeMap=o[1],a=this._escapeLineBreaks(t,this._escapeMap),t=a[0],this._escapeMap=a[1],l=this._escapeConditionals(t,this._escapeMap),t=l[0],this._escapeMap=l[1],r=[];n=e.exec(t);)i=this._parseNodeData(n[2]),i&&(s=new TemplateNode(i),n[3]&&n[3].trim().length>0&&(s.children=this._parseBlocks(n[3])),r.push(s));return r},e.prototype._parseNodeData=function(t){var e,r,n,i,s,o,a,l,h,u,c,d,_,p,f,g,m,v,y,b;if(v=this._escapeConditionals(t,this._escapeMap),t=v[0],i=v[1],f=/^([\>\<\!]?)(.*?)(\:(.*?))?$/m.exec(t),l={},f[1]&&f[1].length>0)switch(f[1]){case">":l.contextSelector=f[2];break;case"<":this._externalTemplates.push(f[2]),l.external=f[2],f[4]&&f[4].length>0&&(n=/^\s*\#\{(.*?)\}\s*$/.exec(this._unescapeCharacters(f[4],i)),l.content=f[4],n&&(l.use=n[1]));break;case"!":l.id=f[2];break;default:throw new Error("Couldn't parse node: "+f[0])}else{if(d=(this._unescapeCharacters(f[2],this._escapeMap)||"").trim(),o=(this._unescapeCharacters(f[4],this._escapeMap)||"").trim(),u=o,o=o.replace(/^([\'\"])(.*?)\1$/,"$2"),y=this._escapeDataObjects(d,this._escapeMap),_=y[0],this._escapeMap=y[1],b=this._parseObjectRecursive(_),_=b[0],e=b[1],_=this._unescapeCharacters(_,e),_=this._unescapeCharacters(_,this._escapeMap),s=/^\s*\((if|for)(.*?)\)\s*$/.exec(d))l.condition=s[1],l.conditionData=s[2];else{for(r=/([\.\#])?([\w\-]+)/g,_||(_=""),g=_.replace(/\{.*?\}/g,""),h=[],a=[];c=r.exec(g);)switch(c[1]){case".":a.push(c[2]);break;case"#":h.push(c[2]);break;default:l.element=c[2]}h.length&&(e.id||(e.id=""),e.id=[].concat(e.id.split(" "),h).join(" ").trim()),a.length&&(e["class"]||(e["class"]=""),e["class"]=[].concat(e["class"].split(" "),a).join(" ").trim());for(p in e)m=e[p],e[p]=this._unescapeCharacters(m,this._escapeMap);l.attributes=e}l.element||l.condition||(l.element="div"),(null!=o?o.length:void 0)>0&&(l.content=o),o===u&&(n=/^\s*\#\{(.*?)\}\s*$/.exec(o))&&(l.use=n[1])}return l},e.prototype._parseObjectRecursive=function(t){var e,r,n;if(this._objData=[],e=/(\{.*?\})/.exec(t))try{e=JSON.parse(e[0])}catch(i){}for(e||(e={});/\{([^\{\}]*)\}/.test(t);)r=this._escapeCharacters(t,this._objData,"£££"),t=r[0],this._objData=r[1],n=this._escapeString(t,/(([\'\"])([^\2]*)\2)/,this._objData,"£££",3),t=n[0],this._objData=n[1],t=t.replace(/\{([^\{\}]*)\}/g,this._replaceObject);return t=t.replace(/\${3}\d+\£{3}/g,""),[t,e]},e.prototype._replaceObject=function(t,e){var r,n,i,s,o,a,l;for(i=this._objData.length,a={},r=/([^\:\,\{\}]+)\:([^\:\,\}]+)/gm;o=r.exec(e);)s=o[1].trim(),n=o[2].trim(),l=/^\-{3}(\d+)\-{3}$/.exec(n),a[s]=l&&this._objData[l[1]]?this._objData[l[1]]:this._unescapeCharacters(o[2].trim(),this._objData,"£££");return this._objData[i]=a,"---"+i+"---"},e.prototype._escapeString=function(t,e,r,n,i){var s,o;if(null==r&&(r=[]),null==n&&(n="---"),null==i&&(i=1),!e)throw new Error("Must define a RegExp object");for(s=r.length,null==n&&(n="---");o=e.exec(t);)t=t.replace(new RegExp(o[0].replace(/(\W)/g,"\\$1"),"g"),n+s+n),r[s++]=o[i],e.lastIndex=0;return[t,r]},e.prototype._escapeDataObjects=function(t,e){return null==e&&(e=[]),this._escapeString(t,/(\#\{[^\{\}]*\})/,e)},e.prototype._escapeConditionals=function(t,e){return null==e&&(e=[]),this._escapeString(t,/((?:\{([^\{\}]+)})|(?:\(([^\(\)]+)\)))/,e)},e.prototype._escapeCharacters=function(t,e,r){var n;return null==e&&(e=[]),null==r&&(r=null),n=this._escapeString(t,/(\\.)/,e,r),t=n[0],e=n[1],[t,e]},e.prototype._escapeLineBreaks=function(t,e){return t=t.replace(/(['"])([\s\S]*?)\1/g,this._replaceStringMultilines),this._escapeString(t,/(\+{3})/,e)},e.prototype._replaceStringMultilines=function(t){return t=t.replace(/^\s+/gm,""),t.replace(/\n/gm,"+++")},e.prototype._unescapeCharacters=function(t,e,r){var n,i,s,o,a;if(null==r&&(r="---"),t){for(s=r.replace(/(.)/g,"\\$1"),i=new RegExp(s+"(\\d+)"+s,"g");a=i.exec(t);)o=a[1],n=e[a[1]]||"",t=t.replace(new RegExp(s+o+s,"g"),n),i.lastIndex=0;return t}},e}(EventDispatcher);var Template;Template=function(){function t(){}return t.RULES="object:\n	start: \\{\n	end: \\}\n	content: \\:+\ndata: \n	start: \\#\\{\n	end: \\}\n	content: [^\\s]+\nif: \n	start: \\(if\n	end: \\)\nforin:\n	start: \\(for\\s+(\\w+)\\s+in\n	end: \\)\nforof: \n	start: \\(for\\s(\\w+)\\sof\n	end: \\)\nselector: \n	start: \\>\nreference: \n	start: \\<\n	content: [^\\s]+\nid: \n	start: \\!\n	content: [^\\s]+\nelement:\n	start: ^(\\w*)\\:\nsequence:\n	start: \\[\n	end: \\]",t.CACHE={},t.ROOT_PATH="",t.EXTENSION=".tpl",t.setRootPath=function(t){return null==t&&(t=""),this.ROOT_PATH=t},t.setExtension=function(t){return null==t&&(t=".tpl"),this.EXTENSION=t},t.addTemplate=function(t,e){var r;return e instanceof TemplateParser?r=e:(r=new TemplateParser,r.parse(e)),this.CACHE[t]=r,r},t.hasTemplate=function(e){return Boolean(t.CACHE[e])},t.renderTemplate=function(t,e,r,n,i){var s;return null==e&&(e=null),null==r&&(r={}),null==n&&(n=null),null==i&&(i=null),this.currentData=r,(s=this.find(t))?s.render(e,r,n,i):void 0},t.render=function(t,e,r,n,i){var s;return null==e&&(e=null),null==r&&(r={}),null==n&&(n=null),null==i&&(i=null),t?(this.CACHE[t]||(s=new TemplateParser(t),s.on(TemplateParser.LOAD_COMPLETE,this._loadComplete),this.CACHE[t]=s),s=this.CACHE[t],s.render(e,r,n,i)):void 0},t._loadComplete=function(){},t.find=function(t){return this.CACHE[t]},t}();var API;API=function(_super){function API(t){if(this._loaded=__bind(this._loaded,this),this._parseJSONElement=__bind(this._parseJSONElement,this),this._progress=__bind(this._progress,this),this.submit=__bind(this.submit,this),this._submitForm=__bind(this._submitForm,this),this._addEventListeners=__bind(this._addEventListeners,this),API.__super__.constructor.apply(this,arguments),this.TYPES=["normal","json"],this._headers=[],this._reuse=!0,this._method="POST",this._jsonp=!1,this._type="normal",t instanceof HTMLElement&&"form"===t.tagName.toLowerCase())this._form=t,setTimeout(this._addEventListeners,10);else if("undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase)this._form=t,setTimeout(this._addEventListeners,10);else if("string"==typeof t)this._url=t;else if(null!=t)throw new Error("The API constructor argument needs to be a URL string or a Form element.")}return __extends(API,_super),API.COMPLETE="apiComplete",API.ERROR="apiError",API.PROGRESS="apiProgress",API._interceptors=[],API._request=function(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("MSXML2.XMLHTTP.3.0"):void 0},API.call=function(t,e,r,n,i){var s;return null==e&&(e=null),null==r&&(r=null),null==n&&(n=null),null==i&&(i="normal"),s=new API(t),t instanceof HTMLElement&&"form"===t.tagName.toLowerCase()?t.submit():"undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase&&t.submit(),r&&s.on(API.COMPLETE,r),n&&s.on(API.ERROR,n),s.type=i,s.submit(e),s},API.intercept=function(t,e){var r;for(t instanceof RegExp||(t=new RegExp(t)),r=this._interceptors.length;r-->0;)if(this._interceptors[r].regex===t&&this._interceptors[r].callback===e)return;return this._interceptors.push({regex:t,callback:e})},API.unintercept=function(t,e){var r,n;for(null==e&&(e=null),r=this._interceptors.length,n=[];r-->0;)n.push(this._interceptors[r].regex===t&&e&&this._interceptors[r].callback===e?this._interceptors.splice(r,1):void 0);return n},API._findInterceptor=function(t,e){var r,n,i;for(r=this._interceptors.length,i=[];r-->0;)n=this._interceptors[r],n.regex===t&&n.callback===e&&i.push(n);return i},API._checkInterceptor=function(t,e){var r,n,i,s;for(i=this._interceptors.length,r=-1,s=[];++r<i;)n=this._interceptors[r],n.regex.lastIndex=0,s.push(n.regex.test(t)?"function"==typeof n.callback?n.callback(e,t):void 0:void 0);return s},API.get({reuse:function(){return this._reuse}}),API.set({reuse:function(t){return this._reuse=Boolean(t)}}),API.get({type:function(){return this._type}}),API.set({type:function(t){if(!(__indexOf.call(this.TYPES,t)>=0))throw new Error("API.type can only be: "+this.TYPES.join(", "));return this._type=t}}),API.get({method:function(){return this._method}}),API.set({method:function(t){if(!/^(get|post)$/i.test(t))throw new Error("Method can only be either GET or POST");return this._method=t.toUpperCase()}}),API.get({jsonp:function(){throw new Error("Not implemented yet")}}),API.set({jsonp:function(){throw new Error("Not implemented yet")}}),API.get({data:function(){return this._data}}),API.get({requestURL:function(){return this._requestURL}}),API.prototype._addEventListeners=function(){return this._form?this._form.on("submit",this._submitForm):void 0},API.prototype._submitForm=function(){return this.submit()},API.prototype.addHeader=function(t,e){return this._headers[t]=e},API.prototype.removeHeader=function(t){return this._headers[t]=null,delete this._headers[t]},API.prototype.load=function(t,e){return null==e&&(e=null),this._url=t,this.submit(e)},API.prototype.submit=function(t){var e,r,n,i,s,o,a,l,h,u,c,d,_,p,f,g;if(null==t&&(t=null),this._data=t,!this._submitting){if(this._submitting=!0,t instanceof HTMLElement&&"form"===t.tagName.toLowerCase()?(this._form=t,t=null):"undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase&&(this._form=t,t=null),l=this._url||"",this._form)this._form.hasAttribute("action")&&(l=this._form.getAttribute("action")),this._form.hasAttribute("enctype")&&this.addHeader("Content-type",this._form.getAttribute("enctype")),this._form.hasAttribute("method")&&(this.method=this._form.getAttribute("method")),this._form.hasAttribute("type")&&"json"===this._form.getAttribute("type")?(this.addHeader("Content-type","application/json;charset=UTF-8"),t=JSON.stringify(this._parseJSON(this._form))):t=new FormData(this._form);else if("normal"===this._type){if(t||(t=new FormData),t&&!(t instanceof FormData)){e=new FormData;for(s in t)u=t[s],e.append(s,u);t=e}}else"json"===this._type&&(this.addHeader("Content-type","application/json;charset=UTF-8"),t=JSON.stringify(t));if(n={},h=window.location.search)for(h=h.replace(/^\??/,"").split("&"),c=0,d=h.length;d>c;c++)a=h[c],o=a.split("="),(null!=(_=o[0])?_.trim().length:void 0)>0&&(n[o[0].trim()]=null!=(p=o[1])?p.trim():void 0);r=[];for(i in n)u=n[i],r.push(i+"="+u);if(r=r.join("&"),r.length>0&&(l+=l.indexOf("?")>=0?"&"+r:"?"+r),this._requestURL=l,this._request=API._request(),this._request.onreadystatechange=this._loaded,null!=(f=this._request.upload)&&f.addEventListener("progress",this._progress),this._request.addEventListener("progress",this._progress),this._request.open(this.method,l,!0),this._headers){g=this._headers;for(i in g)u=g[i],this._request.setRequestHeader(i,u)}this._request.send(t)}},API.prototype._progress=function(t){var e;return e=t.loaded>t.total?.5:t.loaded/t.total,e*=.5,t.currentTarget!==this._request.upload&&(e+=.5),this._triggerProgress(e)},API.prototype._triggerProgress=function(t){return this.trigger(API.PROGRESS,{loaded:t,total:1,progress:t})},API.prototype._parseJSON=function(t){var e;return this._parsedElements=[],e=this._parseJSONElement(t)},API.prototype._parseJSONElement=function(t,e){var r,n,i,s,o,a,l,h,u,c,d,_,p,f,g;
for(null==e&&(e=0),h=t.querySelectorAll("[json-name]"),c={},s="",i=e;i-->0;)s+=" ";for(r=0,_=0,f=h.length;f>_;_++)l=h[_],this._parsedElements.indexOf(l)>=0||(this._parsedElements.push(l),u=l.getAttribute("json-name"),(n=this._parseJSONElement(l,e+2))&&(c[u]||(c[u]=[]),c[u].push(n)));for(a=t.querySelectorAll("input,textarea"),p=0,g=a.length;g>p;p++)if(o=a[p],!(this._parsedElements.indexOf(o)>=0)){if(this._parsedElements.push(o),d=o.value,o.hasAttribute("type"))switch(o.getAttribute("type").toLowerCase()){case"radio":case"checkbox":if(c[o.name]||(c[o.name]=[]),!o.checked)continue}c[o.name]?(Array.isArray(c[o.name])||(c[o.name]=[c[o.name]]),c[o.name].push(d)):c[o.name]=d}return c},API.prototype.abort=function(){return this._submitting=!1,this._request&&(this._request.onreadystatechange=null,this._request.abort()),this._reuse?void 0:this.off()},API.prototype._loaded=function(e){var data,response;if(4===e.currentTarget.readyState){if(this._submitting=!1,200===e.currentTarget.status){this._triggerProgress(1),response=e.currentTarget.responseText||e.currentTarget.response||"";try{data=eval("("+response+")")}catch(_error){e=_error;try{data=JSON.stringify(response)}catch(_error){}}return data?"string"==typeof data&&(data=response):data=response,(null!=data?data.error:void 0)?this._loadError(data):this._loadSuccess(data)}return this._loadError(404===e.currentTarget.status?{message:""}:{message:""})}},API.prototype._loadSuccess=function(t){return null==t&&(t=null),this.trigger(API.COMPLETE,t),this.constructor._checkInterceptor(this._requestURL,t)},API.prototype._loadError=function(t){return null==t&&(t=null),this.trigger(API.ERROR,t),this.constructor._checkInterceptor(this._requestURL,t)},API}(EventDispatcher);var User;User=function(t){function e(){this._mouseDown=__bind(this._mouseDown,this),this._userAPIIntercepted=__bind(this._userAPIIntercepted,this),e.__super__.constructor.apply(this,arguments),this._logged=!1,API.intercept(/api\/cms\/user\/.+/g,this._userAPIIntercepted),this._getUser()}return __extends(e,t),e.STATUS_CHANGE="user_statusChange",e.API_PATH="../api/cms/user/",e.prototype._userAPIIntercepted=function(t,e){var r;if(r=e.replace(/^.*?api\/cms\/user\/([^\?]*)\??.*$/,"$1"),null!=t.error)switch(t.code){case 100:return this._showLogin();case 101:return"Login error";case 102:return"No permission"}else switch(r){case"getUser":case"login":return this._data=t,this._changeStatus(!0),app["interface"].show();case"forgot":return 2;case"changePassword":return 3;case"logout":return this._changeStatus(!1),this._logged=!1,this._showLogin()}},e.get({data:function(){return this._data}}),e.get({logged:function(){return this._logged}}),e.prototype._changeStatus=function(t){return this._logged=t,this.trigger(this.constructor.STATUS_CHANGE,t)},e.prototype._getUser=function(){return API.call(this.constructor.API_PATH+"getUser")},e.prototype._showLogin=function(){return app.template.isCurrent("user/login")?void 0:app.template.render("user/login",null,document.body)},e.prototype._showLoginError=function(){},e.prototype._mouseDown=function(){return this._showLogin()},e}(EventDispatcher);var Resizer;Resizer=function(t){function e(){this._resize=__bind(this._resize,this),e.__super__.constructor.apply(this,arguments),window.addEventListener("resize",this._resize)}return __extends(e,t),e.getInstance=function(){return null!=e._instance?e._instance:e._instance=function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(e,arguments,function(){})},e.prototype._resize=function(){return this.trigger("resize")},e}(EventDispatcher);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.core.InterfaceController=function(){function t(){this._loginStatusChange=__bind(this._loginStatusChange,this),this._interfaceRendered=__bind(this._interfaceRendered,this),this._interfaceLoaded=__bind(this._interfaceLoaded,this),app.user.on(User.STATUS_CHANGE,this._loginStatusChange)}return t.getInstance=function(){return null!=t._instance?t._instance:t._instance=function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(t,arguments,function(){})},t.prototype.show=function(t){return null==t&&(t=null),app.user.logged?this._interfaceShown?(t||(t=app.router.getCurrentPath()),t=t.trim("/"),0===t.length&&(t="index"),this._showPage(t)):void this._showInterface():void 0},t.prototype._showPage=function(t){var e,r,n,i,s,o,a;o=this._findValidPage(t),i={},n=app.router.getParsedPath(),r=t.substr(t.indexOf(o)+o.length).trim("/").split("/");for(e in r)s=r[e],i[e]=s;a=n.params;for(e in a)s=a[e],i[e]=s;return slikland.Mara.setGlobalObject("$",i),app.template.render("pages/"+o,{},this._context)},t.prototype._findValidPage=function(t){var e,r;for(null==t&&(t=""),t=t.trim("/"),e=this._availPages.length;e-->0;)if(r=this._availPages[e].path,0===t.indexOf(r))return r;return null},t.prototype._showInterface=function(){return app.user.logged?(this._interfaceShown=!0,API.call("../api/cms/cms/getInterface",null,this._interfaceLoaded)):void 0},t.prototype._interfaceLoaded=function(t,e){var r;return this._availPages=e.pages,this._availPages.sort(this._sortPages),r={user:app.user.data,"interface":e},app.template.render("interface/interface",r,document.body,this._interfaceRendered)},t.prototype._sortPages=function(t,e){var r,n,i,s;return t=t.path.trim("/"),e=e.path.trim("/"),r=t.split("/").length,i=e.split("/").length,i>r?-1:r>i?1:(n=t.length,s=e.length,s>n?-1:n>s?1:0)},t.prototype._interfaceRendered=function(t){var e;return e=t[0][1],this._header=e.querySelector("header"),this._menu=e.querySelector("nav"),this._context=e.querySelector("main"),this.show()},t.prototype._loginStatusChange=function(){return this._interfaceShown=!1},t}();var __hasProp={}.hasOwnProperty;cms.ui.attributes.Template=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="a[template],button[template]",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._click=function(){var t;return t={template:this.attr("template"),target:this.attr("templateTarget"),currentTarget:this},app.trigger(Main.RENDER_TEMPLATE,t)},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Sort=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="[sort]",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._sortByOrder=__bind(this._sortByOrder,this),this._click=__bind(this._click,this),this._update=__bind(this._update,this),this._resetOthers=__bind(this._resetOthers,this),this._parseParam=__bind(this._parseParam,this),e.__super__.constructor.call(this,{element:t}),this._name=this.attr("sort"),this._element.setAttribute("name","sort"),this._sortButton=document.createElement("span"),this._sortButton.className="sort",this._icon=document.createElement("i"),this._icon.className="fa icon",this._sortButton.appendChild(this._icon),this._sortOrder=document.createElement("sup"),this._sortButton.appendChild(this._sortOrder),this._target=this.attr("for")?document.querySelector("#"+this.attr("for")):this.findParents("[service]"),this._parseParam(),this._element.on("click",this._click),this._element.on("update",this._update),this.appendChild(this._sortButton)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._parseParam=function(){var t,e,r;if(r=this._target.getAttribute("id")){if(t=app.router.getParam(r),!t)return;return t.sort&&(t=[].concat(t.sort),(e=t.indexOf(this._name))>=0?(t.length>1&&(this._element.sortOrder=e),this._element.value=this._name):(e=t.indexOf("-"+this._name))>=0&&(t.length>1&&(this._element.sortOrder=e),this._element.value="-"+this._name)),this._element.setAttribute("for",r),this._update()}},e.prototype._resetOthers=function(){var t,e,r;for(e=this._target.querySelectorAll("[sort]"),t=e.length,r=[];t-->0;)e[t].sortOrder=null,delete e[t].sortOrder,e[t]!==this._element&&r.push(e[t].value=null);return r},e.prototype._updateAll=function(){var t,e,r;for(e=this._target.querySelectorAll("[sort]"),t=e.length,r=[];t-->0;)r.push(e[t].trigger("update"));return r},e.prototype._update=function(){return this._element.value?this._element.setAttribute("value",this._element.value):this._element.removeAttribute("value"),isNaN(this._element.sortOrder)?(this._element.removeAttribute("sortOrder"),this._sortOrder.innerHTML=""):(this._element.setAttribute("sortOrder",this._element.sortOrder),this._sortOrder.innerHTML=this._element.sortOrder)},e.prototype._click=function(t){var e,r,n,i;if(i=this._element.value,i=i&&!/^\-/.test(i)?"-"+this._name:this._name,t.metaKey){for(n=ArrayUtils.toArray(this._target.querySelectorAll("[sort][value]")),n.sort(this._sortByOrder),r=n.length,e=n.length;e-->0;)n[e].sortOrder=e,n[e]===this._element&&(r=e);this._element.sortOrder=r}else this._resetOthers();return this._element.value=i,this._updateAll(),this._target.trigger("update")},e.prototype._sortByOrder=function(t,e){return t.sortOrder<e.sortOrder?-1:t.sortOrder>e.sortOrder?1:0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.attributes.Size=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR="[height],[width]",e.prototype._update=function(t){var e,r,n,i,s;for(n=t.add,e=n.length,s=[];e-->0;)r=n[e],r.hasAttribute("width")&&(i=r.getAttribute("width"),/^\s*[\d\.]+\s*$/.test(i)&&(i+="px"),r.style.width=i),r.hasAttribute("height")?(i=r.getAttribute("height"),/^\s*[\d\.]+\s*$/.test(i)&&(i+="px"),s.push(r.style.height=i)):s.push(void 0);return s},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Service=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="[service]",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],e.hasAttribute("service")&&(this._plugins[e]=new r(e));for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._sortByOrder=__bind(this._sortByOrder,this),this._serviceError=__bind(this._serviceError,this),this._serviceLoaded=__bind(this._serviceLoaded,this),this._parseData=__bind(this._parseData,this),this._onProgress=__bind(this._onProgress,this),this._showProgress=__bind(this._showProgress,this),this._removeProgress=__bind(this._removeProgress,this),this._loadService=__bind(this._loadService,this),this._update=__bind(this._update,this),e.__super__.constructor.call(this,{element:t}),this._element.on("update",this._update),this._loadServiceTimeout=setTimeout(this._loadService,1)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._update=function(){return clearTimeout(this._loadServiceTimeout),this._loadServiceTimeout=setTimeout(this._loadService,300)},e.prototype._loadService=function(){var t;return clearTimeout(this._loadServiceTimeout),t=this._parseData(),this._api=API.call(this._element.getAttribute("service"),t,this._serviceLoaded,this._serviceError),this._api.on(API.PROGRESS,this._onProgress),this._showProgress()},e.prototype._removeEventListeners=function(){return this._api.off(API.PROGRESS,this._onProgress)},e.prototype._removeProgress=function(){return this._loading?this._loading.hide():void 0},e.prototype._showProgress=function(){return this.element.hasAttribute("noloading")?void 0:(this._loading||(this._loading=new cms.ui.Loading),this._loading.show(),this.appendChildAt(this._loading,0))},e.prototype._onProgress=function(t,e){var r;return null!=(r=this._loading)?r.progress=e.progress:void 0},e.prototype._parseData=function(){var t,e,r,n,i,s,o,a,l,h,u,c,d,_,p;if(a=app.router.getParam(this.attr("id")),this.attr("id")){for(e=this.attr("id"),a={},o=!1,n=document.querySelectorAll("[for="+e+"]"),c=0,d=n.length;d>c;c++){switch(r=n[c],i=!1,s=r.getAttribute("name"),u=r.value,r.tagName.toLowerCase()){case"input":"checkbox"===(_=r.getAttribute("type"))&&(i=!0),("checkbox"===(p=r.getAttribute("type"))||"radio"===p)&&(r.checked||(u=null));break;case"pagination":r.index&&(o=!0,a._index=r.index),r.numItems&&(a._numItems=r.numItems);break;default:if(r.hasAttribute("sort"))continue}u&&(o=!0,i?(a[s]||(a[s]=[]),a[s].push(u)):a[s]=u)}if(l=ArrayUtils.toArray(this._element.querySelectorAll("[sort][value]")),l.length>0){for(l.sort(this._sortByOrder),h=[],t=l.length;t-->0;)h[t]=l[t].value;o=!0,a.sort=h}o?app.router.setParam(e,a):app.router.removeParam(e)}return a},e.prototype._serviceLoaded=function(t,e){var r,n,i;if(app.template.renderBlock(this._element,e),this.attr("id"))for(n=this.attr("id"),i=document.querySelectorAll("[for="+n+"]"),r=i.length;r-->0;)i[r].trigger("update",e);return this._element.trigger("updated",e),this._removeEventListeners(),this._removeProgress()},e.prototype._serviceError=function(){return this._removeEventListeners(),this._removeProgress()},e.prototype._sortByOrder=function(t,e){return t.sortOrder<e.sortOrder?-1:t.sortOrder>e.sortOrder?1:0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Href=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="[href]",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],e.hasAttribute("href")&&!e.getAttribute("target")&&(this._plugins[e]=new r(e));for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._click=function(t){return app.router.goto(this.attr("href")),t.preventDefault(),t.stopImmediatePropagation()},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.For=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="[for]",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],e.hasAttribute("sort")||(this._plugins[e]=new r(e));for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._change=__bind(this._change,this),e.__super__.constructor.call(this,{element:t}),this._target=document.querySelector("#"+this.attr("for")),this._setItemValue(),this._element.on("change",this._change),this._element.on("input",this._change)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._setItemValue=function(){var t,e,r,n,i,s;if(e=this._element.getAttribute("for"),t=app.router.getParam(e),t&&(r=this._element.getAttribute("name"),r&&t[r])){if(t=t[r],"input"!==this._element.tagName.toLowerCase()||"checkbox"!==(n=null!=(i=this._element.getAttribute("type"))?i.toLowerCase():void 0)&&"radio"!==n)return this._element.value=t;if(s=this._element.value,__indexOf.call(t,s)>=0)return this._element.checked=!0,this._element.trigger("change")}},e.prototype._change=function(){var t;return null!=(t=this._target)?t.trigger("update"):void 0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.attributes.Focus=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR="[focus]",e.prototype._update=function(t){var e,r,n,i;for(n=t.add,e=n.length,i=[];e-->0;)r=n[e],i.push(r.focus());return i},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.FAB=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR='button[type="fab"]',e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._checkPosition=__bind(this._checkPosition,this),this._scroll=__bind(this._scroll,this),this.destroy=__bind(this.destroy,this),this._setPosition=__bind(this._setPosition,this),e.__super__.constructor.call(this,{element:t}),this.attr("on")&&(this.css("visibility","hidden"),setTimeout(this._setPosition,100))}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._setPosition=function(){return this._target=document.querySelector("#"+this.attr("on")),console.log(this._target),this._position="TR",this.attr("position")&&(this._position=this.attr("position")),this._checkPosition(),this.css("visibility","")},e.prototype.destroy=function(){return e.__super__.destroy.apply(this,arguments),this._target=null,window.cancelAnimationFrame(this._checkPositionTicker)},e.prototype._scroll=function(){return console.log("scroll")},e.prototype._checkPosition=function(){var t,e,r,n,i;if(this._target&&this._element.parentNode)return this._checkPositionTicker=window.requestAnimationFrame(this._checkPosition),e=this._getTargetBounds(this._target),n=this._element.parentNode.getBoundingClientRect(),t=this.getBounds(),i=e.top+.25*t.height,r=e.left,e.bottom<1.5*t.height?i=e.bottom-1.25*t.height:i<.25*t.height&&(i=.25*t.height),i+=n.top,e.right<1.25*t.width?r=e.bottom-1.25*t.width:0>r&&(r=0),r+=n.left+e.width-1.25*t.width,this.css({top:i+"px",left:r+"px"})},e.prototype._getTargetBounds=function(t){var e,r,n,i,s;null==t&&(t=null),r={},e=t.getBoundingClientRect();for(n in e)s=e[n],r[n]=s;return this._element.parentNode&&(i=this._element.parentNode.getBoundingClientRect()),i&&(r.top-=i.top,r.left-=i.left,r.bottom-=i.top,r.right-=i.left),r.width=r.right-r.left,r.height=r.bottom-r.top,r},e}(BaseDOM),e}(cms.ui.Base);var MouseUtils;MouseUtils=function(){function t(){}return t.getMousePos=function(t,e){var r,n;return null==e&&(e=!0),r=t.pageX||t.clientX,n=t.pageY||t.clientY,e&&(r+=document.body.scrollLeft+document.documentElement.scrollLeft,n+=document.body.scrollTop+document.documentElement.scrollTop),[r,n]},t.toGlobal=function(t,e){return t+=document.body.scrollLeft+document.documentElement.scrollLeft,e+=document.body.scrollTop+document.documentElement.scrollTop,[t,e]},t}();var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Draggable=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="[draggable]",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._moveCloned=__bind(this._moveCloned,this),this._mouseUp=__bind(this._mouseUp,this),this._sortPosition=__bind(this._sortPosition,this),this._switchElement=__bind(this._switchElement,this),this._findElementToSwitch=__bind(this._findElementToSwitch,this),this._mouseMove=__bind(this._mouseMove,this),this._mouseDown=__bind(this._mouseDown,this),this._findParentContext=__bind(this._findParentContext,this),e.__super__.constructor.call(this,{element:t}),this._draggableName=this.attr("draggable"),this._dragHandler=document.createElement("i"),this._dragHandler.className="drag-handle fa fa-ellipsis-h",this._dragHandler.on("mousedown",this._mouseDown),this._draggableContextSelector='[draggableContext="'+this._draggableName+'"]',this.appendChild(this._dragHandler),this._parentContexts=this._findParentContext(),0===this._parentContexts.length&&(this._parentContexts=[t.parentNode]),this._setupDraggables(),this._getDraggableItems()}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._findParentContext=function(t){var e,r,n;for(null==t&&(t=null),e=document.body.querySelectorAll(this._draggableContextSelector),n=[],r=e.length;r-->0;)e[r].findParents(this._draggableContextSelector)||n.push(e[r]);return n},e.prototype._addEventListeners=function(){return window.addEventListener("mousemove",this._mouseMove),window.addEventListener("mouseup",this._mouseUp),window.addEventListener("mouseleave",this._mouseLeave)},e.prototype._removeEventListeners=function(){return window.removeEventListener("mousemove",this._mouseMove),window.removeEventListener("mouseup",this._mouseUp),window.removeEventListener("mouseleave",this._mouseLeave)},e.prototype._drop=function(){return this._items=null,this._removeEventListeners(),this._cloned.parentNode.removeChild(this._cloned),this._element.style.opacity=""},e.prototype._mouseDown=function(t){var e,r;return this._updateDraggableItems(),t.preventDefault(),this._cloned=this._element.cloneNode(!0),this._cloned.setAttribute("cloned","1"),this._cloned.style.position="absolute",this._cloned.style.opacity="0.4",r=this.getBounds(this._dragHandler),this._elOffset={x:t.offsetX-r.left,y:t.offsetY-r.top},this._cloned.style.top="0px",this._cloned.style.left="0px",this._cloned.style.zIndex="100",e=this.getBounds(),this._cloned.style.width=e.width+"px",this._cloned.style.height=e.height+"px",this._element.style.opacity="0.6",this._element.parentNode.appendChild(this._cloned),this._moveCloned(t),this._addEventListeners()},e.prototype._setupDraggables=function(){var t,e,r,n,i,s,o,a,l;if(!this._parentContexts[0].querySelector("draggableplaceholder")){for(a=this._parentContexts,l=[],s=0,o=a.length;o>s;s++){for(r=a[s],e=r.querySelectorAll('[draggableContext="'+this._draggableName+'"]'),n=e.length;n-->0;)t=e[n],i=document.createElement("draggableplaceholder"),i.style.width="100%",i.style.height="100%",i.style.display="inline-block",t.appendChild(i);i=document.createElement("draggableplaceholder"),i.style.width="100%",i.style.height="100%",i.style.display="inline-block",l.push(r.appendChild(i))}return l}},e.prototype._getDraggableItems=function(){var t;return t=this._getDraggableChildren(this._parentContexts)},e.prototype._getDraggableChildren=function(t){var e,r,n,i,s,o;for(i=[],t=[].concat(t),s=0,o=t.length;o>s;s++)for(r=t[s],e=r.children,n=e.length;n-->0;)e[n]===this._element||e[n].hasAttribute("cloned")||i.push({element:e[n]});return i},e.prototype._updateDraggableItems=function(){var t,e,r,n,i,s,o;for(this._items||(this._items=this._getDraggableItems()),n=this._items.length,o=[];n-->0;)i=this._items[n],r=i.element,s=this._getElementPosition(r),(t=r.querySelector("draggableContext"))&&(e=this._getElementPosition(t),s.h-=e.h,s.cy=s.y+.5*e.h),o.push(i.pos=s);return o},e.prototype._getElementPosition=function(t,e){var r,n,i,s,o,a,l,h;return null==e&&(e=!1),i={},l=document.body.scrollLeft+document.documentElement.scrollLeft,h=document.body.scrollTop+document.documentElement.scrollTop,r=t.getBoundingClientRect(),s=r.left,o=r.top,a=r.right-s,n=r.bottom-o,i.x=s+l,i.y=o+h,i.w=a,i.h=n,i.cx=i.x+.5*a,i.cy=i.y+.5*n,i},e.prototype._mouseMove=function(t){var e,r;return this._moveCloned(t),r=this._getElementPosition(this._cloned),e=this._findElementToSwitch(r),e?(this._switchElement(e.element,e.after),this._moveCloned(t)):void 0},e.prototype._findElementToSwitch=function(t,e){var r,n,i,s,o,a,l,h,u,c,d,_,p,f,g,m,v,y,b,E,w;for(null==e&&(e=null),e||(e=this._parentContexts),e=[].concat(e),a=null,c=Number.MAX_VALUE,y=0,b=e.length;b>y;y++){for(h=e[y],o=h.children,m=[],p=o.length;p-->0;)s=o[p],s===this._element||s.matches("[cloned]")||m.push(s);for(p=m.length;p-->0;)g=m[p],f=this._getElementPosition(g),d=f.cx-t.cx,_=f.cy-t.cy,u=d*d+_*_,c>u&&(c=u,r=Math.atan2(_,d),a=g,l=f)}return a?(h=a.querySelector('[draggableContext="'+this._draggableName+'"]'))&&(i=this._getElementPosition(h),i.x<(E=t.cx)&&E<i.x+i.w&&i.y<(w=t.cy)&&w<i.y+i.y)?this._findElementToSwitch(t,h):(v=2*Math.PI,r=(r%v+v)%v,n=r>.375*v&&.875*v>r,{element:a,after:n}):void 0},e.prototype._switchElement=function(t,e){var r,n,i,s,o,a;for(o=t.parentNode,n=o.children,i=-1,a=-1,s=n.length;s-->0;)r=n[s],r===t&&(a=s),r===this._element&&(i=s);return e&&(a+=1),i!==a?(a>=n.length-1?o.appendChild(this._element):o.insertBefore(this._element,n[a]),this._updateDraggableItems()):void 0},e.prototype._sortPosition=function(){return 0},e.prototype._mouseUp=function(){return this._drop()},e.prototype._moveCloned=function(t){var e,r,n,i;return r=MouseUtils.getMousePos(t),e=this._cloned.parentNode.getBoundingClientRect(),n=r[0]-e.left-this._elOffset.x,i=r[1]-e.top-this._elOffset.y,this._cloned.style.left=n+"px",this._cloned.style.top=i+"px"},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Confirm=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="[confirm]",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._click=function(t){var e;return e=this.attr("confirm"),window.confirm(e)?void 0:(t.preventDefault(),t.stopImmediatePropagation())},e}(BaseDOM),e}(cms.ui.Base);var ColorUtils;ColorUtils=function(){function t(){}return t.lightenColor=function(t,e){var r,n,i,s,o;return o=!1,"#"===t[0]&&(t=t.slice(1),o=!0),i=parseInt(t,16),s=(i>>16)+e,s>255?s=255:0>s&&(s=0),r=(i>>8&255)+e,r>255?r=255:0>r&&(r=0),n=(255&i)+e,n>255?n=255:0>n&&(n=0),o?"#"+(n|r<<8|s<<16).toString(16):(n|r<<8|s<<16).toString(16)},t.luminance=function(t){var e;return e=this.hexToRGBArray(t),(.2126*e[0]+.7152*e[1]+.0722*e[2])/255},t.hexToRGB=function(t){var e;return e=this.hexToRGBArray(t),{r:e[0],g:e[1],b:e[2],a:e[3]}},t.hexToRGBArray=function(t){return t=Number(t.replace(/^\#?([0-9a-f]*?)$/i,"0x$1")),[t>>16&255,t>>8&255,255&t,t>>24&255]},t.rgbToHex=function(t,e,r,n){return null==n&&(n=0),this.rgbArrayToHex([t,e,r,n])},t.rgbArrayToHex=function(t){var e,r;for(r=6,e=t[0]<<16|t[1]<<8|t[2],t[3]&&(r=8,e|=t[3]<<24),e=e.toString();e.length<r;)e="0"+e;return e},t}();var __hasProp={}.hasOwnProperty;cms.ui.attributes.Background=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR="[background]",e.prototype._update=function(t){var e,r,n,i,s,o;for(i=t.add,r=i.length,o=[];r-->0;){n=i[r],e=n.getAttribute("background");try{s=ColorUtils.luminance(e),isNaN(s)||(n.style.color=s>.75?"#666666":"#FFFFFF")}catch(a){}o.push(n.style.background=e)}return o},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Action=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR=":not(form)[action]",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u,c;for(h=t.add,s=0,a=h.length;a>s;s++)n=h[s],n.hasAttribute("action")&&!n.getAttribute("target")&&(e=n.getAttribute("action"),/\/api\/.*?$/.test(e)&&(this._plugins[n]=new r(n)));for(u=t.remove,c=[],o=0,l=u.length;l>o;o++)n=u[o],i=this._plugins[n],c.push(i?"function"==typeof i.destroy?i.destroy():void 0:void 0);return c},r=function(t){function e(t){this._apiComplete=__bind(this._apiComplete,this),this._click=__bind(this._click,this),this._addEventListener=__bind(this._addEventListener,this),e.__super__.constructor.call(this,{element:t}),setTimeout(this._addEventListener,1)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._addEventListener=function(){return this._element.on("click",this._click)},e.prototype._click=function(t){return API.call(this._element.getAttribute("action"),null,this._apiComplete),t.preventDefault(),t.stopImmediatePropagation()},e.prototype._apiComplete=function(){var t;if(t=this.attr("success"),t&&t.length>0)switch(t){case"refresh":return app["interface"].show();case"reload":return window.location.reload();default:return app["interface"].show(t)}},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Validation=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="field validation",e._validate_email=function(t){return/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+)+(\.[a-zA-Z0-9]{2,63})+$/.test(t)},e._validate_required=function(t){var e;return t&&0!==(null!=(e=t.trim())?e.length:void 0)?!0:!1},e._validate_regex=function(t,e){var r,n,i;return(n=null!=e&&null!=(i=e.item)?i.getAttribute("pattern"):void 0)&&(r=/^(\/?)(.*?)(?:\1([a-z]*))?$/.exec(n))?(n=new RegExp(r[2],r[3]),n.test(t)):!1},e._validate_match=function(t,e,r){var n,i;return n=null!=e&&null!=(i=e.item)?i.getAttribute("field"):void 0,n=r[n],n||(n=r.querySelector(n)),n?n.value===t:!1},e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function r(t){this._submit=__bind(this._submit,this),this._validate=__bind(this._validate,this),this._blur=__bind(this._blur,this),this._change=__bind(this._change,this),this._parseValidations=__bind(this._parseValidations,this),this.destroy=__bind(this.destroy,this),r.__super__.constructor.call(this,{element:t}),this._parseValidations(),this._form=this.findParents("form"),this._field=new BaseDOM(this.findParents("field")),this._input=this._field.find("input"),this._input.on("blur",this._blur),this._input.on("change",this._change),this._input.on("input",this._change),this._form.on("submit",this._submit)}return __extends(r,t),r._destroyPlugin=function(){},r.prototype.destroy=function(){},r.prototype._parseValidations=function(){var t,r,n,i,s,o,a,l;for(s=[],n=this._element.childNodes,t=n.length,o=0,a=n.length;a>o;o++)r=n[o],r.nodeType&&r.nodeType===Node.ELEMENT_NODE&&e["_validate_"+r.tagName.toLowerCase()]&&(i={item:r,type:r.tagName.toLowerCase(),validation:e["_validate_"+r.tagName.toLowerCase()],message:(null!=(l=r.querySelector("message"))?l.innerHTML:void 0)||r.getAttribute("message")||null},s.push(i));return this._validations=s},r.prototype._change=function(){return this._passed?this._validate():void 0},r.prototype._blur=function(){return this._passed=!0,this._validate()},r.prototype._validate=function(){var t,e,r,n,i,s;for(r=this._input.value,t=!0,s=this._validations,n=0,i=s.length;i>n;n++)if(e=s[n],!e.validation(r,e,this._form)){t=!1;break}return t?(this._field.removeClass("invalid"),this._field.addClass("valid"),this._hideMessage()):(this._field.removeClass("valid"),this._field.addClass("invalid"),e.message&&this._showMessage(e.message)),t},r.prototype._showMessage=function(t){var e;return e=this._field.find(".validation-message"),e||(e=document.createElement("div"),e.className="validation-message",this._field.appendChild(e)),e.style.display="",e.innerHTML=t},r.prototype._hideMessage=function(){var t;return(t=this._field.find(".validation-message"))?t.style.display="none":void 0},r.prototype._submit=function(t){return this._blur()?void 0:t.preventDefault()},r}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Toggle=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="toggle",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;
for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._update=__bind(this._update,this),this._toggle=__bind(this._toggle,this),this._change=__bind(this._change,this),e.__super__.constructor.call(this,{element:t}),this._input=this.find("input"),this._input&&(this.selected=this._input.checked,this._input.on("change",this._update)),this._element.on("click",this._toggle),this._element.on("change",this._change)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._change=function(){},e.get({selected:function(){return this._selected}}),e.set({selected:function(t){return t!==this._selected?(this._selected=t,this._element.setAttribute("selected",t),this._element.selected=t,this._input&&(this._input.checked=t),this._element.trigger("change")):void 0}}),e.prototype._toggle=function(){return this.selected=!this._selected,this._input.trigger("change")},e.prototype._update=function(t){return null==t&&(t=null),this._input?this.selected=this._input.checked:void 0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Form=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="form",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._clearMessage=__bind(this._clearMessage,this),this._apiError=__bind(this._apiError,this),this._apiComplete=__bind(this._apiComplete,this),this._submit=__bind(this._submit,this),this._change=__bind(this._change,this),this._addListeners=__bind(this._addListeners,this),e.__super__.constructor.call(this,{element:t}),setTimeout(this._addListeners,50)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._addListeners=function(){return this._api=new API(this._element),this._api.on(API.COMPLETE,this._apiComplete),this._api.on(API.ERROR,this._apiError),this._element.on("submit",this._submit),this._element.on("change",this._change)},e.prototype._change=function(){return this._clearMessage()},e.prototype._submit=function(t){return console.log(t.defaultPrevented),t.defaultPrevented?void t.stopImmediatePropagation():t.preventDefault()},e.prototype._apiComplete=function(){var t;if(this._element.reset(),t=this.attr("success"),t&&t.length>0)switch(t){case"refresh":return app["interface"].show();case"reload":return window.location.reload();default:return app.router.goto(t)}},e.prototype._apiError=function(t,e){return this._showMessage(null!=e?e.message:void 0)},e.prototype._showMessage=function(t,e){var r,n,i,s,o,a,l,h;if(null==e&&(e=1),!this._messageField){if(!t||0===t.length)return;for(n=this.findAll("validation message"),i=n.length,a=[];i-->0;)a[i]=n[i];for(s=this.findAll("message"),o=[],l=0,h=s.length;h>l;l++)r=s[l],a.indexOf(r)<0&&o.push(r);o.length>0&&(this._messageField=o[0]),this._messageField||(this._messageField=document.createElement("message"),this.appendChildAt(this._messageField,0))}return this._messageField.innerHTML=t},e.prototype._clearMessage=function(){return this._showMessage("")},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Field=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="field",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],r._checkPlugin(e)?this._plugins[e]=new r(e):e.className="filled";for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._checkFilled=__bind(this._checkFilled,this),this._change=__bind(this._change,this),this._blur=__bind(this._blur,this),this._focus=__bind(this._focus,this),this._password=__bind(this._password,this),this._passwordPreviewChange=__bind(this._passwordPreviewChange,this);var r,n,i,s,o,a,l,h,u;if(e.__super__.constructor.call(this,{element:t}),this._input=this._element.querySelector('input:not([type="hidden"]),select,textarea'),("select"===(r=null!=(n=this._input)?n.tagName.toLowerCase():void 0)||"textarea"===r)&&null!=(i=this._input)&&i.setAttribute("type",null!=(s=this._input)?s.tagName.toLowerCase():void 0),null!=(o=this._input)?o.hasAttribute("type"):void 0)switch(this.addClass(this._input.getAttribute("type")),this._input.getAttribute("type").toLowerCase()){case"password":this._checkPasswordPreview()}null!=(a=this._input)&&a.on("focus",this._focus),null!=(l=this._input)&&l.on("blur",this._blur),null!=(h=this._input)&&h.on("change",this._change),null!=(u=this._input)&&u.on("input",this._change),setTimeout(this._checkFilled,1)}return __extends(e,t),e._destroyPlugin=function(){},e._checkPlugin=function(t){var e;return e=t.querySelector('input:not([type="hidden"]),select,textarea'),e.findParents("field")!==t?!1:!0},e.prototype._checkPasswordPreview=function(){var t;return(t=this.find(".show-password"))?(this._passwordPreview=t,this._passwordPreview.off("change",this._passwordPreviewChange)):void 0},e.prototype._passwordPreviewChange=function(){var t,e;return this._passwordPreview.selected?null!=(t=this._input)?t.setAttribute("type","text"):void 0:null!=(e=this._input)?e.setAttribute("type","password"):void 0},e.prototype._password=function(t){var e;return null!=(e=this._input)&&(e.type="text"),t.preventDefault(),t.stopImmediatePropagation()},e.prototype._focus=function(){return this._focused=!0,this._checkFilled()},e.prototype._blur=function(){return this._focused=!1,this._checkFilled()},e.prototype._change=function(){return this._checkFilled()},e.prototype._checkFilled=function(){var t,e,r;return this._focused?void this.addClass("filled"):(t=null!=(e=this._input)?e.value.trim():void 0,0===t.length?(this.removeClass("filled"),null!=(r=this._input)?r.value=t:void 0):this.addClass("filled"))},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Checkbox=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR='input[type="checkbox"]',e.prototype._update=function(t){var e,r,n,i,s;for(i=t.add,s=[],r=0,n=i.length;n>r;r++)e=i[r],s.push(this._buildCheckbox(e));return s},e.prototype._buildCheckbox=function(t){var e,r,n,i,s,o,a,l,h,u,c;if((0===(c=t.getAttribute("checked"))||"0"===c||c===!1||"false"===c||null===c||"null"===c)&&t.removeAttribute("checked"),l=document.createElement("toggle"),n=document.createElement("default"),a=document.createElement("selected"),i=document.createElement("i"),i.className="fa fa-square-o",n.appendChild(i),i=document.createElement("i"),i.className="fa fa-check-square-o",a.appendChild(i),l.append(n),l.append(a),o=t.parentNode,"field"===t.parentNode.tagName.toLowerCase()){for(r=ArrayUtils.toArray(o.children),h=0,u=r.length;u>h;h++)e=r[h],l.appendChild(e);return o.appendChild(l)}return(s=t.parentNode.querySelector("label"))?(l.appendChild(s),o.insertBefore(l,t),l.appendChild(t)):void 0},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags["interface"].NavLink=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="nav ul a",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._routeChange=__bind(this._routeChange,this),this._parseItems=__bind(this._parseItems,this),e.__super__.constructor.call(this,{element:t}),app.router.on(NavigationRouter.CHANGE,this._routeChange),setTimeout(this._routeChange,1)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype.destroy=function(){return e.__super__.destroy.apply(this,arguments),app.router.off(NavigationRouter.CHANGE,this._routeChange)},e.prototype._parseItems=function(){},e.prototype._routeChange=function(){var t,e;return t=app.router.getCurrentPath().trim("/"),e=this.attr("href").trim("/"),this.toggleClass("selected",t===e)},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.visualizer.ChartHelper=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="chart",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._resize=__bind(this._resize,this),this._update=__bind(this._update,this);var r,n;e.__super__.constructor.call(this,{element:t}),(n=this.attr("width"))&&(/^[\d\.]$/.test(n)&&(n+="px"),this.css("width",n)),(r=this.attr("height"))&&(/^[\d\.]$/.test(r)&&(r+="px"),this.css("height",r)),this._canvas=document.createElement("canvas"),this._canvas.setAttribute("width","100%"),this._canvas.setAttribute("height",400),this._context=this._canvas.getContext("2d"),this._element.on("updated",this._update),window.addEventListener("resize",this._resize)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._update=function(t){var e;return e=t.data,this.appendChild(this._canvas),this._resize(),this._data=e,(!e.options||Array.isArray(e.options))&&(e.options={}),e.options.responsive=!1,e.options.maintainAspectRatio=!1,this._chart=new Chart(this._canvas,e),this._chart.onHover=this._mouseMove,this._chart.onMouseMove=this._mouseMove},e.prototype._resize=function(){var t;return t=this.getBounds(),this._canvas.setAttribute("width",t.width),this._canvas.setAttribute("height",t.height),this._canvas.style.width=t.width+"px",this._canvas.style.height=t.height+"px",this._chart?(this._chart.chart.width=t.width,this._chart.chart.height=t.height,this._chart.update(0)):void 0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.Tooltip=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="tooltip",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._out=__bind(this._out,this),this._over=__bind(this._over,this),e.__super__.constructor.call(this,{element:t}),this._parent=t.parentNode,this._parent.on("mouseover",this._over),this._parent.on("mouseout",this._out)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._over=function(){return this.addClass("show")},e.prototype._out=function(){return this.removeClass("show")},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.Pagination=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.SELECTOR="pagination",e.prototype._update=function(t){var e,n,i,s,o,a,l,h,u;for(l=t.add,i=0,o=l.length;o>i;i++)e=l[i],this._plugins[e]=new r(e);for(h=t.remove,u=[],s=0,a=h.length;a>s;s++)e=h[s],n=this._plugins[e],u.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return u},r=function(t){function e(t){this._update=__bind(this._update,this),this._getClosest=__bind(this._getClosest,this),this._mouseMove=__bind(this._mouseMove,this),this._setSeeking=__bind(this._setSeeking,this),this._startPageSeek=__bind(this._startPageSeek,this),this._stopPageSeek=__bind(this._stopPageSeek,this),this._cancelSeek=__bind(this._cancelSeek,this),this._mouseUp=__bind(this._mouseUp,this),this._keyDown=__bind(this._keyDown,this),this._pageMouseDown=__bind(this._pageMouseDown,this),this._lastClick=__bind(this._lastClick,this),this._nextClick=__bind(this._nextClick,this),this._prevClick=__bind(this._prevClick,this),this._firstClick=__bind(this._firstClick,this),e.__super__.constructor.call(this,{element:t}),this._page=0,this._element.on("update",this._update),this._target=document.querySelector("#"+this.attr("for")),this._pages=[],this._pageWrapper=new BaseDOM({element:"div",className:"wrapper"}),this._pageContainer=new BaseDOM({element:"div",className:"page-container"}),this._shadowLeft=new BaseDOM({element:"span",className:"shadow-left"}),this._shadowRight=new BaseDOM({element:"span",className:"shadow-right"}),this._first=new BaseDOM({element:"a",className:"arrow first"}),this._prev=new BaseDOM({element:"a",className:"arrow prev"}),this._next=new BaseDOM({element:"a",className:"arrow next"}),this._last=new BaseDOM({element:"a",className:"arrow last"}),this._first.element.on("click",this._firstClick),this._prev.element.on("click",this._prevClick),this._next.element.on("click",this._nextClick),this._last.element.on("click",this._lastClick),this._first.html="<i />",this._prev.html="<i />",this._next.html="<i />",this._last.html="<i />",this._pageWrapper.appendChild(this._pageContainer),this._pageWrapper.appendChild(this._shadowLeft),this._pageWrapper.appendChild(this._shadowRight),this.appendChild(this._first),this.appendChild(this._prev),this.appendChild(this._pageWrapper),this.appendChild(this._next),this.appendChild(this._last),this._pageContainer.element.on("mousedown",this._pageMouseDown),this._setItemValue()}return __extends(e,t),e._destroyPlugin=function(){},e.get({page:function(){return this._page}}),e.set({page:function(t){var e,r,n,i,s,o,a,l,h;if(t>=this._total-1?(t=this._total-1,this._last.attr("disabled","1"),this._next.attr("disabled","1")):(this._last.element.removeAttribute("disabled"),this._next.element.removeAttribute("disabled")),0>=t?(t=0,this._first.attr("disabled","1"),this._prev.attr("disabled","1")):(this._first.element.removeAttribute("disabled"),this._prev.element.removeAttribute("disabled")),r=!1,this._page!==t&&(r=!0),this._page=t,this._element.index=this._page*this._numItems,this._element.numItems=this._numItems,KTween.remove(this),o=this._pages[this._page]){for(n=this._pages.length;n-->0;)this._pages[n].className=n===this._page?"hover":"";return s=this._pageContainer.getBounds(),e=o.getBoundingClientRect(),a=this._pageContainer.element.scrollLeft,i=.5*(e.right+e.left)-s.left+a-.25*s.width,i/=this._pageContainer.element.scrollWidth-.5*s.width,0>i?i=0:i>1&&(i=1),a=this._pageContainer.element.scrollLeft,l=this._pageContainer.element.scrollWidth,l-s.width<1?(this._shadowLeft.css("width",0),this._shadowRight.css("width",0)):(this._shadowLeft.css("width",2*i+"em"),this._shadowRight.css("width",2*(1-i)+"em")),KTween.tween(this,{scrollPosition:i,onUpdate:this._test},"easeInOutQuart",.3),r&&null!=(h=this._target)?h.trigger("update"):void 0}}}),e.get({total:function(){return this._total}}),e.get({scrollPosition:function(){return this._pageContainer.element.scrollLeft/(this._pageContainer.element.scrollWidth-this._pageContainer.getBounds().width)}}),e.set({scrollPosition:function(t){return this._pageContainer.element.scrollLeft=(this._pageContainer.element.scrollWidth-this._pageContainer.getBounds().width)*t}}),e.prototype._setItemValue=function(){var t,e;return e=this._element.getAttribute("for"),(t=app.router.getParam(e))?(this.attr("numItems")?this._numItems=this.attr("numItems"):t._numItems&&(this._numItems=t._numItems),t._index?this.page=this._page=t._index/this._numItems:void 0):void 0},e.prototype._firstClick=function(){return this.page=0},e.prototype._prevClick=function(){return this.page-=1},e.prototype._nextClick=function(){return this.page+=1},e.prototype._lastClick=function(){return this.page=this.total-1},e.prototype._pageMouseDown=function(t){return this._seeking=!1,this._mousePos=MouseUtils.getMousePos(t),window.addEventListener("mouseup",this._mouseUp),window.addEventListener("mousemove",this._mouseMove),window.addEventListener("keydown",this._keyDown),this._startPageSeek(t),t.preventDefault()},e.prototype._keyDown=function(t){return 27===t.keyCode?this._cancelSeek():void 0},e.prototype._mouseUp=function(){return clearTimeout(this._pageSeekTimeout),this._stopPageSeek()},e.prototype._cancelSeek=function(){return window.removeEventListener("mousemove",this._mouseMove),window.removeEventListener("mouseup",this._mouseUp),window.removeEventListener("keydown",this._keyDown),this.removeClass("seeking"),this._seeking=!0,this.page=this._page},e.prototype._stopPageSeek=function(){return window.removeEventListener("mousemove",this._mouseMove),window.removeEventListener("mouseup",this._mouseUp),window.removeEventListener("keydown",this._keyDown),this.removeClass("seeking"),this._seeking=!0,this._closestItem?this.page=this._closestItem.index:void 0},e.prototype._startPageSeek=function(t){return this._pageSeekTimeout=setTimeout(this._setSeeking,100),this._seeking=!0,this._mouseMove(t)},e.prototype._setSeeking=function(){return this.addClass("seeking")},e.prototype._mouseMove=function(t){var e,r,n,i,s,o,a,l,h,u;return this._prevPos=this._mousePos,this._mousePos=MouseUtils.getMousePos(t,!1),this._seeking&&this._prevPos?(e=this._pageWrapper.getBounds(),i=MouseUtils.toGlobal(e.left,e.top),s=(this._prevPos[0]-i[0])/e.width,r=(this._mousePos[0]-i[0])/e.width,0>s?s=0:s>1&&(s=1),0>r?r=0:r>1&&(r=1),u=s,n=(r-s)*e.width,l=this._pageContainer.element.scrollLeft,o=this._pageContainer.element.scrollWidth,n>0?(u=1-u,h=o-l-e.width*u):h=l+e.width*u,n/=e.width*u,a=l+n*h,0>a?a=0:a>o-e.width&&(a=o-e.width),this._pageContainer.element.scrollLeft+=n*h,this._getClosest()):void 0},e.prototype._getClosest=function(){var t,e,r,n,i,s,o,a,l,h;for(h=[].concat(this._mousePos),a=this._pageWrapper.getBounds(),l=MouseUtils.toGlobal(a.left,a.top),h=[h[0]-l[0],h[1]-l[1]],s=this._pages.length,n=Number.MAX_VALUE,e=null;s-->0;)o=this._pages[s],t=o.getBoundingClientRect(),r=.5*(t.right+t.left)-a.left,i=r-h[0],i*=i,o.className="",n>i&&(n=i,e=o);return e?(e.className="hover",this._closestItem=e):void 0},e.prototype._update=function(t){var e,r,n,i;if(e=t.data,e&&null!=e.total&&null!=e.numItems){for(this._pageContainer.removeAll(),this._pages.length=0,n=Math.ceil(e.total/e.numItems),this._total=n,this._numItems=e.numItems,0===this._total?this.css("display","none"):this.css("display",""),r=-1;++r<n;)i=document.createElement("a"),i.innerHTML=r+1,i.index=r,this._pageContainer.appendChild(i),this._pages[r]=i;return this.page=this._page=Math.floor(e.index/e.numItems)}},e}(BaseDOM),e}(cms.ui.Base);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.ui.UI=function(){function t(){this._updateInstances=__bind(this._updateInstances,this),this._domChanged=__bind(this._domChanged,this),this._initListeners=__bind(this._initListeners,this),this._registerUIs=__bind(this._registerUIs,this),this._instances=[],setTimeout(this._registerUIs,0)}return t.set({_dirty:function(t){this._updateInstances()}}),t.prototype._registerUIs=function(){return this._parseUIs(cms.ui,!0),this._initListeners()},t.prototype._parseUIs=function(t,e){var r,n,i;null==e&&(e=!1),i=[];for(n in t)r=t[n],i.push(r instanceof Function?e?void 0:this._instances.push(new r):this._parseUIs(r));return i},t.prototype._initListeners=function(){return MutationObserver?(this._mutationObserver=new MutationObserver(this._domChanged),this._mutationObserver.observe(document.body,{childList:!0,subtree:!0})):target.addEventListener("DOMSubtreeModified",this._domChanged),this._domChanged()},t.prototype._domChanged=function(){return this._dirty=!0},t.prototype._updateInstances=function(){var t,e;for(t=this._instances.length,e=[];t-->0;)e.push(this._instances[t].update());return e},new t,t}();var Notification;Notification=function(t){function e(){this._hideNotification=__bind(this._hideNotification,this),this._showNotification=__bind(this._showNotification,this),this.showNotification=__bind(this.showNotification,this),this.showNotifications=__bind(this.showNotifications,this),e.__super__.constructor.apply(this,arguments)}var r;return __extends(e,t),e.DEFAULT_TIMEOUT=8,e.prototype.destroy=function(){},e.prototype.showNotifications=function(t){var e,r,n,i,s;for(t=[].concat(t),e=t.length,s=[],n=0,i=t.length;i>n;n++)r=t[n],s.push(null!=r.delay?setTimeout(this.showNotification,1e3*r.delay,r):this.showNotification(r));return s},e.prototype.showNotification=function(t){var e;return e=document.querySelector("notification"),e||(e=document.body),e=e.getInstance()?e.getInstance():new BaseDOM({element:e}),t=new r(t),e.appendChildAt(t)},e.prototype._showNotification=function(t,e){return e=[].concat(e)},e.prototype._hideNotification=function(){},r=function(t){function r(t){this._closeClick=__bind(this._closeClick,this),this._hideNotification=__bind(this._hideNotification,this),r.__super__.constructor.call(this,{element:"div",className:"notification-item show-down"}),t.message&&(this.text=t.message),t.type&&this.addClass("p"+t.type),this.timeout=e.DEFAULT_TIMEOUT,t.timeout&&(this.timeout=Number(t.timeout)),this.timeout>0&&(this._closeTimeout=setTimeout(this._hideNotification,1e3*this.timeout)),this.closeBtn=new BaseDOM({element:"i",className:"closeBtn fa fa-close"}),this.closeBtn.element.on("click",this._closeClick),this.appendChild(this.closeBtn)}return __extends(r,t),r.prototype._hideNotification=function(){return this._hide()},r.prototype._hide=function(){return clearTimeout(this._closeTimeout),this.element.parentNode.removeChild(this.element),"function"==typeof this.destroy?this.destroy():void 0},r.prototype._closeClick=function(){return this._hide()},r}(BaseDOM),e}(EventDispatcher);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.ui.Loading=function(t){function e(){this._hideComplete=__bind(this._hideComplete,this),this._hideStart=__bind(this._hideStart,this),e.__super__.constructor.call(this,{element:"loading"}),this._progress=this._currentPosition=0,this._showPosition=0,this._element.removable=!1,this._background=new BaseDOM({element:"div",className:"background"}),this._progressBar=new BaseDOM({element:"div",className:"progress-bar"}),this.appendChild(this._background),this.appendChild(this._progressBar)}return __extends(e,t),e.get({progress:function(){return this._progress}}),e.set({progress:function(t){return 0>t?t=0:t>1&&(t=1),this._progress=t,KTween.remove(this,"_position"),KTween.tween(this,{_position:this._progress},"easeOutQuart",.3)}}),e.get({_position:function(){return this._currentPosition}}),e.set({_position:function(t){return 0>t?t=0:t>1&&(t=1),this._currentPosition=t,this._progressBar.css({width:100*t+"%"})}}),e.get({showPosition:function(){return this._showPosition}}),e.set({showPosition:function(t){var e;return 0>t?t=0:t>1&&(t=1),this._showPosition=t,e=2*t-1,0>e?e=0:e>1&&(e=1),this._background.css({opacity:e}),this._progressBar.css({height:4*t+"px"})}}),e.prototype.reset=function(){return KTween.remove(this),this.showPosition=0,this.progress=this._position=0},e.prototype.show=function(){return this.css({visibility:""}),this.reset(),this.removeClass("disabled"),KTween.tween(this,{showPosition:1},"easeOutQuart",.1)},e.prototype.hide=function(){return this.addClass("disabled"),this.progress=1,KTween.remove(this,"_position"),KTween.tween(this,{_position:this._progress,onComplete:this._hideStart},"easeOutQuart",.2)},e.prototype._hideStart=function(){return KTween.remove(this,"showPosition"),KTween.tween(this,{showPosition:0,onComplete:this._hideComplete},"easeOutQuart",.1)},e.prototype._hideComplete=function(){return this.css({visibility:"hidden"})},e}(BaseDOM);var Blocker;Blocker=function(t){function e(){this._transitionEnd=__bind(this._transitionEnd,this),e.__super__.constructor.call(this,{element:"div",className:"blocker"}),this.css({display:"none"}),this.element.on("transitionend",this._transitionEnd),this.element.on("moztransitionend",this._transitionEnd),this.element.on("otransitionend",this._transitionEnd),this.element.on("webkittransitionend",this._transitionEnd),this._showing=!1}return __extends(e,t),e.prototype.show=function(t){return null==t&&(t=!0),this._showing=!0,this.element.parentNode||document.body.appendChild(this.element),this.css({display:"block"}),this.addClass("show")},e.prototype.hide=function(){return this._showing=!1,this.removeClass("show")},e.prototype._transitionEnd=function(){return this._showing?void 0:this.css({display:"none"})},e}(BaseDOM);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};slikland.mara.Block=function(){function Block(t,e){if(this._renderLoadedBlock=__bind(this._renderLoadedBlock,this),this._replaceObject=__bind(this._replaceObject,this),this._maraId=this.constructor._MARA_ID++,this.constructor._registerBlock(this),this._file=e,this._type=null,this._instance=null,this._renderQueue=[],t=this.constructor._INSTRUCTION_RE.exec(t),"#"===t[1])throw new Error("Comment line");this._parseInstruction(t)}var k,v,_ref;Block._INSTRUCTION_RE=/^([\(\#\@\>\<])?([^\:]*?)?(?:(?::)(.*?)(?:\#{([^\#\{\}\'\"]*?)})?)?\s*$/m,Block.TYPES={1:"NORMAL",2:"CONDITIONAL",3:"REFERENCE",4:"INSTANCE",5:"FILE"},Block._blocks={},Block._MARA_ID=1,_ref=Block.TYPES;for(k in _ref)v=_ref[k],Block.TYPES[v]=Number(k);return Block._registerBlock=function(t){return this._blocks[t.maraId]=t},Block.findBlock=function(t){return t=Number(t),this._blocks[t]},Block.get({maraId:function(){return this._maraId}}),Block.get({file:function(){return this._file}}),Block.get({name:function(){return this._instance?this._instance:null}}),Block.get({children:function(){return this._children}}),Block.set({children:function(t){var e,r;if(!t||!Array.isArray(t))throw new Error("slikland.mara.Block children needs to be an Array");for(e=0,r=t.length;r>e;e++)if(v=t[e],!(v instanceof Block))throw new Error("slikland.mara.Block children needs to be an Array of slikland.mara.Block");return this._children=t}}),Block.get({type:function(){return this._type}}),Block.prototype.toValue=function(){var t;switch(t={},this._type){case 2:t.condition=this._condition;break;case 3:t.reference=this._reference;break;case 4:t.instance=this._instance;break;case 5:t.file=this._file,this._reference&&(t.reference=this._reference);break;default:t.tag=this._tag}return t.type=this.constructor.TYPES[this._type],t.data=this._data,t},Block.prototype._parseInstruction=function(t){var e,r,n,i,s,o,a;switch(s=t[2]||"",this._attributes=t[3]||"",this._data=t[4]||"",t[1]){case"(":o=this.constructor.TYPES.CONDITIONAL,s=s.replace(/\)\s*$/,""),this._condition=s;break;case">":o=this.constructor.TYPES.REFERENCE,this._reference=s;break;case"<":o=this.constructor.TYPES.INSTANCE,this._instance=s;break;case"@":o=this.constructor.TYPES.FILE,i=/(.*?)(?:(?:\>)(.*?))?$/.exec(s),this._file=i[1],(null!=(a=i[2])?a.length:void 0)>0&&(this._reference=i[2]);break;default:for(o=this.constructor.TYPES.NORMAL,n=/(#|.)([^\#\.]+)/g,r=null,e=[];i=n.exec(s);)switch(i[1]){case"#":r=i[2];break;case".":e.push(i[2])}r&&(this._id=r),e&&(this._classes=e),s=s.replace(/[#.].*?$/,""),this._tag=s}return this._type=o},Block.prototype._parseObjectString=function(object,data,test){var e,glob,replaceObject;null==data&&(data={}),null==test&&(test=!1),glob=slikland.Mara.globals,replaceObject=object.replace(/\#\{(\$|\@)([^\}\}\#]+)\}/g,"(glob['$1'].$2 || '')"),replaceObject=replaceObject.replace(/\#\{([^\}\}\#]+)\}/g,"(data['$1'] || '')").replace(/\#\{\}/g,"(data || '')");try{object=eval("(function(){return ("+replaceObject+");})();")}catch(_error){}if(test)return Boolean(object);"string"!=typeof object&&(object=JSON.stringify(object));try{object=this._replaceString(object,data),object=JSON.parse(object)}catch(_error){e=_error,object=object?{html:object}:{}}return"string"==typeof object&&(object={html:object}),object},Block.prototype._replaceString=function(t,e){return this._currentReplaceObjectData=e,t=t.replace(/\(glob\[\'(.*?)\'\]\.([^\s]+) \|\| \'\'\)/g,"#{$1$2}"),t=t.replace(/\(data\[\'(.*?)\'\]\ \|\| \'\'\)/g,"#{$1}"),t=t.replace(/\(data \|\| \'\'\)/g,"#{}"),t=t.replace(/\#\{(\$|\@)?([^\}\}\#]+)?\}/g,this._replaceObject)},Block.prototype._replaceObject=function(t,e,r){var n;return n=null,e&&e.length>0?r&&(n=ObjectUtils.find(slikland.Mara.globals[e],r)):n=r?ObjectUtils.find(this._currentReplaceObjectData,r):this._currentReplaceObjectData,null==n&&(n=""),n},Block.prototype.render=function(t,e,r){var n,i,s,o,a,l,h,u,c;if(null==e&&(e=null),null==r&&(r=!1),e||(e=document.createElement("div")),s=r?[t,e]:"function"==typeof this[u="_render_"+this.constructor.TYPES[this._type]]?this[u](t,e):void 0)for(s[1]&&s[1]instanceof Node&&(s=[s]),o=0,l=s.length;l>o;o++)if(i=s[o],t=i[0],e=i[1],this._children)for(c=this._children,a=0,h=c.length;h>a;a++)n=c[a],n.render(t,e);return s},Block.prototype._render_NORMAL=function(t,e){var r,n,i,s,o,a,l,h,u,c;if(!this._tag)return[t,e];if(a=t,this._data&&this._data.length>0&&(a=null!=a?a[this._data]:void 0),l=[],a)for(a=[].concat(a),h=0,u=a.length;u>h;h++){o=a[h],i=document.createElement(this._tag),n=this._parseObjectString(this._attributes,o),s=null,n.html?s=n.html:n.text?s=n.text:n.content&&(s=n.content,delete n.content),delete n.html,delete n.text,s&&(i.innerHTML=s);for(k in n)v=n[k],("string"==(c=typeof k)||"number"===c)&&v&&i.setAttribute(k,v);i.data=t,i.setAttribute("mara",this._maraId),this._id&&i.setAttribute("id",this._id),this._classes&&(r=i.className||"",r=r.split(" "),r=[].concat(r,this._classes),i.className=r.join(" ")),e.appendChild(i),l.push([o,i])}return l},Block.prototype._renderLoadedBlock=function(t){var e,r,n,i,s,o,a,l,h,u,c,d,_,p,f;for(f=this._renderQueue,c=0,_=f.length;_>c;c++){if(u=f[c],i=u.data,n=u.context,a=i,this._data&&this._data.length>0&&(a=null!=a?a[this._data]:void 0),a)for(a=[].concat(a),d=0,p=a.length;p>d;d++)o=a[d],t.render(o,n);for(l=n.parentNode,r=n.childNodes,h=n,s=r.length;s-->0;)e=r[s],l.insertBefore(e,h),h=e;l.removeChild(n)}return this._renderQueue.length=0},Block.prototype._render_FILE=function(t,e){var r,n;r=document.createElement("div"),r.style.display="none",e.appendChild(r),this._renderQueue.push({data:t,context:r}),n=this._file,this._reference&&(n+=">"+this._reference);try{n=this._replaceString(n,t),slikland.mara.Templates.getInstance().get(n,this._renderLoadedBlock)}catch(i){}return[[t,r]]},Block.prototype._render_INSTANCE=function(t,e){return[[t,e]]},Block.prototype._render_REFERENCE=function(t,e){var r;return r=document.createElement("div"),r.style.display="none",e.appendChild(r),this._renderQueue.push({data:t,context:r}),slikland.mara.Templates.getInstance().get(this._file+">"+this._reference,this._renderLoadedBlock),[[t,r]]},Block.prototype._render_CONDITIONAL=function(t,e){return this._parseObjectString(this._condition,t,!0)?[[t,e]]:!1},Block}();var __bind=function(t,e){return function(){return t.apply(e,arguments)}};slikland.mara.Templates=function(){function t(t){null==t&&(t=null),this._fileLoaded=__bind(this._fileLoaded,this),this._checkCallbacks=__bind(this._checkCallbacks,this),this._callCallback=__bind(this._callCallback,this),this._templates=[],this._rootPath="",this._callbacks=[],t&&(this.rootPath=t)}return t.getInstance=function(){return null!=t._instance?t._instance:t._instance=function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(t,arguments,function(){})},t.get({rootPath:function(){return this._rootPath}}),t.set({rootPath:function(t){return"string"==typeof t?(t=t.trim().rtrim("/"),t.length>0&&(t+="/"),this._rootPath=t):void 0}}),t.prototype._addInstance=function(t){return this._templates.push(t)},t.prototype._findInstance=function(t,e){var r,n,i;for(null==e&&(e=null),i=/(.*?)(?:(?:\>)(.*?))?$/.exec(t),t=i[1],!e&&i[2]&&(e=i[2]),n=this._templates.length;n-->0;)if(r=this._templates[n],r.file===t&&r.name===e)return r;return null},t.prototype.get=function(t,e){var r;return r=this._findInstance(t),r?setTimeout(this._callCallback,0,e,r):(this._callbacks.push({file:t,callback:e}),this.load(t))
},t.prototype._callCallback=function(t,e){return"function"==typeof t?t(e):void 0},t.prototype.load=function(t){var e,r;return e=/(.*?)(?:(?:\>)(.*?))?$/.exec(t),t=e[1],t=t.trim(),t.length<2?void 0:(/\.mara$/i.test(t)||(t+=".mara"),r="/"===t.charAt(0)?t:this._rootPath+t,API.call(r,{file:t},this._fileLoaded))},t.prototype._checkCallbacks=function(){var t,e,r,n,i,s;for(n=this._callbacks.length,s=[];n-->0;)i=this._callbacks[n],r=i.file,e=i.callback,t=this._findInstance(r),t?("function"==typeof e&&e(t),s.push(this._callbacks.splice(n,1))):s.push(void 0);return s},t.prototype._fileLoaded=function(t,e){return this._parse(e,t.currentTarget.data.file),this._checkCallbacks()},t.prototype._parse=function(t,e){var r,n;if(null==e&&(e=""),e=e.replace(/\.mara$/,""),n=this._parseBlocks(t+"\n",e),n.length>1)r=new slikland.mara.Block("",e),r.children=n;else{if(1!==n.length)return;r=n[0]}return this._addInstance(r)},t.prototype._removeIndent=function(t){var e,r,n,i,s;for(n=Number.MAX_VALUE,r=null,i=/^(\s*)[^\s].*?$/gm;s=i.exec(t);)e=s[1],e.length<n&&(n=e.length,r=e);return r&&(t=t.replace(new RegExp("^"+r,"gm"),"")),t},t.prototype._parseBlocks=function(t,e){var r,n,i,s,o,a,l;for(null==e&&(e=""),t=this._removeIndent(t.replace(/^\s*\n/gm,"")),n=/(\s*)([^\s].*?\n)((?:^\1[ |\t]+[^\n]*?(?:\n|$))*)/gm,i=[];l=n.exec(t);){try{r=new slikland.mara.Block(l[2],e)}catch(h){a=h;continue}r.type===slikland.mara.Block.TYPES.INSTANCE?this._addInstance(r):i.push(r),o=l[3],o.length>0&&(s=this._parseBlocks(o,e),r.children=s)}return i},t}();var __bind=function(t,e){return function(){return t.apply(e,arguments)}};slikland.Mara=function(t){function e(t){null==t&&(t=null),this._removeChildren=__bind(this._removeChildren,this),this._showContext=__bind(this._showContext,this),this._holdContextToRender=__bind(this._holdContextToRender,this),this._templateLoaded=__bind(this._templateLoaded,this),this._templates=slikland.mara.Templates.getInstance(t)}var r,n,i;return __extends(e,t),e.RENDERED="mara_rendered",e._rootPath="",e.globals={},e.setGlobalObject=function(t,e){return this.globals[t]=e},e.getGlobal=function(t){return this.globals[t]},e.setRootPath=function(t){return this._rootPath=t},r=[],i=null,n=null,e.get({name:function(){return i}}),e.get({id:function(){return n}}),e.get({children:function(){return[].concat(r)}}),e.prototype.isCurrent=function(t){var e,r,n;return e=(null!=(r=this._renderData)?r.file:void 0)||(null!=(n=this._block)?n.file:void 0)||"",t===e},e.prototype.render=function(t,e,r,n){return null==e&&(e={}),null==r&&(r=null),null==n&&(n=null),(null!=r?r.element:void 0)&&(r=r.element),this._renderData={file:t,data:e,context:r,callback:n},r&&r.setAttribute("loading","true"),this._templates.get(t,this._templateLoaded)},e.prototype.reset=function(){return this._renderData=null},e.prototype._templateLoaded=function(t){var e,r;if(this._renderData)return this._renderData.context&&(this._renderData.context.removeAttribute("loading"),this._resetContext(this._renderData.context),this._holdContextToRender(this._renderData.context)),e=t.render(this._renderData.data,this._renderData.context),this._block=t,"function"==typeof(r=this._renderData).callback?r.callback(e,this._block):void 0},e.prototype._holdContextToRender=function(t){return t.style.visibility="hidden",setTimeout(this._showContext,1,t)},e.prototype._showContext=function(t){return t.style.visibility=""},e.prototype._resetContext=function(t){var e,r,n;for(e=t.childNodes,r=e.length,n=[];r-->0;)n[r]=e[r];return setTimeout(this._removeChildren,0,t,n)},e.prototype._removeChildren=function(t,e){var r,n;for(r=e.length,n=[];r-->0;)e[r].removable!==!1&&n.push(t.removeChild(e[r]));return n},e.prototype.renderBlock=function(t,e){var r;if(t instanceof HTMLElement&&t.getAttribute("mara"))return this._resetContext(t),r=slikland.mara.Block.findBlock(t.getAttribute("mara")),r.render(e,t,!0)},e.prototype.find=function(){},e.prototype.findAll=function(){},e.prototype.vilha=e.prototype.render,e}(EventDispatcher);var Main;Main=function(){function t(){this._renderTemplate=__bind(this._renderTemplate,this),this._loadComplete=__bind(this._loadComplete,this),this._error=__bind(this._error,this),this._indexComplete=__bind(this._indexComplete,this),this._routeChange=__bind(this._routeChange,this),this._init=__bind(this._init,this),app.body=new BaseDOM({element:document.body}),app.template=new slikland.Mara("templates/"),slikland.Mara.setGlobalObject("@",app),app.templateContext=document.body,app.user=new User,app["interface"]=new cms.core.InterfaceController,setTimeout(this._init,0),app.on(t.RENDER_TEMPLATE,this._renderTemplate),app.router=new NavigationRouter(app.basePath),app.router.on(NavigationRouter.CHANGE,this._routeChange),app.router.setup(app.basePath)}return t.RENDER_TEMPLATE="app_renderTemplate",t.prototype._init=function(){return app.body.css("visibility","")},t.prototype._routeChange=function(){return app["interface"].show()},t.prototype._indexComplete=function(){},t.prototype._error=function(){},t.prototype._loadComplete=function(){},t.prototype._renderTemplate=function(t,e){var r;return e.target&&e.currentTarget&&(r=e.currentTarget.findParents(e.target),r||(r=document.body.querySelector(e.target))),app.template.render(e.template,e.data||{},r||app.templateContext)},t}(),app.on("windowLoad",function(){return new Main})}).call(this);