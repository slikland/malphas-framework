(function(){function __addNamespace(t,e){for(k in e)t[k]||(t[k]={}),__addNamespace(t[k],e[k])}var __bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},__extends=function(t,e){function i(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r));return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};__addNamespace(this,{cms:{ui:{tag:{attributes:{}},attributes:{},tags:{form:{},"interface":{},visualizer:{}}},core:{}},slikland:{mara:{}}});var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.ui.Base=function(){function t(){this._updateItems=__bind(this._updateItems,this),this._instances=[],this._plugins={}}return t.prototype.update=function(){return this.constructor.SELECTOR?setTimeout(this._updateItems,0):void 0},t.prototype._updateItems=function(){var t,e,i,r,n,s,o,a,h,l,u,c,d;for(n=document.body.querySelectorAll(this.constructor.SELECTOR),r=[],c=0,d=n.length;d>c;c++)i=n[c],i.matches("[cloned]")||r.push(i);for(s=r.length,e=[],h=[],u=[],t=0,a=0,l=0;s-->0;)i=r[s],(o=this._instances.indexOf(i))>=0?(u[l++]=this._instances[o],this._instances.splice(o,1)):e[t++]=i;return h=[].concat(this._instances),this._instances=[].concat(e,u),this._update({add:e,remove:h,unchanged:u,current:r})},t.prototype._update=function(){throw new Error("Please override this method.")},t}();var Debug,__slice=[].slice;Debug=function(){function Debug(){}return Debug.debug=!1,Debug.light=4764196,Debug.dark=2884445,Debug.init=function(){var err,re,_ref;Debug._console=window.console;try{Debug._log=Function.prototype.bind.call(null!=(_ref=Debug._console)?_ref.log:void 0,Debug._console)}catch(_error){err=_error}return null==window.Debug&&(window.Debug=Debug),Debug.check()||eval("window[Math.random()]()"),re=new RegExp(/debug=(1|true)/i),Debug.debug=re.test(window.location.search),re=new RegExp(/debug=(0|false)/i),Debug.debug||re.test(window.location.search)||(re=new RegExp(/([\.|\/]local\.|localhost|127\.0\.0\.1|192\.\d+\.\d+\.\d+|dev\.slikland\.)/i),Debug.debug=re.test(window.location.href)),Debug.debug&&window.console?void 0:window.console={assert:function(){},clear:function(){},count:function(){},debug:function(){},dir:function(){},dirxml:function(){},error:function(){},exception:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){},info:function(){},log:function(){},profile:function(){},profileEnd:function(){},table:function(){},time:function(){},timeEnd:function(){},timeStamp:function(){},trace:function(){},warn:function(){}}},Debug.check=function(t){var e,i,r,n;for(null==t&&(t=null),r="",e="",i=this.light;i>0;)e=String.fromCharCode(255&i)+e,i>>=8;for(r+=btoa(e),e="",i=this.dark;i>0;)e=String.fromCharCode(255&i)+e,i>>=8;return r+=btoa(e),n=r.toLowerCase(),t?n===t.toLowerCase():"s"===n.charAt(0)&&"l"===n.charAt(1)},Debug.log=function(){if(null!=Debug._log)return"function"==typeof Debug._log?Debug._log.apply(Debug,arguments):void 0;try{return console.log.apply(console,arguments)}catch(t){}},Debug.logTime=function(){var t,e,i,r,n,s;for(t=1<=arguments.length?__slice.call(arguments,0):[],n=(new Date).getTime(),this.itm||(this.itm=this.ctm=n),i=n-this.ctm,s=i.toString();s.length<6;)s=" "+s;for(e=s+"|",s=(this.ctm-this.itm).toString();s.length<6;)s=" "+s;return e+=s,e=["%c"+e+":"],r="font-weight: bold;",i>100?r+="color: red;":i>50&&(r+="color: orange;"),e.push(r),Debug.log.apply(this,[].concat(e,t)),this.ctm=n},Debug}(),window.atob||(window.atob=function(t){var e,i,r,n,s,o,a,h,l,u,c;for(h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=t.length,l=0,c="";u>l;)n=t.charAt(l),s=t.charAt(l+1),o=t.charAt(l+2),a=t.charAt(l+3),n=h.indexOf(n),s=h.indexOf(s),o=h.indexOf(o),a=h.indexOf(a),0>o&&(o=0),0>a&&(a=0),e=n<<2&255|s>>4,i=s<<4&255|o>>2,r=o<<6&255|63&a,c+=String.fromCharCode(e),c+=String.fromCharCode(i),c+=String.fromCharCode(r),l+=4;return c},window.btoa=function(t){var e,i,r,n,s,o,a,h,l,u,c;for(h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=t.length,l=0,c="";u>l;)e=255&t.charCodeAt(l+0),i=255&t.charCodeAt(l+1),r=255&t.charCodeAt(l+2),n=e>>2&63,s=63&(e<<4|i>>4),o=63&(i<<2|r>>6),a=63&r,c+=h.charAt(n)+h.charAt(s)+h.charAt(o)+h.charAt(a),l+=3;return l=u%3,u=c.length,1===l?c=c.substr(0,u-2)+"==":2===l&&(c=c.substr(0,u-1)+"="),c}),window.Debug=Debug,Debug.init();var isIE,__scopeIE8;isIE=function(){var t;return t=navigator.userAgent.toLowerCase(),-1!==t.indexOf("msie")?parseInt(t.split("msie")[1]):!1},8===isIE()&&(__scopeIE8=document.createElement("IE8_"+Math.random())),Function.prototype["const"]=function(t){var e,i,r,n;n=__scopeIE8?__scopeIE8:this;for(e in t)r=t[e],i={},i.get=function(){return r},i.set=function(){throw new Error("Can't set const "+e)},i.configurable=!0,i.enumerable=!0,Object.defineProperty(n,e,i);return null},Function.prototype.get=function(t,e){var i,r,n,s;i=!1,e?(i=!0,s=t):(e=t,s=__scopeIE8?__scopeIE8:this.prototype);for(n in e)r=e[n],Object.defineProperty(s,n,{get:r,configurable:!0,enumerable:i});return null},Function.prototype.set=function(t,e){var i,r,n,s;i=!1,e?(i=!0,s=t):(e=t,s=__scopeIE8?__scopeIE8:this.prototype);for(r in e)n=e[r],Object.defineProperty(s,r,{set:n,configurable:!0,enumerable:i});return null},"bind"in Function.prototype||(Function.prototype.bind=function(t){var e,i;return i=this,arguments_.length<=1?function(){return i.apply(t,arguments_)}:(e=Array.prototype.slice.call(arguments_,1),function(){return i.apply(t,0===arguments_.length?e:e.concat(Array.prototype.slice.call(arguments_)))})}),String.prototype.trim=function(t){return null==t&&(t=null),this.ltrim(t).rtrim(t)},String.prototype.ltrim=function(t){var e;return null==t&&(t=null),t||(t="\\s"),e=new RegExp("^"+t+"*"),e.global=!0,e.multiline=!0,this.replace(e,"")},String.prototype.rtrim=function(t){var e;return null==t&&(t=null),t||(t="\\s"),e=new RegExp(t+"*$"),e.global=!0,e.multiline=!0,this.replace(e,"")},String.prototype.padLeft=function(t,e){var i;for(null==e&&(e=" "),0===e.length&&(e=" "),i=this;i.length<t;)i=e+i;return i},String.prototype.padRight=function(t,e){var i;for(null==e&&(e=" "),0===e.length&&(e=" "),i=this;i.length<t;)i+=e;return i},"isArray"in Array.prototype||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(t,e){var i;for(void 0===e&&(e=0),0>e&&(e+=this.length),0>e&&(e=0),i=this.length;i>e;){if(e in this&&this[e]===t)return e;e++}return-1}),"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(t,e){for(void 0===e&&(e=this.length-1),0>e&&(e+=this.length),e>this.length-1&&(e=this.length-1),e++;e-->0;)if(e in this&&this[e]===t)return e;return-1}),"forEach"in Array.prototype||(Array.prototype.forEach=function(t,e){var i,r,n;for(i=0,r=this.length,n=[];r>i;)i in this&&t.call(e,this[i],i,this),n.push(i++);return n}),"map"in Array.prototype||(Array.prototype.map=function(t,e){var i,r,n;for(n=new Array(this.length),i=0,r=this.length;r>i;)i in this&&(n[i]=t.call(e,this[i],i,this)),i++;return n}),"filter"in Array.prototype||(Array.prototype.filter=function(t,e){var i,r,n,s;for(n=[],s=void 0,i=0,r=this.length;r>i;)i in this&&t.call(e,s=this[i],i,this)&&n.push(s),i++;return n}),"every"in Array.prototype||(Array.prototype.every=function(t,e){var i,r;for(i=0,r=this.length;r>i;){if(i in this&&!t.call(e,this[i],i,this))return!1;i++}return!0}),"some"in Array.prototype||(Array.prototype.some=function(t,e){var i,r;for(i=0,r=this.length;r>i;){if(i in this&&t.call(e,this[i],i,this))return!0;i++}return!1}),Node.prototype.on=Node.prototype.addEventListener,Node.prototype.off=Node.prototype.removeEventListener,Node.prototype.trigger=function(t,e){var i;return i=new Event(t),i.data=e,this.dispatchEvent(i)},null==navigator.mediaDevices&&(navigator.mediaDevices={}),navigator.getUserMedia=navigator.mediaDevices.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var EventDispatcher;EventDispatcher||(EventDispatcher=function(){function t(){this._triggerStacked=__bind(this._triggerStacked,this),this.trigger=__bind(this.trigger,this)}return t.prototype._events=null,t.prototype.on=function(t,e){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),__indexOf.call(this._events[t],e)>=0?void 0:this._events[t].unshift(e)},t.prototype.off=function(t,e){var i,r;if(null==t&&(t=null),null==e&&(e=null),!this._events)return void(this._events={});if(null!=t&&Boolean(this._events[t])){if(i=this._events[t],e){for(;(r=i.indexOf(e))>=0;)i.splice(r,1);return this._events[t]=i}return this._events[t].length=0}return this._events={}},t.prototype.trigger=function(t,e,i,r){var n,s,o,a,h,l,u,c;if(null==e&&(e=null),null==i&&(i=null),null==r&&(r=null),Array.isArray(t))for(l=0,u=t.length;u>l;l++)n=t[l],this.trigger(t,e);else if(this._events||(this._events={}),s=this._events[t],s&&0!==s.length){if(i||(i=this),n={type:t,target:i,currentTarget:this,originalEvent:r},null!=r&&(n.preventDefault=function(){return"function"==typeof r.preventDefault?r.preventDefault():void 0},n.stopPropagation=function(){return"function"==typeof r.stopPropagation?r.stopPropagation():void 0}),"object"==typeof e)for(a in e)h=e[a],n[a]||(n[a]=h);for(o=s.length,c=[];o-->0;)c.push("function"==typeof s[o]?s[o](n,e):void 0);return c}},t.prototype.hasEvent=function(t,e){var i;if(!this._events)return void(this._events={});for(i in this._events)if(i===t&&this._events[i].indexOf(e)>-1)return!0;return!1},t.prototype.stackTrigger=function(t,e,i){return null==e&&(e=null),null==i&&(i=null),this._stackTriggerer||(this._stackTriggerer=[]),this._stackTriggerer.push([t,e,i]),clearTimeout(this._stackTriggerTimeout),this._stackTriggerTimeout=setTimeout(this._triggerStacked,0)},t.prototype._triggerStacked=function(){var t,e;for(e=this._stackTriggerer.length,t=-1;++t<e;)this.trigger.apply(this,this._stackTriggerer[t]);return this._stackTriggerer.length=0},t}());var App,app,windowLoaded;App=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.project_version_raw="SL_PROJECT_VERSION:1.4.0",e.project_date_raw="SL_PROJECT_DATE:1504711915349",e.FRAMEWORK_VERSION="2.2.15",e.prototype.getInfo=function(){var t;return t={},t.versionRaw=void 0===e.project_version_raw||"undefined"===e.project_version_raw?"SL_PROJECT_VERSION:Not versioned":e.project_version_raw,t.version=t.versionRaw.replace("SL_PROJECT_VERSION:",""),t.lastUpdateRaw=void 0===e.project_date_raw||"undefined"===e.project_date_raw?"SL_PROJECT_DATE:Not versioned":e.project_date_raw,t.lastUpdate=new Date(parseFloat(t.lastUpdateRaw.replace("SL_PROJECT_DATE:",""))),t},e.prototype._checkWindowActivity=function(){var t,e,i,r;return this._hidden="hidden",t=this._hidden,__indexOf.call(document,t)>=0?document.addEventListener("visibilitychange",this._windowVisibilityChange):(e=this._hidden="mozHidden",__indexOf.call(document,e)>=0?document.addEventListener("mozvisibilitychange",this._windowVisibilityChange):(i=this._hidden="webkitHidden",__indexOf.call(document,i)>=0?document.addEventListener("webkitvisibilitychange",this._windowVisibilityChange):(r=this._hidden="msHidden",__indexOf.call(document,r)>=0?document.addEventListener("msvisibilitychange",this._windowVisibilityChange):__indexOf.call(document,"onfocusin")>=0?document.onfocusin=document.onfocusout=this._windowVisibilityChange:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=this._windowVisibilityChange))),void 0!==document[this._hidden]?this._windowVisibilityChange.call(window,{type:document[this._hidden]?"blur":"focus"}):void 0},e.prototype._windowVisibilityChange=function(t){var e,i,r,n,s,o,a,h;a="visible",n="hidden",r={focus:!1,focusin:!1,pageshow:!1,blur:!0,focusout:!0,pagehide:!0},t=t||window.event,h=t.type,s=__indexOf.call(r,h)>=0?r[t.type]:document[this._hidden],i=s?"windowInactive":"windowActive";try{return this.dispatchEvent(new Event(i))}catch(l){return e=l,o=document.createEvent("Event"),o.initEvent(i,!0,!0),this.dispatchEvent(o)}},e}(EventDispatcher),app||(app=new App),windowLoaded=function(){return function(){return window.remove?window.remove("load",windowLoaded):window.detachEvent?window.detachEvent("onload",windowLoaded):window.onload=null,app.trigger("windowLoad")}}(this),window.addEventListener?window.addEventListener("load",windowLoaded):window.attachEvent?window.attachEvent("onload",windowLoaded):window.onload=windowLoaded;var NavigationRouter;NavigationRouter=function(t){function e(){this._onPathChange=__bind(this._onPathChange,this),this._routes=[],this._numRoutes=0,this._trigger=!0,e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.CHANGE="route_path_change",e.CHANGE_ROUTE="route_match",e.prototype.setup=function(t,e){var i,r,n,s;if(null==t&&(t=null),null==e&&(e=!1),!t){t=window.location.href;try{i=document.getElementsByTagName("base"),i.length>0&&(i=i[0],t=i.getAttribute("href"))}catch(o){r=o,console.log(r.stack)}}return this._rootPath=t.replace(/^(.*?)\/*$/,"$1/"),this._rawPath="",this._usePushState=e?!1:null!=("undefined"!=typeof window&&null!==window&&null!=(s=window.history)?s.pushState:void 0),this._usePushState?(this._rootPath!==window.location.href&&(n=this._getPath(),this.goto(n,!1)),window.addEventListener?window.addEventListener("popstate",this._onPathChange):window.attachEvent("onpopstate",this._onPathChange)):(this._rootPath!==window.location.href&&(n=this._getPath(),window.location=this._rootPath+"#!/"+n),window.addEventListener?window.addEventListener("hashchange",this._onPathChange):window.attachEvent("onhashchange",this._onPathChange)),this._onPathChange(),this},e.prototype._getPath=function(){var t;return t=window.location.href.replace(/\/*$/g,""),0===t.indexOf(this._rootPath.replace(/\/*$/g,""))&&(t=t.substr(this._rootPath.length)),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1")},e.prototype._parsePath=function(t){var e,i,r,n,s,o;return n=/^(?:#?!?\/*)([^?]*)\??(.*?)$/.exec(t),r=n[1],i=null!=(s=window.location.search)?s.replace(/^\?/,""):void 0,e=null!=(o=window.location.hash)?o.replace(/^\#/,""):void 0,i=this._parseParams(i),e=this._parseParams(e),{rawPath:t,path:r,params:i,hashes:e}},e.prototype._parseParams=function(t){var e,i,r,n;if(n={},t)for(r=/&?([^=&]+)=?([^=&]*)/g,e=0;i=r.exec(t);)n[i[1]]=i[2];return n},e.prototype._onPathChange=function(t){return null==t&&(t=null),this._currentPath=this._getPath(),this._trigger&&this._triggerPath(this._currentPath),this._trigger=!0,this._replaceData?(this.goto(this._replaceData[0],!1),this._replaceData=null):this.trigger(e.CHANGE,this._parsePath(this._currentPath)),!1},e.prototype._triggerPath=function(t){var i,r,n,s,o,a;if(r=this._parsePath(t),a=this._checkRoutes(r.path),o=a[0],s=a[1],o)for(i=o.length;i-->0;)n=o[i],this.trigger(e.CHANGE_ROUTE,{route:n.route,routeData:s,path:t,pathData:r,data:n.data});return!1},e.prototype.getCurrentPath=function(){return this._currentPath},e.prototype.getParsedPath=function(){return this._parsePath(this._currentPath)},e.prototype.goto=function(t,e){return null==e&&(e=!0),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1"),t!==this._currentPath?(this._currentPath=t,this._trigger=e,this._usePushState?(history.pushState({},t,this._rootPath+t),this._trigger&&this._onPathChange(),this._trigger=!0):window.location.hash="!/"+t,!1):void 0},e.prototype.replace=function(t,e){return null==e&&(e=!1),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1"),t!==this._currentPath&&(this._currentPath=t,this._usePushState?history.replaceState({},t,this._rootPath+t):(this._trigger=!1,history.back(),this._replaceData=[t])),e&&this.triggerPath(t),!1},e.prototype.triggerPath=function(t){return this._triggerPath(t),!1},e.prototype.triggerCurrentPath=function(){return this._triggerPath(this._getPath()),!1},e.prototype.addRoute=function(t,e){var i,r,n,s,o,a,h;if(null==e&&(e=null),"string"!=typeof t)for(r=t.length;r-->0;)this.addRoute(t[r],e);for(a=/\{(.*?)\}/g,n=[],o=0;s=a.exec(t);)n[o++]=s[1];a=t,"*"===a&&(a=".*");try{a=a.replace(/(.*?)\/*$/,"$1"),h=new RegExp("(?:"+a.replace(/\{.*?\}/g,"(.+?)")+"$)","g")}catch(l){return i=l,void console.log(i.stack)}return this._routes[this._numRoutes++]={data:e,route:t,routeRE:h,labels:n,numLabels:n.length,numSlashes:t.split("/").length},this._routes.sort(this._sortRoutes),!1},e.prototype.removeRoute=function(t){var e,i;for(e=this._numRoutes;e-->0;)i=this._routes[e],i.route===t&&this._routes.splice(e,1);return this._numRoutes=this._routes.length,!1},e.prototype.removeAllRoutes=function(){return this._routes.length=0,this._numRoutes=this._routes.length},e.prototype._checkRoutes=function(t){var e,i,r,n,s,o,a,h,l,u,c,d,_,p;for(r=this._numRoutes,i=null,e=null,l=[],u=0,t="/"+t;r-->0;){if(h=this._routes[r],i){if(h.route!==i)break;l[u++]=h}if(a=h.routeRE,a.lastIndex=0,o=a.exec(t))for(e={},l[u++]=h,i=h.route,p=h.labels,n=d=0,_=p.length;_>d;n=++d)s=p[n],c=o[n+1],e[s]=c}return[l,e]},e.prototype._sortRoutes=function(t,e){return t.numLabels<e.numLabels?-1:t.numLabels>e.numLabels?1:t.numSlashes<e.numSlashes?-1:t.numSlashes>e.numSlashes?1:t.route===e.route?0:t.route<e.route?-1:t.route>e.route?1:0},e.prototype._getParams=function(){var t,e,i,r,n;r=this._parsePath(this._currentPath),i=r.params;for(e in i){n=i[e],n=decodeURIComponent(n);try{t=JSON.parse(n),"string"!=typeof t&&(n=t)}catch(s){}i[e]=n}return i},e.prototype._setParams=function(t){var e,i,r,n,s;n=this._parsePath(this._currentPath),i=[];for(e in t){s=t[e];try{"string"!=typeof s&&(s=JSON.stringify(s))}catch(o){}i.push(e+"="+encodeURIComponent(s)),t[e]=s}return r=n.path,i.length>0&&(r=r+"?"+i.join("&")),this.replace(r)},e.prototype.getParam=function(t){var e;return e=this._getParams(),e[t]},e.prototype.setParam=function(t,e){var i;return i=this._getParams(),i[t]=e,this._setParams(i)},e.prototype.getHash=function(t){var e,i;return e=null!=(i=window.location.hash)?i.replace(/^\#/,""):void 0,e=this._parseParams(e),e[t]},e.prototype.setHash=function(t,e){var i,r;return i=null!=(r=window.location.hash)?r.replace(/^\#/,""):void 0,i=this._parseParams(i),i[t]=e,this._setHashes(i)},e.prototype._setHashes=function(t){var e,i,r,n;i=[];for(e in t){n=t[e];try{"string"!=typeof n&&(n=JSON.stringify(n))}catch(s){}i.push(e+"="+encodeURIComponent(n))}return r=this._getPath(),r=r.replace(/\#.*?$/,""),this.replace(r+"#"+i.join("&"),!1)},e.prototype.removeParam=function(t){var e;return e=this._getParams(),e[t]=null,delete e[t],this._setParams(e)},e}(EventDispatcher);var KTObject,KTween;KTween=function(){function t(){}return t.tweenTypes={},t.numValues=100,t.inited=!1,t.items=[],t.queued=[],t.numQueued=0,t.numItems=0,t.index=0,t.div=1/16777215,t.init=function(t){return this.timeout=null!=t?t:1e3/60,this.inited?void 0:(this.initTime=(new Date).getTime(),setInterval(this.update,this.timeout),this.inited=!0)},t.update=function(){var e,i,r,n,s,o,a,h,l,u,c,d,_,p,f;for(c=(new Date).getTime()-t.initTime,a=t.numQueued;a-->0;)t.queued[a].initTime<=c&&(t.numQueued--,t.numItems++,t.queued[a].init(),t.items.push(t.queued.splice(a,1)[0]));for(a=t.numItems,f=[];a-->0;)if(i=!1,o=t.items[a]){for(d=o.target,_=(c-o.initTime)*o.iDuration,0>_&&(_=0),_>1&&(_=1),p=t.tweenTypes[o.transition][0],r=t.tweenTypes[o.transition][1],l=_*t.numValues,e=l>>0,l=(p[e]+r[e]*(l-e))*t.div,h=o.numParams,u=o.params,n=o.distances,s=o.initValues;h-->0;)d[u[h]]=n[h]*l+s[h];o.onUpdate&&(u=o.onUpdateParams,o.onUpdate.apply(o.target,u)),1===_?(t.numItems--,t.items.splice(a,1),o.onComplete&&void 0!==o.onComplete?(u=o.onCompleteParams,u||(u=[]),f.push(o.onComplete.apply(o.target,u))):f.push(void 0)):f.push(void 0)}return f},t.tween=function(t,e,i,r,n){var s,o;return null==i&&(i="linear"),null==r&&(r=0),null==n&&(n=0),this.inited||this.init(),this.tweenTypes[i]||this.populateEasing(i),o=(new Date).getTime()-this.initTime+1e3*n>>0,s=new KTObject(this.index++,t,o,1e3*r>>0,e,i),0===n?(s.init(),this.numItems++,this.items.push(s)):(this.numQueued++,this.queued.push(s))},t.populateEasing=function(e){var i,r,n,s,o,a,h,l;if(r=t[e]){for(h=[],i=[],s=this.numValues,n=l=0;s>=0?s>l:l>s;n=s>=0?++l:--l)a=h[n]=r(n,0,16777215,s)+.5>>0,n>0&&(i[n-1]=a-o),o=a;return h[s]=16777215,h[s+1]=0,i[s-1]=16777215-o,i[s]=0,this.tweenTypes[e]=[h,i]}},t.tweenSequence=function(t,e,i,r){var n,s,o,a;return null==r&&(r=null),t&&i?0===i.length?void(e&&e.apply(t,r)):(s=i.shift(),a="linear",s.transition&&(a=s.transition),o=0,s.time&&(o=s.time),n=0,s.delay&&(n=s.delay),this.tween(t,s,a,o,n,tweenSequence,[t,e,i,r])):void 0},t.remove=function(t,e){var i,r,n;for(null==e&&(e=null),i=this.numQueued;i-->0;)r=this.queued[i],r.target===t&&r.remove(e)&&(this.numQueued--,this.queued.splice(i,1));for(i=this.numItems,n=[];i-->0;)r=this.items[i],r.target===t&&r.remove(e)?(this.numItems--,n.push(this.items.splice(i,1))):n.push(void 0);return n},t.getByTime=function(t,e,i){var r,n,s,o,a;return a=this.tweenTypes[t],n=e/i*this.numValues,r=n>>0,s=a[r],o=a[r+1],(o-s)*(n-r)+s},t.getByPosition=function(t,e){var i,r,n;return this.inited||this.init(),this.tweenTypes[t]||this.populateEasing(t),n=this.tweenTypes[t][0],r=this.tweenTypes[t][1],e*=this.numValues,i=e>>0,(n[i]+r[i]*(e-i))*this.div},t.linear=function(t,e,i,r,n){return null==n&&(n=null),i*t/r+e},t.easeInQuad=function(t,e,i,r,n){return null==n&&(n=null),i*(t/=r)*t+e},t.easeOutQuad=function(t,e,i,r,n){return null==n&&(n=null),-i*(t/=r)*(t-2)+e},t.easeInOutQuad=function(t,e,i,r,n){return null==n&&(n=null),(t/=r/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},t.easeOutInQuad=function(t,e,i,r,n){return null==n&&(n=null),r/2>t?this.easeOutQuad(2*t,e,i/2,r,n):this.easeInQuad(2*t-r,e+i/2,i/2,r,n)},t.easeInCubic=function(t,e,i,r,n){return null==n&&(n=null),i*(t/=r)*t*t+e},t.easeOutCubic=function(t,e,i,r,n){return null==n&&(n=null),i*((t=t/r-1)*t*t+1)+e},t.easeInOutCubic=function(t,e,i,r,n){return null==n&&(n=null),(t/=r/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},t.easeOutInCubic=function(t,e,i,r,n){return null==n&&(n=null),r/2>t?this.easeOutCubic(2*t,e,i/2,r,n):this.easeInCubic(2*t-r,e+i/2,i/2,r,n)},t.easeInQuart=function(t,e,i,r,n){return null==n&&(n=null),i*(t/=r)*t*t*t+e},t.easeOutQuart=function(t,e,i,r,n){return null==n&&(n=null),-i*((t=t/r-1)*t*t*t-1)+e},t.easeInOutQuart=function(t,e,i,r,n){return null==n&&(n=null),(t/=r/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},t.easeOutInQuart=function(t,e,i,r,n){return null==n&&(n=null),r/2>t?this.easeOutQuart(2*t,e,i/2,r,n):this.easeInQuart(2*t-r,e+i/2,i/2,r,n)},t.easeInQuint=function(t,e,i,r,n){return null==n&&(n=null),i*(t/=r)*t*t*t*t+e},t.easeOutQuint=function(t,e,i,r,n){return null==n&&(n=null),i*((t=t/r-1)*t*t*t*t+1)+e},t.easeInOutQuint=function(t,e,i,r,n){return null==n&&(n=null),(t/=r/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},t.easeOutInQuint=function(t,e,i,r,n){return null==n&&(n=null),r/2>t?this.easeOutQuint(2*t,e,i/2,r,n):this.easeInQuint(2*t-r,e+i/2,i/2,r,n)},t.easeInSine=function(t,e,i,r,n){return null==n&&(n=null),-i*Math.cos(t/r*(Math.PI/2))+i+e},t.easeOutSine=function(t,e,i,r,n){return null==n&&(n=null),i*Math.sin(t/r*(Math.PI/2))+e},t.easeInOutSine=function(t,e,i,r,n){return null==n&&(n=null),-i/2*(Math.cos(Math.PI*t/r)-1)+e},t.easeOutInSine=function(t,e,i,r,n){return null==n&&(n=null),r/2>t?this.easeOutSine(2*t,e,i/2,r,n):this.easeInSine(2*t-r,e+i/2,i/2,r,n)},t.easeInExpo=function(t,e,i,r,n){return null==n&&(n=null),0===t?e:i*Math.pow(2,10*(t/r-1))+e-.001*i},t.easeOutExpo=function(t,e,i,r,n){return null==n&&(n=null),t===r?e+i:1.001*i*(-Math.pow(2,-10*t/r)+1)+e},t.easeInOutExpo=function(t,e,i,r,n){return null==n&&(n=null),0===t?e:t===r?e+i:(t/=r/2)<1?i/2*Math.pow(2,10*(t-1))+e-5e-4*i:i/2*1.0005*(-Math.pow(2,-10*--t)+2)+e},t.easeOutInExpo=function(t,e,i,r,n){return null==n&&(n=null),r/2>t?this.easeOutExpo(2*t,e,i/2,r,n):this.easeInExpo(2*t-r,e+i/2,i/2,r,n)},t.easeInCirc=function(t,e,i,r,n){return null==n&&(n=null),-i*(Math.sqrt(1-(t/=r)*t)-1)+e},t.easeOutCirc=function(t,e,i,r,n){return null==n&&(n=null),i*Math.sqrt(1-(t=t/r-1)*t)+e},t.easeInOutCirc=function(t,e,i,r,n){return null==n&&(n=null),(t/=r/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},t.easeOutInCirc=function(t,e,i,r,n){return null==n&&(n=null),r/2>t?this.easeOutCirc(2*t,e,i/2,r,n):this.easeInCirc(2*t-r,e+i/2,i/2,r,n)},t.easeInBack=function(t,e,i,r,n){return null==n&&(n=1.70158),i*(t/=r)*t*((n+1)*t-n)+e},t.easeOutBack=function(t,e,i,r,n){return null==n&&(n=1.70158),i*((t=t/r-1)*t*((n+1)*t+n)+1)+e},t.easeInOutBack=function(t,e,i,r,n){return null==n&&(n=1.70158),(t/=r/2)<1?i/2*t*t*(((n*=1.525)+1)*t-n)+e:i/2*((t-=2)*t*(((n*=1.525)+1)*t+n)+2)+e},t}(),KTObject=function(){function t(t,e,i,r,n,s){var o;this.id=t,this.target=e,this.initTime=i,this.duration=r,this.transition=s,this.iDuration=1/this.duration,this.params=[],this.endValues=[],this.distances=[],this.initValues=[],this.numParams=0,this.onComplete=n.onComplete,this.onCompleteParams=n.onCompleteParams,this.onUpdate=n.onUpdate,this.onUpdateParams=n.onUpdateParams,this.onInit=n.onInit,delete n.onComplete,delete n.onCompleteParams,delete n.onUpdate,delete n.onInit;for(o in n)(this.target.hasOwnProperty(o)||null!=this.target[o])&&(this.params.push(o),this.endValues.push(Number(n[o])),this.distances.push(0),this.initValues.push(0),this.numParams++)}return t.prototype.remove=function(t){var e,i;if(null==t&&(t=null),e=!0,t){for(i=this.numParams;i-->0;)this.params[i]===t&&(this.params.splice(i,1),this.endValues.splice(i,1),this.distances.splice(i,1),this.initValues.splice(i,1),this.numParams--);e=this.numParams<=0}return e?(this.dispose(),!0):!1},t.prototype.dispose=function(){return this.target=null,this.transition=null,this.onComplete=null,this.onCompleteParams=null,this.params=null,this.endValues=null,this.distances=null,this.initValues=null,delete this.target,delete this.transition,delete this.onComplete,delete this.onCompleteParams,delete this.params,delete this.endValues,delete this.distances,delete this.initValues},t.prototype.init=function(){var t,e,i;for(this.onInit&&this.onInit.apply(this.target),t=this.numParams,i=[];t-->=0;)e=this.initValues[t]=Number(this.target[this.params[t]]),i.push(this.distances[t]=this.endValues[t]-e);return i},t}(),window.KTween=KTween;var ObjectUtils;ObjectUtils=function(){function t(){}return t.count=function(t){var e,i;i=0;for(e in t)i++;return i},t.toArray=function(t){var e,i,r;i=[];for(e in t)r=t[e],i.push(t[e]);return i},t.merge=function(t,e){var i;if("object"==typeof t&&"object"==typeof e)for(i in e)t.hasOwnProperty(i)||(t[i]=e[i]);return t},t.clone=function(t){var e,i,r,n,s,o;try{if(!t||"object"!=typeof t)return t;if(e=null,t instanceof Array){for(e=[],r=0,s=t.length;s>r;)e[r]=this.clone(t[r]),r++;return e}if(t instanceof Object){e={};for(n in t)o=t[n],e[n]="object"!==o?o:this.clone(o);return e}}catch(a){return i=a,JSON.parse(JSON.stringify(t))}},t.hasSameKey=function(t,e){return Object.getOwnPropertyNames(t)[0]===Object.getOwnPropertyNames(e)[0]?!0:!1},t.isEqual=function(t,e){return JSON.stringify(t)===JSON.stringify(e)},t.parseLinkedArray=function(t){var e,i,r,n,s,o,a;if(!t||t&&t.length<1)return[];for(e=t.length,n=t[0],s=n.length,a=[];e-->1;){for(o={},r=s,i=t[e];r-->0;)o[n[r]]=i[r];a[e-1]=o}return a},t.find=function(t,e,i,r){var n,s;return null==i&&(i=null),null==r&&(r=!1),t?(/^\//.test(e)?(e=e.replace(/^\//,""),i||(i=t),s=this.find(t,e)):(n=e.split("."),s=t[n[0]],n.length>1&&s?(n.shift(),e=n.join("."),s=this.find(s,e,r)):n.length>1&&(s=null)),r&&console.log(">>>>>",s),s):null},t}();var NumberUtils;NumberUtils=function(){function t(){}return t.isEven=function(t){return t%2===0?!0:!1},t.isZero=function(t){return Math.abs(t)<1e-5},t.toPercent=function(t,e,i){return(t-e)/(i-e)*100},t.percentToValue=function(t,e,i){return(i-e)*t+e},t.getBytesAsMegabytes=function(t){return Math.floor(t/1024/1024*100)/100+" MB"},t.bytesTo=function(t){return t>=1e9?(t/1e9).toFixed(2)+" GB":t>=1e6?(t/1e6).toFixed(2)+" MB":t>=1e3?(t/1e3).toFixed(2)+" KB":t>1?t+" bytes":1===t?t+" byte":"0 byte"},t.rangeRandom=function(t,e,i){return null==i&&(i=!1),i?Math.round(Math.round(Math.random()*(e-t))+t):Math.random()*(e-t)+t},t.distanceBetweenCoordinates=function(t,e,i){var r,n,s,o,a;switch(null==i&&(i="km"),i){case"km":a=6371;break;case"meters":a=6378e3;break;case"feet":a=20925525;break;case"miles":a=3963}return s=(e.x-t.x)*Math.PI/180,o=(e.y-t.y)*Math.PI/180,r=Math.sin(s/2)*Math.sin(s/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(t.x*Math.PI/180)*Math.cos(e.x*Math.PI/180),n=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),a*n},t}();var ArrayUtils;ArrayUtils=function(){function t(){}return t.removeItem=function(t,e,i){var r,n,s,o,a;for(null==i&&(i=!1),n=i?t.slice(0):t,s=o=0,a=n.length;a>o;s=++o)r=n[s],r===e&&n.splice(s,1);return n},t.removeItemByIndex=function(t,e,i){var r;return null==i&&(i=!1),r=i?e.slice(0):e,r.splice(t,1),r},t.removeDuplicateStrings=function(t,e){return null==e&&(e=!1),t.filter(function(t,e,i){return i.indexOf(t)===e})},t.hasItem=function(t,e){return e.indexOf(t)>-1},t.merge=function(t,e){var i,r,n;for(i=0,r=0,n=[];i<t.length||r<e.length;)i<t.length&&(n.push(t[i]),i++),r<e.length&&(n.push(e[r]),r++);return n},t.randomIndex=function(t){return NumberUtils.rangeRandom(0,t.length-1,!0)},t.randomItem=function(e){return e[t.randomIndex(e)]},t.shuffle=function(t,e){var i,r,n,s,o,a,h;for(null==e&&(e=!1),s=e?t.slice(0):t,i=a=0,h=s.length;h>a;i=++a)r=s[i],n=Math.floor(Math.random()*s.length),o=s[i],s[i]=s[n],s[n]=o;return s},t.move=function(t,e,i,r){var n,s;if(null==r&&(r=!1),s=r?t.slice(0):t,i>=s.length)for(n=new_index-s.length;n--+1;)s.push(void 0);return s.splice(i,0,s.splice(e,1)[0]),s},t.fromMiddleToEnd=function(t){var e,i,r,n,s;return r=t.length,s=Math.floor(.5*r),e=t.slice(s,r),i=t.slice(0,s).reverse(),n=this.merge(e,i)},t.fromEndToMiddle=function(t){return this.fromMiddleToEnd(t).reverse()},t.lastIndexOf=function(t,e){var i,r,n;for(i=0,n=t.length,r=-1;i!==n;)t[i]===e&&(r=i),i++;return r},t.toArray=function(t){var e,i;if(i=[],t.length)for(e=t.length;e-->0;)i[e]=t[e];return i},t}();var StringUtils,__slice=[].slice;StringUtils=function(){function t(){}return t.hasString=function(t,e){return 1!==t.split(e).length?!0:!1},t.replace=function(t,e,i){return t.split(e).join(i)},t.reverse=function(t){return t?t.split("").reverse().join(""):""},t.toCamelCase=function(t){var e;return e=t.replace(/([\+\-_ ][a-z])/g,function(t){return t.toUpperCase().replace(/[\+\-_ ]/,"")}),e.charAt(0).toUpperCase()+e.slice(1)},t.removeWhiteSpace=function(t){return t?this.trim(t).replace(/\s+/g,""):""},t.removeHTMLTag=function(t){return t.replace(/<.*?>/g,"")},t.removeSpecialChars=function(t){return t.replace(/[^a-zA-Z 0-9]+/g,"")},t.convertToCPF=function(t){return t=this.removeSpecialChars(t),t=t.length>9?t.replace(/(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,"$1.$2.$3-$4"):t.length>6?t.replace(/(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,"$1.$2.$3"):t.length>3?t.replace(/(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,"$1.$2"):t.replace(/(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,2})/,"$1")},t.convertToCEP=function(t){return t=this.removeSpecialChars(t),t=t.length>5?t.replace(/(\d{0,5})(\d{0,3})/,"$1-$2"):t.replace(/(\d{0,5})(\d{0,3})/,"$1")},t.convertToDate=function(t){return t=this.removeSpecialChars(t),t=t.length>4?t.replace(/(\d{0,2})(\d{0,2})(\d{0,4})/,"$1/$2/$3"):t.length>2?t.replace(/(\d{0,2})(\d{0,2})(\d{0,4})/,"$1/$2"):t.replace(/(\d{0,2})(\d{0,2})(\d{0,4})/,"$1")},t.isEmpty=function(t){return t&&""!==t?!1:!0},t.toCapitalizeCase=function(t){var e;return e=this.trimLeft(t),e.replace(/(^\w)/,this._upperCase)},t.toTimeFormat=function(t,e){var i,r;return null==e&&(e=!0),i=Math.floor(t/60),r=Math.floor(t%60),String(e?this.addDecimalZero(i)+":"+this.addDecimalZero(r):i+":"+r)},t.addDecimalZero=function(t){return 10>t?"0"+t:String(t)},t.abbreviate=function(t,e,i,r){var n,s,o,a,h;if(null==e&&(e=50),null==i&&(i="..."),null==r&&(r=" "),!t)return"";if(t.length<e)return t;for(h="",o=0,a=t.split(r),s=a[o].length;e>s&&o<a.length;)h+=a[o]+r,s+=a[++o].length+r.length;
if(o<a.length){for(n=["-","—",",","."," ",":","?","!","","\n"," ",String.fromCharCode(10),String.fromCharCode(13)];-1!==n.indexOf(h.charAt(h.length-1));)h=h.slice(0,-1);h=this.trim(h)+i}return 0===o&&(h=t.slice(0,e)+i),h},t.toBoolean=function(t){var e;return e=["yes","true","1",1,!0],t&&ArrayUtils.hasItem(t,e)?!0:!1},t.random=function(t){var e,i,r;for(null==t&&(t=10),i="",e=r=t;1>=t?1>=r:r>=1;e=1>=t?++r:--r)i+=String.fromCharCode(65+Math.floor(25*Math.random()));return i},t.trim=function(t,e){return null===t?"":this.trimRight(this.trimLeft(t,e),e)},t.trimRight=function(t,e){var i;return t?(i=new RegExp(e+"*$"),i.global=!0,i.multiline=!0,t.replace(i,"")):""},t.trimLeft=function(t,e){var i;return t?(i=new RegExp("^"+e+"*"),i.global=!0,i.multiline=!0,t.replace(i,"")):""},t.replaceSpecialCharacters=function(t){var e,i;this.substitionDict||this._initDict();for(e in this.substitionDict)console.log(e),i=new RegExp(e,"g"),t=t.replace(i,this.substitionDict[e]);return t},t._upperCase=function(){var t,e;return e=arguments[0],t=2<=arguments.length?__slice.call(arguments,1):[],e.toUpperCase()},t.substitionDict=null,t._initDict=function(){var t,e;this.substitionDict=[],this.substitionDict["ã"]="a",this.substitionDict["á"]="a",this.substitionDict["â"]="a",this.substitionDict["ä"]="a",this.substitionDict["à"]="a",this.substitionDict["é"]="e",this.substitionDict["ê"]="e",this.substitionDict["ë"]="e",this.substitionDict["è"]="e",this.substitionDict["í"]="i",this.substitionDict["î"]="i",this.substitionDict["ï"]="i",this.substitionDict["ì"]="i",this.substitionDict["õ"]="o",this.substitionDict["ó"]="o",this.substitionDict["ô"]="o",this.substitionDict["ö"]="o",this.substitionDict["ò"]="o",this.substitionDict["ú"]="u",this.substitionDict["û"]="u",this.substitionDict["ü"]="u",this.substitionDict["ù"]="u",this.substitionDict["ç"]="c",this.substitionDict["ñ"]="n",e=[];for(t in this.substitionDict)e.push(this.substitionDict[t.toUpperCase()]=String(this.substitionDict[t]).toUpperCase());return e},t}();var JSONUtils;JSONUtils=function(){function t(){}return t.parseJSON=function(e){var i;return i=!1,"string"==typeof e&&(i=!0,e=t.replaceMultiline(e)),e=t.removeComments(e),i&&(e=JSON.parse(e)),e},t.replaceMultiline=function(t){return"string"!=typeof t?t:(t=t.replace(/^(\s*.*?""")(?:[\s\t]*\n)?([\t\s]*)(\S[\s\S]*)\n?[\s]*(""")/gim,this._replaceMultilinePart),t=t.replace(/^(\s*.*?)"""([\s\S]*?)"""/gim,this._replaceEmptyMultiline))},t._replaceMultilinePart=function(t,e,i,r,n){var s;return s=new RegExp(i+"?([^\n]*)","g"),r=r.replace(s,"$1"),e+r+n},t._replaceEmptyMultiline=function(t,e,i){return i=i.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t"),e+'"'+i+'"'},t.removeComments=function(t){var e;return e=!0,"string"!=typeof t&&(e=!1,t=JSON.stringify(t)),t=t.replace(/(^|\s)(\/\/.*$)|(\/\*(.|\s)*?\*\/?)/gim,""),e?t:JSON.parse(t)},t.filterObject=function(t,e,i,r,n){var s,o,a,h;null==i&&(i=null),null==r&&(r=null),null==n&&(n=!1),a=[],e=[].concat(e),r&&(r=[].concat(r));for(o in t)h=t[o],r&&r.indexOf(o)>=0||(e.indexOf(o)>=0&&(s=!0,i&&typeof h!==i&&(s=!1),s&&(n?a.indexOf(t)<0&&a.push(t):a.push(h))),("array"==typeof h||"object"==typeof h)&&(a=[].concat(a,this.filterObject(h,e,i,r,n))));return a},t}(),this.createjs=this.createjs||{},function(){"use strict";var t=createjs.PreloadJS=createjs.PreloadJS||{};t.version="0.6.1",t.buildDate="Thu, 21 May 2015 16:17:37 GMT"}(),this.createjs=this.createjs||{},createjs.extend=function(t,e){"use strict";function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i},this.createjs=this.createjs||{},createjs.promote=function(t,e){"use strict";var i=t.prototype,r=Object.getPrototypeOf&&Object.getPrototypeOf(i)||i.__proto__;if(r){i[(e+="_")+"constructor"]=r.constructor;for(var n in r)i.hasOwnProperty(n)&&"function"==typeof r[n]&&(i[e+n]=r[n])}return t},this.createjs=this.createjs||{},createjs.indexOf=function(t,e){"use strict";for(var i=0,r=t.length;r>i;i++)if(e===t[i])return i;return-1},this.createjs=this.createjs||{},function(){"use strict";createjs.proxy=function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,Array.prototype.slice.call(arguments,0).concat(i))}}}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"BrowserDetect cannot be instantiated"}var e=t.agent=window.navigator.userAgent;t.isWindowPhone=e.indexOf("IEMobile")>-1||e.indexOf("Windows Phone")>-1,t.isFirefox=e.indexOf("Firefox")>-1,t.isOpera=null!=window.opera,t.isChrome=e.indexOf("Chrome")>-1,t.isIOS=(e.indexOf("iPod")>-1||e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&!t.isWindowPhone,t.isAndroid=e.indexOf("Android")>-1&&!t.isWindowPhone,t.isBlackberry=e.indexOf("Blackberry")>-1,createjs.BrowserDetect=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!e,this.cancelable=!!i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var e=t.prototype;e.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},e.stopPropagation=function(){this.propagationStopped=!0},e.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},e.remove=function(){this.removed=!0},e.clone=function(){return new t(this.type,this.bubbles,this.cancelable)},e.set=function(t){for(var e in t)this[e]=t[e];return this},e.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.Event_constructor("error"),this.title=t,this.message=e,this.data=i}var e=createjs.extend(t,createjs.Event);e.clone=function(){return new createjs.ErrorEvent(this.title,this.message,this.data)},createjs.ErrorEvent=createjs.promote(t,"Event")}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this._listeners=null,this._captureListeners=null}var e=t.prototype;t.initialize=function(t){t.addEventListener=e.addEventListener,t.on=e.on,t.removeEventListener=t.off=e.removeEventListener,t.removeAllEventListeners=e.removeAllEventListeners,t.hasEventListener=e.hasEventListener,t.dispatchEvent=e.dispatchEvent,t._dispatchEvent=e._dispatchEvent,t.willTrigger=e.willTrigger},e.addEventListener=function(t,e,i){var r;r=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var n=r[t];return n&&this.removeEventListener(t,e,i),n=r[t],n?n.push(e):r[t]=[e],e},e.on=function(t,e,i,r,n,s){return e.handleEvent&&(i=i||e,e=e.handleEvent),i=i||this,this.addEventListener(t,function(t){e.call(i,t,n),r&&t.remove()},s)},e.removeEventListener=function(t,e,i){var r=i?this._captureListeners:this._listeners;if(r){var n=r[t];if(n)for(var s=0,o=n.length;o>s;s++)if(n[s]==e){1==o?delete r[t]:n.splice(s,1);break}}},e.off=e.removeEventListener,e.removeAllEventListeners=function(t){t?(this._listeners&&delete this._listeners[t],this._captureListeners&&delete this._captureListeners[t]):this._listeners=this._captureListeners=null},e.dispatchEvent=function(t){if("string"==typeof t){var e=this._listeners;if(!e||!e[t])return!1;t=new createjs.Event(t)}else t.target&&t.clone&&(t=t.clone());try{t.target=this}catch(i){}if(t.bubbles&&this.parent){for(var r=this,n=[r];r.parent;)n.push(r=r.parent);var s,o=n.length;for(s=o-1;s>=0&&!t.propagationStopped;s--)n[s]._dispatchEvent(t,1+(0==s));for(s=1;o>s&&!t.propagationStopped;s++)n[s]._dispatchEvent(t,3)}else this._dispatchEvent(t,2);return t.defaultPrevented},e.hasEventListener=function(t){var e=this._listeners,i=this._captureListeners;return!!(e&&e[t]||i&&i[t])},e.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.parent}return!1},e.toString=function(){return"[EventDispatcher]"},e._dispatchEvent=function(t,e){var i,r=1==e?this._captureListeners:this._listeners;if(t&&r){var n=r[t.type];if(!n||!(i=n.length))return;try{t.currentTarget=this}catch(s){}try{t.eventPhase=e}catch(s){}t.removed=!1,n=n.slice();for(var o=0;i>o&&!t.immediatePropagationStopped;o++){var a=n[o];a.handleEvent?a.handleEvent(t):a(t),t.removed&&(this.off(t.type,a,1==e),t.removed=!1)}}},createjs.EventDispatcher=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.Event_constructor("progress"),this.loaded=t,this.total=null==e?1:e,this.progress=0==e?0:this.loaded/this.total}var e=createjs.extend(t,createjs.Event);e.clone=function(){return new createjs.ProgressEvent(this.loaded,this.total)},createjs.ProgressEvent=createjs.promote(t,"Event")}(window),function(){function t(e,r){function s(t){if(s[t]!==g)return s[t];var e;if("bug-string-char-index"==t)e="a"!="a"[0];else if("json"==t)e=s("json-stringify")&&s("json-parse");else{var i,n='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var h=r.stringify,u="function"==typeof h&&y;if(u){(i=function(){return 1}).toJSON=i;try{u="0"===h(0)&&"0"===h(new o)&&'""'==h(new a)&&h(v)===g&&h(g)===g&&h()===g&&"1"===h(i)&&"[1]"==h([i])&&"[null]"==h([g])&&"null"==h(null)&&"[null,null,null]"==h([g,v,null])&&h({a:[i,!0,!1,null,"\x00\b\n\f\r	"]})==n&&"1"===h(null,i)&&"[\n 1,\n 2\n]"==h([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==h(new l(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==h(new l(864e13))&&'"-000001-01-01T00:00:00.000Z"'==h(new l(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==h(new l(-1))}catch(c){u=!1}}e=u}if("json-parse"==t){var d=r.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){i=d(n);var _=5==i.a.length&&1===i.a[0];if(_){try{_=!d('"	"')}catch(c){}if(_)try{_=1!==d("01")}catch(c){}if(_)try{_=1!==d("1.")}catch(c){}}}}catch(c){_=!1}e=_}}return s[t]=!!e}e||(e=n.Object()),r||(r=n.Object());var o=e.Number||n.Number,a=e.String||n.String,h=e.Object||n.Object,l=e.Date||n.Date,u=e.SyntaxError||n.SyntaxError,c=e.TypeError||n.TypeError,d=e.Math||n.Math,_=e.JSON||n.JSON;"object"==typeof _&&_&&(r.stringify=_.stringify,r.parse=_.parse);var p,f,g,m=h.prototype,v=m.toString,y=new l(-0xc782b5b800cec);try{y=-109252==y.getUTCFullYear()&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(b){}if(!s("json")){var w="[object Function]",E="[object Date]",T="[object Number]",C="[object String]",L="[object Array]",P="[object Boolean]",A=s("bug-string-char-index");if(!y)var S=d.floor,O=[0,31,59,90,120,151,181,212,243,273,304,334],x=function(t,e){return O[e]+365*(t-1970)+S((t-1969+(e=+(e>1)))/4)-S((t-1901+e)/100)+S((t-1601+e)/400)};if((p=m.hasOwnProperty)||(p=function(t){var e,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=v?p=function(t){var e=this.__proto__,i=t in(this.__proto__=null,this);return this.__proto__=e,i}:(e=i.constructor,p=function(t){var i=(this.constructor||e).prototype;return t in this&&!(t in i&&this[t]===i[t])}),i=null,p.call(this,t)}),f=function(t,e){var r,n,s,o=0;(r=function(){this.valueOf=0}).prototype.valueOf=0,n=new r;for(s in n)p.call(n,s)&&o++;return r=n=null,o?f=2==o?function(t,e){var i,r={},n=v.call(t)==w;for(i in t)n&&"prototype"==i||p.call(r,i)||!(r[i]=1)||!p.call(t,i)||e(i)}:function(t,e){var i,r,n=v.call(t)==w;for(i in t)n&&"prototype"==i||!p.call(t,i)||(r="constructor"===i)||e(i);(r||p.call(t,i="constructor"))&&e(i)}:(n=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(t,e){var r,s,o=v.call(t)==w,a=!o&&"function"!=typeof t.constructor&&i[typeof t.hasOwnProperty]&&t.hasOwnProperty||p;for(r in t)o&&"prototype"==r||!a.call(t,r)||e(r);for(s=n.length;r=n[--s];a.call(t,r)&&e(r));}),f(t,e)},!s("json-stringify")){var R={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},I="000000",j=function(t,e){return(I+(e||0)).slice(-t)},k="\\u00",M=function(t){for(var e='"',i=0,r=t.length,n=!A||r>10,s=n&&(A?t.split(""):t);r>i;i++){var o=t.charCodeAt(i);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:e+=R[o];break;default:if(32>o){e+=k+j(2,o.toString(16));break}e+=n?s[i]:t.charAt(i)}}return e+'"'},D=function(t,e,i,r,n,s,o){var a,h,l,u,d,_,m,y,b,w,A,O,R,I,k,N;try{a=e[t]}catch(B){}if("object"==typeof a&&a)if(h=v.call(a),h!=E||p.call(a,"toJSON"))"function"==typeof a.toJSON&&(h!=T&&h!=C&&h!=L||p.call(a,"toJSON"))&&(a=a.toJSON(t));else if(a>-1/0&&1/0>a){if(x){for(d=S(a/864e5),l=S(d/365.2425)+1970-1;x(l+1,0)<=d;l++);for(u=S((d-x(l,0))/30.42);x(l,u+1)<=d;u++);d=1+d-x(l,u),_=(a%864e5+864e5)%864e5,m=S(_/36e5)%24,y=S(_/6e4)%60,b=S(_/1e3)%60,w=_%1e3}else l=a.getUTCFullYear(),u=a.getUTCMonth(),d=a.getUTCDate(),m=a.getUTCHours(),y=a.getUTCMinutes(),b=a.getUTCSeconds(),w=a.getUTCMilliseconds();a=(0>=l||l>=1e4?(0>l?"-":"+")+j(6,0>l?-l:l):j(4,l))+"-"+j(2,u+1)+"-"+j(2,d)+"T"+j(2,m)+":"+j(2,y)+":"+j(2,b)+"."+j(3,w)+"Z"}else a=null;if(i&&(a=i.call(e,t,a)),null===a)return"null";if(h=v.call(a),h==P)return""+a;if(h==T)return a>-1/0&&1/0>a?""+a:"null";if(h==C)return M(""+a);if("object"==typeof a){for(I=o.length;I--;)if(o[I]===a)throw c();if(o.push(a),A=[],k=s,s+=n,h==L){for(R=0,I=a.length;I>R;R++)O=D(R,a,i,r,n,s,o),A.push(O===g?"null":O);N=A.length?n?"[\n"+s+A.join(",\n"+s)+"\n"+k+"]":"["+A.join(",")+"]":"[]"}else f(r||a,function(t){var e=D(t,a,i,r,n,s,o);e!==g&&A.push(M(t)+":"+(n?" ":"")+e)}),N=A.length?n?"{\n"+s+A.join(",\n"+s)+"\n"+k+"}":"{"+A.join(",")+"}":"{}";return o.pop(),N}};r.stringify=function(t,e,r){var n,s,o,a;if(i[typeof e]&&e)if((a=v.call(e))==w)s=e;else if(a==L){o={};for(var h,l=0,u=e.length;u>l;h=e[l++],a=v.call(h),(a==C||a==T)&&(o[h]=1));}if(r)if((a=v.call(r))==T){if((r-=r%1)>0)for(n="",r>10&&(r=10);n.length<r;n+=" ");}else a==C&&(n=r.length<=10?r:r.slice(0,10));return D("",(h={},h[""]=t,h),s,o,n,"",[])}}if(!s("json-parse")){var N,B,q=a.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},H=function(){throw N=B=null,u()},F=function(){for(var t,e,i,r,n,s=B,o=s.length;o>N;)switch(n=s.charCodeAt(N)){case 9:case 10:case 13:case 32:N++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=A?s.charAt(N):s[N],N++,t;case 34:for(t="@",N++;o>N;)if(n=s.charCodeAt(N),32>n)H();else if(92==n)switch(n=s.charCodeAt(++N)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=U[n],N++;break;case 117:for(e=++N,i=N+4;i>N;N++)n=s.charCodeAt(N),n>=48&&57>=n||n>=97&&102>=n||n>=65&&70>=n||H();t+=q("0x"+s.slice(e,N));break;default:H()}else{if(34==n)break;for(n=s.charCodeAt(N),e=N;n>=32&&92!=n&&34!=n;)n=s.charCodeAt(++N);t+=s.slice(e,N)}if(34==s.charCodeAt(N))return N++,t;H();default:if(e=N,45==n&&(r=!0,n=s.charCodeAt(++N)),n>=48&&57>=n){for(48==n&&(n=s.charCodeAt(N+1),n>=48&&57>=n)&&H(),r=!1;o>N&&(n=s.charCodeAt(N),n>=48&&57>=n);N++);if(46==s.charCodeAt(N)){for(i=++N;o>i&&(n=s.charCodeAt(i),n>=48&&57>=n);i++);i==N&&H(),N=i}if(n=s.charCodeAt(N),101==n||69==n){for(n=s.charCodeAt(++N),(43==n||45==n)&&N++,i=N;o>i&&(n=s.charCodeAt(i),n>=48&&57>=n);i++);i==N&&H(),N=i}return+s.slice(e,N)}if(r&&H(),"true"==s.slice(N,N+4))return N+=4,!0;if("false"==s.slice(N,N+5))return N+=5,!1;if("null"==s.slice(N,N+4))return N+=4,null;H()}return"$"},V=function(t){var e,i;if("$"==t&&H(),"string"==typeof t){if("@"==(A?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=F(),"]"!=t;i||(i=!0))i&&(","==t?(t=F(),"]"==t&&H()):H()),","==t&&H(),e.push(V(t));return e}if("{"==t){for(e={};t=F(),"}"!=t;i||(i=!0))i&&(","==t?(t=F(),"}"==t&&H()):H()),(","==t||"string"!=typeof t||"@"!=(A?t.charAt(0):t[0])||":"!=F())&&H(),e[t.slice(1)]=V(F());return e}H()}return t},X=function(t,e,i){var r=J(t,e,i);r===g?delete t[e]:t[e]=r},J=function(t,e,i){var r,n=t[e];if("object"==typeof n&&n)if(v.call(n)==L)for(r=n.length;r--;)X(n,r,i);else f(n,function(t){X(n,t,i)});return i.call(t,e,n)};r.parse=function(t,e){var i,r;return N=0,B=""+t,i=V(F()),"$"!=F()&&H(),N=B=null,e&&v.call(e)==w?J((r={},r[""]=i,r),"",e):i}}}return r.runInContext=t,r}var e="function"==typeof define&&define.amd,i={"function":!0,object:!0},r=i[typeof exports]&&exports&&!exports.nodeType&&exports,n=i[typeof window]&&window||this,s=r&&i[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(!s||s.global!==s&&s.window!==s&&s.self!==s||(n=s),r&&!e)t(n,r);else{var o=n.JSON,a=n.JSON3,h=!1,l=t(n,n.JSON3={noConflict:function(){return h||(h=!0,n.JSON=o,n.JSON3=a,o=a=null),l}});n.JSON={parse:l.parse,stringify:l.stringify}}e&&define(function(){return l})}.call(this),function(){var t={};t.appendToHead=function(e){t.getHead().appendChild(e)},t.getHead=function(){return document.head||document.getElementsByTagName("head")[0]},t.getBody=function(){return document.body||document.getElementsByTagName("body")[0]},createjs.DomUtils=t}(),function(){var t={};t.parseXML=function(t,e){var i=null;try{if(window.DOMParser){var r=new DOMParser;i=r.parseFromString(t,e)}}catch(n){}if(!i)try{i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.loadXML(t)}catch(n){i=null}return i},t.parseJSON=function(t){if(null==t)return null;try{return JSON.parse(t)}catch(e){throw e}},createjs.DataUtils=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(){this.src=null,this.type=null,this.id=null,this.maintainOrder=!1,this.callback=null,this.data=null,this.method=createjs.LoadItem.GET,this.values=null,this.headers=null,this.withCredentials=!1,this.mimeType=null,this.crossOrigin=null,this.loadTimeout=i.LOAD_TIMEOUT_DEFAULT}var e=t.prototype={},i=t;i.LOAD_TIMEOUT_DEFAULT=8e3,i.create=function(e){if("string"==typeof e){var r=new t;return r.src=e,r}if(e instanceof i)return e;if(e instanceof Object&&e.src)return null==e.loadTimeout&&(e.loadTimeout=i.LOAD_TIMEOUT_DEFAULT),e;throw new Error("Type not recognized.")},e.set=function(t){for(var e in t)this[e]=t[e];return this},createjs.LoadItem=i}(),function(){var t={};t.ABSOLUTE_PATT=/^(?:\w+:)?\/{2}/i,t.RELATIVE_PATT=/^[.\/]*?\//i,t.EXTENSION_PATT=/\/?[^\/]+\.(\w{1,5})$/i,t.parseURI=function(e){var i={absolute:!1,relative:!1};if(null==e)return i;var r=e.indexOf("?");r>-1&&(e=e.substr(0,r));var n;return t.ABSOLUTE_PATT.test(e)?i.absolute=!0:t.RELATIVE_PATT.test(e)&&(i.relative=!0),(n=e.match(t.EXTENSION_PATT))&&(i.extension=n[1].toLowerCase()),i},t.formatQueryString=function(t,e){if(null==t)throw new Error("You must specify data.");var i=[];for(var r in t)i.push(r+"="+escape(t[r]));return e&&(i=i.concat(e)),i.join("&")},t.buildPath=function(t,e){if(null==e)return t;var i=[],r=t.indexOf("?");if(-1!=r){var n=t.slice(r+1);i=i.concat(n.split("&"))}return-1!=r?t.slice(0,r)+"?"+this._formatQueryString(e,i):t+"?"+this._formatQueryString(e,i)},t.isCrossDomain=function(t){var e=document.createElement("a");e.href=t.src;var i=document.createElement("a");i.href=location.href;var r=""!=e.hostname&&(e.port!=i.port||e.protocol!=i.protocol||e.hostname!=i.hostname);return r},t.isLocal=function(t){var e=document.createElement("a");return e.href=t.src,""==e.hostname&&"file:"==e.protocol},t.isBinary=function(t){switch(t){case createjs.AbstractLoader.IMAGE:case createjs.AbstractLoader.BINARY:return!0;default:return!1}},t.isImageTag=function(t){return t instanceof HTMLImageElement},t.isAudioTag=function(t){return window.HTMLAudioElement?t instanceof HTMLAudioElement:!1},t.isVideoTag=function(t){return window.HTMLVideoElement?t instanceof HTMLVideoElement:!1},t.isText=function(t){switch(t){case createjs.AbstractLoader.TEXT:case createjs.AbstractLoader.JSON:case createjs.AbstractLoader.MANIFEST:case createjs.AbstractLoader.XML:case createjs.AbstractLoader.CSS:case createjs.AbstractLoader.SVG:case createjs.AbstractLoader.JAVASCRIPT:case createjs.AbstractLoader.SPRITESHEET:return!0;default:return!1}},t.getTypeByExtension=function(t){if(null==t)return createjs.AbstractLoader.TEXT;switch(t.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"webp":case"bmp":return createjs.AbstractLoader.IMAGE;case"ogg":case"mp3":case"webm":return createjs.AbstractLoader.SOUND;case"mp4":case"webm":case"ts":return createjs.AbstractLoader.VIDEO;case"json":return createjs.AbstractLoader.JSON;case"xml":return createjs.AbstractLoader.XML;case"css":return createjs.AbstractLoader.CSS;case"js":return createjs.AbstractLoader.JAVASCRIPT;case"svg":return createjs.AbstractLoader.SVG;default:return createjs.AbstractLoader.TEXT}},createjs.RequestUtils=t}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.EventDispatcher_constructor(),this.loaded=!1,this.canceled=!1,this.progress=0,this.type=i,this.resultFormatter=null,this._item=t?createjs.LoadItem.create(t):null,this._preferXHR=e,this._result=null,this._rawResult=null,this._loadedItems=null,this._tagSrcAttribute=null,this._tag=null}var e=createjs.extend(t,createjs.EventDispatcher),i=t;i.POST="POST",i.GET="GET",i.BINARY="binary",i.CSS="css",i.IMAGE="image",i.JAVASCRIPT="javascript",i.JSON="json",i.JSONP="jsonp",i.MANIFEST="manifest",i.SOUND="sound",i.VIDEO="video",i.SPRITESHEET="spritesheet",i.SVG="svg",i.TEXT="text",i.XML="xml",e.getItem=function(){return this._item},e.getResult=function(t){return t?this._rawResult:this._result},e.getTag=function(){return this._tag},e.setTag=function(t){this._tag=t},e.load=function(){this._createRequest(),this._request.on("complete",this,this),this._request.on("progress",this,this),this._request.on("loadStart",this,this),this._request.on("abort",this,this),this._request.on("timeout",this,this),this._request.on("error",this,this);var t=new createjs.Event("initialize");t.loader=this._request,this.dispatchEvent(t),this._request.load()},e.cancel=function(){this.canceled=!0,this.destroy()},e.destroy=function(){this._request&&(this._request.removeAllEventListeners(),this._request.destroy()),this._request=null,this._item=null,this._rawResult=null,this._result=null,this._loadItems=null,this.removeAllEventListeners()},e.getLoadedItems=function(){return this._loadedItems},e._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.TagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._createTag=function(){return null},e._sendLoadStart=function(){this._isCanceled()||this.dispatchEvent("loadstart")},e._sendProgress=function(t){if(!this._isCanceled()){var e=null;"number"==typeof t?(this.progress=t,e=new createjs.ProgressEvent(this.progress)):(e=t,this.progress=t.loaded/t.total,e.progress=this.progress,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0)),this.hasEventListener("progress")&&this.dispatchEvent(e)}},e._sendComplete=function(){if(!this._isCanceled()){this.loaded=!0;var t=new createjs.Event("complete");t.rawResult=this._rawResult,null!=this._result&&(t.result=this._result),this.dispatchEvent(t)}},e._sendError=function(t){!this._isCanceled()&&this.hasEventListener("error")&&(null==t&&(t=new createjs.ErrorEvent("PRELOAD_ERROR_EMPTY")),this.dispatchEvent(t))},e._isCanceled=function(){return null==window.createjs||this.canceled?!0:!1},e.resultFormatter=null,e.handleEvent=function(t){switch(t.type){case"complete":this._rawResult=t.target._response;var e=this.resultFormatter&&this.resultFormatter(this),i=this;e instanceof Function?e(function(t){i._result=t,i._sendComplete()}):(this._result=e||this._rawResult,this._sendComplete());break;case"progress":this._sendProgress(t);break;case"error":this._sendError(t);break;case"loadstart":this._sendLoadStart();break;case"abort":case"timeout":this._isCanceled()||this.dispatchEvent(t.type)}},e.buildPath=function(t,e){return createjs.RequestUtils.buildPath(t,e)},e.toString=function(){return"[PreloadJS AbstractLoader]"},createjs.AbstractLoader=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src"}var e=createjs.extend(t,createjs.AbstractLoader);e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._request=this._preferXHR?new createjs.XHRRequest(this._item):new createjs.MediaTagRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._formatResult=function(t){return this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(t.getTag().src=t.getResult(!0)),t.getTag()},createjs.AbstractMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";var t=function(t){this._item=t},e=createjs.extend(t,createjs.EventDispatcher);e.load=function(){},e.destroy=function(){},e.cancel=function(){},createjs.AbstractRequest=createjs.promote(t,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this),this._addedToDOM=!1,this._startTagVisibility=null}var e=createjs.extend(t,createjs.AbstractRequest);e.load=function(){this._tag.onload=createjs.proxy(this._handleTagComplete,this),this._tag.onreadystatechange=createjs.proxy(this._handleReadyStateChange,this),this._tag.onerror=createjs.proxy(this._handleError,this);var t=new createjs.Event("initialize");t.loader=this._tag,this.dispatchEvent(t),this._hideTag(),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag[this._tagSrcAttribute]=this._item.src,null==this._tag.parentNode&&(window.document.body.appendChild(this._tag),this._addedToDOM=!0)},e.destroy=function(){this._clean(),this._tag=null,this.AbstractRequest_destroy()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleError=function(){this._clean(),this.dispatchEvent("error")},e._handleTagComplete=function(){this._rawResult=this._tag,this._result=this.resultFormatter&&this.resultFormatter(this)||this._rawResult,this._clean(),this._showTag(),this.dispatchEvent("complete")},e._handleTimeout=function(){this._clean(),this.dispatchEvent(new createjs.Event("timeout"))},e._clean=function(){this._tag.onload=null,this._tag.onreadystatechange=null,this._tag.onerror=null,this._addedToDOM&&null!=this._tag.parentNode&&this._tag.parentNode.removeChild(this._tag),clearTimeout(this._loadTimeout)},e._hideTag=function(){this._startTagVisibility=this._tag.style.visibility,this._tag.style.visibility="hidden"},e._showTag=function(){this._tag.style.visibility=this._startTagVisibility},e._handleStalled=function(){},createjs.TagRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._loadedHandler=createjs.proxy(this._handleTagComplete,this)}var e=createjs.extend(t,createjs.TagRequest);e.load=function(){var t=createjs.proxy(this._handleStalled,this);this._stalledCallback=t;var e=createjs.proxy(this._handleProgress,this);this._handleProgress=e,this._tag.addEventListener("stalled",t),this._tag.addEventListener("progress",e),this._tag.addEventListener&&this._tag.addEventListener("canplaythrough",this._loadedHandler,!1),this.TagRequest_load()},e._handleReadyStateChange=function(){clearTimeout(this._loadTimeout);var t=this._tag;("loaded"==t.readyState||"complete"==t.readyState)&&this._handleTagComplete()},e._handleStalled=function(){},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._clean=function(){this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.removeEventListener("stalled",this._stalledCallback),this._tag.removeEventListener("progress",this._progressCallback),this.TagRequest__clean()},createjs.MediaTagRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractRequest_constructor(t),this._request=null,this._loadTimeout=null,this._xhrLevel=1,this._response=null,this._rawResponse=null,this._canceled=!1,this._handleLoadStartProxy=createjs.proxy(this._handleLoadStart,this),this._handleProgressProxy=createjs.proxy(this._handleProgress,this),this._handleAbortProxy=createjs.proxy(this._handleAbort,this),this._handleErrorProxy=createjs.proxy(this._handleError,this),this._handleTimeoutProxy=createjs.proxy(this._handleTimeout,this),this._handleLoadProxy=createjs.proxy(this._handleLoad,this),this._handleReadyStateChangeProxy=createjs.proxy(this._handleReadyStateChange,this),!this._createXHR(t)}var e=createjs.extend(t,createjs.AbstractRequest);t.ACTIVEX_VERSIONS=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e.getResult=function(t){return t&&this._rawResponse?this._rawResponse:this._response},e.cancel=function(){this.canceled=!0,this._clean(),this._request.abort()},e.load=function(){if(null==this._request)return void this._handleError();null!=this._request.addEventListener?(this._request.addEventListener("loadstart",this._handleLoadStartProxy,!1),this._request.addEventListener("progress",this._handleProgressProxy,!1),this._request.addEventListener("abort",this._handleAbortProxy,!1),this._request.addEventListener("error",this._handleErrorProxy,!1),this._request.addEventListener("timeout",this._handleTimeoutProxy,!1),this._request.addEventListener("load",this._handleLoadProxy,!1),this._request.addEventListener("readystatechange",this._handleReadyStateChangeProxy,!1)):(this._request.onloadstart=this._handleLoadStartProxy,this._request.onprogress=this._handleProgressProxy,this._request.onabort=this._handleAbortProxy,this._request.onerror=this._handleErrorProxy,this._request.ontimeout=this._handleTimeoutProxy,this._request.onload=this._handleLoadProxy,this._request.onreadystatechange=this._handleReadyStateChangeProxy),1==this._xhrLevel&&(this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout));try{this._item.values&&this._item.method!=createjs.AbstractLoader.GET?this._item.method==createjs.AbstractLoader.POST&&this._request.send(createjs.RequestUtils.formatQueryString(this._item.values)):this._request.send()}catch(t){this.dispatchEvent(new createjs.ErrorEvent("XHR_SEND",null,t))}},e.setResponseType=function(t){"blob"===t&&(t=window.URL?"blob":"arraybuffer",this._responseType=t),this._request.responseType=t},e.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders instanceof Function?this._request.getAllResponseHeaders():null},e.getResponseHeader=function(t){return this._request.getResponseHeader instanceof Function?this._request.getResponseHeader(t):null},e._handleProgress=function(t){if(t&&!(t.loaded>0&&0==t.total)){var e=new createjs.ProgressEvent(t.loaded,t.total);this.dispatchEvent(e)}},e._handleLoadStart=function(){clearTimeout(this._loadTimeout),this.dispatchEvent("loadstart")},e._handleAbort=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("XHR_ABORTED",null,t))},e._handleError=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent(t.message))},e._handleReadyStateChange=function(){4==this._request.readyState&&this._handleLoad()},e._handleLoad=function(){if(!this.loaded){this.loaded=!0;var t=this._checkError();if(t)return void this._handleError(t);if(this._response=this._getResponse(),"arraybuffer"===this._responseType)try{this._response=new Blob([this._response])}catch(e){if(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,"TypeError"===e.name&&window.BlobBuilder){var i=new BlobBuilder;i.append(this._response),this._response=i.getBlob()}}this._clean(),this.dispatchEvent(new createjs.Event("complete"))}},e._handleTimeout=function(t){this._clean(),this.dispatchEvent(new createjs.ErrorEvent("PRELOAD_TIMEOUT",null,t))},e._checkError=function(){var t=parseInt(this._request.status);
switch(t){case 404:case 0:return new Error(t)}return null},e._getResponse=function(){if(null!=this._response)return this._response;if(null!=this._request.response)return this._request.response;try{if(null!=this._request.responseText)return this._request.responseText}catch(t){}try{if(null!=this._request.responseXML)return this._request.responseXML}catch(t){}return null},e._createXHR=function(t){var e=createjs.RequestUtils.isCrossDomain(t),i={},r=null;if(window.XMLHttpRequest)r=new XMLHttpRequest,e&&void 0===r.withCredentials&&window.XDomainRequest&&(r=new XDomainRequest);else{for(var n=0,o=s.ACTIVEX_VERSIONS.length;o>n;n++){var a=s.ACTIVEX_VERSIONS[n];try{r=new ActiveXObject(a);break}catch(h){}}if(null==r)return!1}null==t.mimeType&&createjs.RequestUtils.isText(t.type)&&(t.mimeType="text/plain; charset=utf-8"),t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),this._xhrLevel="string"==typeof r.responseType?2:1;var l=null;if(l=t.method==createjs.AbstractLoader.GET?createjs.RequestUtils.buildPath(t.src,t.values):t.src,r.open(t.method||createjs.AbstractLoader.GET,l,!0),e&&r instanceof XMLHttpRequest&&1==this._xhrLevel&&(i.Origin=location.origin),t.values&&t.method==createjs.AbstractLoader.POST&&(i["Content-Type"]="application/x-www-form-urlencoded"),e||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),t.headers)for(var u in t.headers)i[u]=t.headers[u];for(u in i)r.setRequestHeader(u,i[u]);return r instanceof XMLHttpRequest&&void 0!==t.withCredentials&&(r.withCredentials=t.withCredentials),this._request=r,!0},e._clean=function(){clearTimeout(this._loadTimeout),null!=this._request.removeEventListener?(this._request.removeEventListener("loadstart",this._handleLoadStartProxy),this._request.removeEventListener("progress",this._handleProgressProxy),this._request.removeEventListener("abort",this._handleAbortProxy),this._request.removeEventListener("error",this._handleErrorProxy),this._request.removeEventListener("timeout",this._handleTimeoutProxy),this._request.removeEventListener("load",this._handleLoadProxy),this._request.removeEventListener("readystatechange",this._handleReadyStateChangeProxy)):(this._request.onloadstart=null,this._request.onprogress=null,this._request.onabort=null,this._request.onerror=null,this._request.ontimeout=null,this._request.onload=null,this._request.onreadystatechange=null)},e.toString=function(){return"[PreloadJS XHRRequest]"},createjs.XHRRequest=createjs.promote(t,"AbstractRequest")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e,i){this.AbstractLoader_constructor(),this._plugins=[],this._typeCallbacks={},this._extensionCallbacks={},this.next=null,this.maintainScriptOrder=!0,this.stopOnError=!1,this._maxConnections=1,this._availableLoaders=[createjs.ImageLoader,createjs.JavaScriptLoader,createjs.CSSLoader,createjs.JSONLoader,createjs.JSONPLoader,createjs.SoundLoader,createjs.ManifestLoader,createjs.SpriteSheetLoader,createjs.XMLLoader,createjs.SVGLoader,createjs.BinaryLoader,createjs.VideoLoader,createjs.TextLoader],this._defaultLoaderLength=this._availableLoaders.length,this.init(t,e,i)}var e=createjs.extend(t,createjs.AbstractLoader),i=t;e.init=function(t,e,i){this.useXHR=!0,this.preferXHR=!0,this._preferXHR=!0,this.setPreferXHR(t),this._paused=!1,this._basePath=e,this._crossOrigin=i,this._loadStartWasDispatched=!1,this._currentlyLoadingScript=null,this._currentLoads=[],this._loadQueue=[],this._loadQueueBackup=[],this._loadItemsById={},this._loadItemsBySrc={},this._loadedResults={},this._loadedRawResults={},this._numItems=0,this._numItemsLoaded=0,this._scriptOrder=[],this._loadedScripts=[],this._lastProgress=0/0},i.loadTimeout=8e3,i.LOAD_TIMEOUT=0,i.BINARY=createjs.AbstractLoader.BINARY,i.CSS=createjs.AbstractLoader.CSS,i.IMAGE=createjs.AbstractLoader.IMAGE,i.JAVASCRIPT=createjs.AbstractLoader.JAVASCRIPT,i.JSON=createjs.AbstractLoader.JSON,i.JSONP=createjs.AbstractLoader.JSONP,i.MANIFEST=createjs.AbstractLoader.MANIFEST,i.SOUND=createjs.AbstractLoader.SOUND,i.VIDEO=createjs.AbstractLoader.VIDEO,i.SVG=createjs.AbstractLoader.SVG,i.TEXT=createjs.AbstractLoader.TEXT,i.XML=createjs.AbstractLoader.XML,i.POST=createjs.AbstractLoader.POST,i.GET=createjs.AbstractLoader.GET,e.registerLoader=function(t){if(!t||!t.canLoadItem)throw new Error("loader is of an incorrect type.");if(-1!=this._availableLoaders.indexOf(t))throw new Error("loader already exists.");this._availableLoaders.unshift(t)},e.unregisterLoader=function(t){var e=this._availableLoaders.indexOf(t);-1!=e&&e<this._defaultLoaderLength-1&&this._availableLoaders.splice(e,1)},e.setUseXHR=function(t){return this.setPreferXHR(t)},e.setPreferXHR=function(t){return this.preferXHR=0!=t&&null!=window.XMLHttpRequest,this.preferXHR},e.removeAll=function(){this.remove()},e.remove=function(t){var e=null;if(!t||t instanceof Array){if(t)e=t;else if(arguments.length>0)return}else e=[t];var i=!1;if(e){for(;e.length;){var r=e.pop(),n=this.getResult(r);for(s=this._loadQueue.length-1;s>=0;s--)if(o=this._loadQueue[s].getItem(),o.id==r||o.src==r){this._loadQueue.splice(s,1)[0].cancel();break}for(s=this._loadQueueBackup.length-1;s>=0;s--)if(o=this._loadQueueBackup[s].getItem(),o.id==r||o.src==r){this._loadQueueBackup.splice(s,1)[0].cancel();break}if(n)this._disposeItem(this.getItem(r));else for(var s=this._currentLoads.length-1;s>=0;s--){var o=this._currentLoads[s].getItem();if(o.id==r||o.src==r){this._currentLoads.splice(s,1)[0].cancel(),i=!0;break}}}i&&this._loadNext()}else{this.close();for(var a in this._loadItemsById)this._disposeItem(this._loadItemsById[a]);this.init(this.preferXHR,this._basePath)}},e.reset=function(){this.close();for(var t in this._loadItemsById)this._disposeItem(this._loadItemsById[t]);for(var e=[],i=0,r=this._loadQueueBackup.length;r>i;i++)e.push(this._loadQueueBackup[i].getItem());this.loadManifest(e,!1)},e.installPlugin=function(t){if(null!=t&&null!=t.getPreloadHandlers){this._plugins.push(t);var e=t.getPreloadHandlers();if(e.scope=t,null!=e.types)for(var i=0,r=e.types.length;r>i;i++)this._typeCallbacks[e.types[i]]=e;if(null!=e.extensions)for(i=0,r=e.extensions.length;r>i;i++)this._extensionCallbacks[e.extensions[i]]=e}},e.setMaxConnections=function(t){this._maxConnections=t,!this._paused&&this._loadQueue.length>0&&this._loadNext()},e.loadFile=function(t,e,i){if(null==t){var r=new createjs.ErrorEvent("PRELOAD_NO_FILE");return void this._sendError(r)}this._addItem(t,null,i),this.setPaused(e!==!1?!1:!0)},e.loadManifest=function(t,e,r){var n=null,s=null;if(t instanceof Array){if(0==t.length){var o=new createjs.ErrorEvent("PRELOAD_MANIFEST_EMPTY");return void this._sendError(o)}n=t}else if("string"==typeof t)n=[{src:t,type:i.MANIFEST}];else{if("object"!=typeof t){var o=new createjs.ErrorEvent("PRELOAD_MANIFEST_NULL");return void this._sendError(o)}if(void 0!==t.src){if(null==t.type)t.type=i.MANIFEST;else if(t.type!=i.MANIFEST){var o=new createjs.ErrorEvent("PRELOAD_MANIFEST_TYPE");this._sendError(o)}n=[t]}else void 0!==t.manifest&&(n=t.manifest,s=t.path)}for(var a=0,h=n.length;h>a;a++)this._addItem(n[a],s,r);this.setPaused(e!==!1?!1:!0)},e.load=function(){this.setPaused(!1)},e.getItem=function(t){return this._loadItemsById[t]||this._loadItemsBySrc[t]},e.getResult=function(t,e){var i=this._loadItemsById[t]||this._loadItemsBySrc[t];if(null==i)return null;var r=i.id;return e&&this._loadedRawResults[r]?this._loadedRawResults[r]:this._loadedResults[r]},e.getItems=function(t){var e=[];for(var i in this._loadItemsById){var r=this._loadItemsById[i],n=this.getResult(i);(t!==!0||null!=n)&&e.push({item:r,result:n,rawResult:this.getResult(i,!0)})}return e},e.setPaused=function(t){this._paused=t,this._paused||this._loadNext()},e.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._scriptOrder.length=0,this._loadedScripts.length=0,this.loadStartWasDispatched=!1,this._itemCount=0,this._lastProgress=0/0},e._addItem=function(t,e,i){var r=this._createLoadItem(t,e,i);if(null!=r){var n=this._createLoader(r);null!=n&&("plugins"in n&&(n.plugins=this._plugins),r._loader=n,this._loadQueue.push(n),this._loadQueueBackup.push(n),this._numItems++,this._updateProgress(),(this.maintainScriptOrder&&r.type==createjs.LoadQueue.JAVASCRIPT||r.maintainOrder===!0)&&(this._scriptOrder.push(r),this._loadedScripts.push(null)))}},e._createLoadItem=function(t,e,i){var r=createjs.LoadItem.create(t);if(null==r)return null;var n="",s=i||this._basePath;if(r.src instanceof Object){if(!r.type)return null;if(e){n=e;var o=createjs.RequestUtils.parseURI(e);null==s||o.absolute||o.relative||(n=s+n)}else null!=s&&(n=s)}else{var a=createjs.RequestUtils.parseURI(r.src);a.extension&&(r.ext=a.extension),null==r.type&&(r.type=createjs.RequestUtils.getTypeByExtension(r.ext));var h=r.src;if(!a.absolute&&!a.relative)if(e){n=e;var o=createjs.RequestUtils.parseURI(e);h=e+h,null==s||o.absolute||o.relative||(n=s+n)}else null!=s&&(n=s);r.src=n+r.src}r.path=n,(void 0===r.id||null===r.id||""===r.id)&&(r.id=h);var l=this._typeCallbacks[r.type]||this._extensionCallbacks[r.ext];if(l){var u=l.callback.call(l.scope,r,this);if(u===!1)return null;u===!0||null!=u&&(r._loader=u),a=createjs.RequestUtils.parseURI(r.src),null!=a.extension&&(r.ext=a.extension)}return this._loadItemsById[r.id]=r,this._loadItemsBySrc[r.src]=r,null==r.crossOrigin&&(r.crossOrigin=this._crossOrigin),r},e._createLoader=function(t){if(null!=t._loader)return t._loader;for(var e=this.preferXHR,i=0;i<this._availableLoaders.length;i++){var r=this._availableLoaders[i];if(r&&r.canLoadItem(t))return new r(t,e)}return null},e._loadNext=function(){if(!this._paused){this._loadStartWasDispatched||(this._sendLoadStart(),this._loadStartWasDispatched=!0),this._numItems==this._numItemsLoaded?(this.loaded=!0,this._sendComplete(),this.next&&this.next.load&&this.next.load()):this.loaded=!1;for(var t=0;t<this._loadQueue.length&&!(this._currentLoads.length>=this._maxConnections);t++){var e=this._loadQueue[t];this._canStartLoad(e)&&(this._loadQueue.splice(t,1),t--,this._loadItem(e))}}},e._loadItem=function(t){t.on("fileload",this._handleFileLoad,this),t.on("progress",this._handleProgress,this),t.on("complete",this._handleFileComplete,this),t.on("error",this._handleError,this),t.on("fileerror",this._handleFileError,this),this._currentLoads.push(t),this._sendFileStart(t.getItem()),t.load()},e._handleFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleFileError=function(t){var e=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,t.item);this._sendError(e)},e._handleError=function(t){var e=t.target;this._numItemsLoaded++,this._finishOrderedItem(e,!0),this._updateProgress();var i=new createjs.ErrorEvent("FILE_LOAD_ERROR",null,e.getItem());this._sendError(i),this.stopOnError?this.setPaused(!0):(this._removeLoadItem(e),this._cleanLoadItem(e),this._loadNext())},e._handleFileComplete=function(t){var e=t.target,i=e.getItem(),r=e.getResult();this._loadedResults[i.id]=r;var n=e.getResult(!0);null!=n&&n!==r&&(this._loadedRawResults[i.id]=n),this._saveLoadedItems(e),this._removeLoadItem(e),this._finishOrderedItem(e)||this._processFinishedLoad(i,e),this._cleanLoadItem(e)},e._saveLoadedItems=function(t){var e=t.getLoadedItems();if(null!==e)for(var i=0;i<e.length;i++){var r=e[i].item;this._loadItemsBySrc[r.src]=r,this._loadItemsById[r.id]=r,this._loadedResults[r.id]=e[i].result,this._loadedRawResults[r.id]=e[i].rawResult}},e._finishOrderedItem=function(t,e){var i=t.getItem();if(this.maintainScriptOrder&&i.type==createjs.LoadQueue.JAVASCRIPT||i.maintainOrder){t instanceof createjs.JavaScriptLoader&&(this._currentlyLoadingScript=!1);var r=createjs.indexOf(this._scriptOrder,i);return-1==r?!1:(this._loadedScripts[r]=e===!0?!0:i,this._checkScriptLoadOrder(),!0)}return!1},e._checkScriptLoadOrder=function(){for(var t=this._loadedScripts.length,e=0;t>e;e++){var i=this._loadedScripts[e];if(null===i)break;if(i!==!0){var r=this._loadedResults[i.id];i.type==createjs.LoadQueue.JAVASCRIPT&&createjs.DomUtils.appendToHead(r);var n=i._loader;this._processFinishedLoad(i,n),this._loadedScripts[e]=!0}}},e._processFinishedLoad=function(t,e){this._numItemsLoaded++,this.maintainScriptOrder||t.type!=createjs.LoadQueue.JAVASCRIPT||createjs.DomUtils.appendToHead(t.result),this._updateProgress(),this._sendFileComplete(t,e),this._loadNext()},e._canStartLoad=function(t){if(!this.maintainScriptOrder||t.preferXHR)return!0;var e=t.getItem();if(e.type!=createjs.LoadQueue.JAVASCRIPT)return!0;if(this._currentlyLoadingScript)return!1;for(var i=this._scriptOrder.indexOf(e),r=0;i>r;){var n=this._loadedScripts[r];if(null==n)return!1;r++}return this._currentlyLoadingScript=!0,!0},e._removeLoadItem=function(t){for(var e=this._currentLoads.length,i=0;e>i;i++)if(this._currentLoads[i]==t){this._currentLoads.splice(i,1);break}},e._cleanLoadItem=function(t){var e=t.getItem();e&&delete e._loader},e._handleProgress=function(t){var e=t.target;this._sendFileProgress(e.getItem(),e.progress),this._updateProgress()},e._updateProgress=function(){var t=this._numItemsLoaded/this._numItems,e=this._numItems-this._numItemsLoaded;if(e>0){for(var i=0,r=0,n=this._currentLoads.length;n>r;r++)i+=this._currentLoads[r].progress;t+=i/e*(e/this._numItems)}this._lastProgress!=t&&(this._sendProgress(t),this._lastProgress=t)},e._disposeItem=function(t){delete this._loadedResults[t.id],delete this._loadedRawResults[t.id],delete this._loadItemsById[t.id],delete this._loadItemsBySrc[t.src]},e._sendFileProgress=function(t,e){if(!this._isCanceled()&&!this._paused&&this.hasEventListener("fileprogress")){var i=new createjs.Event("fileprogress");i.progress=e,i.loaded=e,i.total=1,i.item=t,this.dispatchEvent(i)}},e._sendFileComplete=function(t,e){if(!this._isCanceled()&&!this._paused){var i=new createjs.Event("fileload");i.loader=e,i.item=t,i.result=this._loadedResults[t.id],i.rawResult=this._loadedRawResults[t.id],t.completeHandler&&t.completeHandler(i),this.hasEventListener("fileload")&&this.dispatchEvent(i)}},e._sendFileStart=function(t){var e=new createjs.Event("filestart");e.item=t,this.hasEventListener("filestart")&&this.dispatchEvent(e)},e.toString=function(){return"[PreloadJS LoadQueue]"},createjs.LoadQueue=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.TEXT)}var e=(createjs.extend(t,createjs.AbstractLoader),t);e.canLoadItem=function(t){return t.type==createjs.AbstractLoader.TEXT},createjs.TextLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.BINARY),this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.BINARY},e._updateXHR=function(t){t.loader.setResponseType("arraybuffer")},createjs.BinaryLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.CSS),this.resultFormatter=this._formatResult,this._tagSrcAttribute="href",this._tag=document.createElement(e?"style":"link"),this._tag.rel="stylesheet",this._tag.type="text/css"}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.CSS},e._formatResult=function(t){if(this._preferXHR){var e=t.getTag();if(e.styleSheet)e.styleSheet.cssText=t.getResult(!0);else{var i=document.createTextNode(t.getResult(!0));e.appendChild(i)}}else e=this._tag;return createjs.DomUtils.appendToHead(e),e},createjs.CSSLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.IMAGE),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",createjs.RequestUtils.isImageTag(t)?this._tag=t:createjs.RequestUtils.isImageTag(t.src)?this._tag=t.src:createjs.RequestUtils.isImageTag(t.tag)&&(this._tag=t.tag),null!=this._tag?this._preferXHR=!1:this._tag=document.createElement("img"),this.on("initialize",this._updateXHR,this)}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.IMAGE},e.load=function(){if(""!=this._tag.src&&this._tag.complete)return void this._sendComplete();var t=this._item.crossOrigin;1==t&&(t="Anonymous"),null==t||createjs.RequestUtils.isLocal(this._item.src)||(this._tag.crossOrigin=t),this.AbstractLoader_load()},e._updateXHR=function(t){t.loader.mimeType="text/plain; charset=x-user-defined-binary",t.loader.setResponseType&&t.loader.setResponseType("blob")},e._formatResult=function(t){var e=this;return function(i){var r=e._tag,n=window.URL||window.webkitURL;if(e._preferXHR)if(n){var s=n.createObjectURL(t.getResult(!0));r.src=s,r.onload=function(){n.revokeObjectURL(e.src)}}else r.src=t.getItem().src;r.complete?i(r):r.onload=function(){i(this)}}},createjs.ImageLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.JAVASCRIPT),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src",this.setTag(document.createElement("script"))}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JAVASCRIPT},e._formatResult=function(t){var e=t.getTag();return this._preferXHR&&(e.text=t.getResult(!0)),e},createjs.JavaScriptLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.JSON),this.resultFormatter=this._formatResult}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JSON&&!t._loadAsJSONP},e._formatResult=function(t){var e=null;try{e=createjs.DataUtils.parseJSON(t.getResult(!0))}catch(i){var r=new createjs.ErrorEvent("JSON_FORMAT",null,i);return this._sendError(r),i}return e},createjs.JSONLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!1,createjs.AbstractLoader.JSONP),this.setTag(document.createElement("script")),this.getTag().type="text/javascript"}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.JSONP||t._loadAsJSONP},e.cancel=function(){this.AbstractLoader_cancel(),this._dispose()},e.load=function(){if(null==this._item.callback)throw new Error("callback is required for loading JSONP requests.");if(null!=window[this._item.callback])throw new Error("JSONP callback '"+this._item.callback+"' already exists on window. You need to specify a different callback or re-name the current one.");window[this._item.callback]=createjs.proxy(this._handleLoad,this),window.document.body.appendChild(this._tag),this._loadTimeout=setTimeout(createjs.proxy(this._handleTimeout,this),this._item.loadTimeout),this._tag.src=this._item.src},e._handleLoad=function(t){this._result=this._rawResult=t,this._sendComplete(),this._dispose()},e._handleTimeout=function(){this._dispose(),this.dispatchEvent(new createjs.ErrorEvent("timeout"))},e._dispose=function(){window.document.body.removeChild(this._tag),delete window[this._item.callback],clearTimeout(this._loadTimeout)},createjs.JSONPLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,null,createjs.AbstractLoader.MANIFEST),this.plugins=null,this._manifestQueue=null}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.MANIFEST_PROGRESS=.25,i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.MANIFEST},e.load=function(){this.AbstractLoader_load()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.MANIFEST_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.MANIFEST_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e.destroy=function(){this.AbstractLoader_destroy(),this._manifestQueue.close()},e._loadManifest=function(t){if(t&&t.manifest){var e=this._manifestQueue=new createjs.LoadQueue;e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("complete",this._handleManifestComplete,this,!0),e.on("error",this._handleManifestError,this,!0);for(var i=0,r=this.plugins.length;r>i;i++)e.installPlugin(this.plugins[i]);e.loadManifest(t)}else this._sendComplete()},e._handleManifestFileLoad=function(t){t.target=null,this.dispatchEvent(t)},e._handleManifestComplete=function(){this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.MANIFEST_PROGRESS)+i.MANIFEST_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new createjs.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},createjs.ManifestLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(t)?this._tag=t:createjs.RequestUtils.isAudioTag(t.src)?this._tag=t:createjs.RequestUtils.isAudioTag(t.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(t)?t:t.src),null!=this._tag&&(this._preferXHR=!1)}var e=createjs.extend(t,createjs.AbstractMediaLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SOUND},e._createTag=function(t){var e=document.createElement("audio");return e.autoplay=!1,e.preload="none",e.src=t,e},createjs.SoundLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractMediaLoader_constructor(t,e,createjs.AbstractLoader.VIDEO),createjs.RequestUtils.isVideoTag(t)||createjs.RequestUtils.isVideoTag(t.src)?(this.setTag(createjs.RequestUtils.isVideoTag(t)?t:t.src),this._preferXHR=!1):this.setTag(this._createTag())}var e=createjs.extend(t,createjs.AbstractMediaLoader),i=t;e._createTag=function(){return document.createElement("video")},i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.VIDEO},createjs.VideoLoader=createjs.promote(t,"AbstractMediaLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,null,createjs.AbstractLoader.SPRITESHEET),this._manifestQueue=null}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.SPRITESHEET_PROGRESS=.25,i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SPRITESHEET},e.destroy=function(){this.AbstractLoader_destroy,this._manifestQueue.close()},e._createRequest=function(){var t=this._item.callback;this._request=null!=t&&t instanceof Function?new createjs.JSONPLoader(this._item):new createjs.JSONLoader(this._item)},e.handleEvent=function(t){switch(t.type){case"complete":return this._rawResult=t.target.getResult(!0),this._result=t.target.getResult(),this._sendProgress(i.SPRITESHEET_PROGRESS),void this._loadManifest(this._result);case"progress":return t.loaded*=i.SPRITESHEET_PROGRESS,this.progress=t.loaded/t.total,(isNaN(this.progress)||1/0==this.progress)&&(this.progress=0),void this._sendProgress(t)}this.AbstractLoader_handleEvent(t)},e._loadManifest=function(t){if(t&&t.images){var e=this._manifestQueue=new createjs.LoadQueue;e.on("complete",this._handleManifestComplete,this,!0),e.on("fileload",this._handleManifestFileLoad,this),e.on("progress",this._handleManifestProgress,this),e.on("error",this._handleManifestError,this,!0),e.loadManifest(t.images)}},e._handleManifestFileLoad=function(t){var e=t.result;if(null!=e){var i=this.getResult().images,r=i.indexOf(t.item.src);i[r]=e}},e._handleManifestComplete=function(){this._result=new createjs.SpriteSheet(this._result),this._loadedItems=this._manifestQueue.getItems(!0),this._sendComplete()},e._handleManifestProgress=function(t){this.progress=t.progress*(1-i.SPRITESHEET_PROGRESS)+i.SPRITESHEET_PROGRESS,this._sendProgress(this.progress)},e._handleManifestError=function(t){var e=new createjs.Event("fileerror");e.item=t.data,this.dispatchEvent(e)},createjs.SpriteSheetLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t,e){this.AbstractLoader_constructor(t,e,createjs.AbstractLoader.SVG),this.resultFormatter=this._formatResult,this._tagSrcAttribute="data",e?this.setTag(document.createElement("svg")):(this.setTag(document.createElement("object")),this.getTag().type="image/svg+xml")}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.SVG},e._formatResult=function(t){var e=createjs.DataUtils.parseXML(t.getResult(!0),"text/xml"),i=t.getTag();return!this._preferXHR&&document.body.contains(i)&&document.body.removeChild(i),null!=e.documentElement?(i.appendChild(e.documentElement),i.style.visibility="visible",i):e},createjs.SVGLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){"use strict";function t(t){this.AbstractLoader_constructor(t,!0,createjs.AbstractLoader.XML),this.resultFormatter=this._formatResult}var e=createjs.extend(t,createjs.AbstractLoader),i=t;i.canLoadItem=function(t){return t.type==createjs.AbstractLoader.XML},e._formatResult=function(t){return createjs.DataUtils.parseXML(t.getResult(!0),"text/xml")},createjs.XMLLoader=createjs.promote(t,"AbstractLoader")}(),function(){"use strict";var t,e;t=function(){},e=t,e.getPreloadHandlers=function(){return{callback:e.preloadHandler,types:["binary","image","javascript","json","jsonp","sound","video","svg","text","xml"]}},e.preloadHandler=function(t,e){var i,r,n,s,o,a,h;return a="undefined"!=typeof app&&null!==app&&null!=(h=app.config)?h.views:void 0,o=null!=a?a[e.id]:void 0,n=null!=a?a[null!=o?o.parentView:void 0]:void 0,r=!1,null!=t.cache?t.cache===!1&&(r=!0):null!=(null!=o?o.cache:void 0)?(null!=o?o.cache:void 0)===!1&&(r=!0):null!=(null!=n?n.cache:void 0)&&(null!=n?n.cache:void 0)===!1&&(r=!0),-1===t.src.indexOf("?v=")&&(s=(new Date).getTime(),i=r?"?v="+app.getInfo().version+"&noCache="+s:"?v="+app.getInfo().version,t.src+=i),!0},createjs.CacheControllerPlugin=t}(),this.createjs=this.createjs||{},function(){var t,e,i;t=function(t,e,i){this.fullBuffer=t.fullBuffer,this.AbstractRequest_constructor(t),this._tag=e,this._tagSrcAttribute=i,this._complete=createjs.proxy(this._handleTagComplete,this)},e=createjs.extend(t,createjs.TagRequest),i=t,e.load=function(){var t,e,i,r;e=createjs.proxy(this._handleProgress,this),this._handleProgress=e,i=createjs.proxy(this._handleStalled,this),this._handleStalled=i,t=createjs.proxy(this._handleError,this),this._handleError=t,r=createjs.proxy(this._handleTimeout,this),this._handleTimeout=r,this.____timer=setInterval(e,10),this._tag.addEventListener?(this._tag.addEventListener("progress",e),this._tag.addEventListener("stalled",i),this._tag.addEventListener("error",t)):(this._tag.onprogress=e,this._tag.onstalled=i,this._tag.onerror=t),this.fullBuffer||void 0===this.fullBuffer?this._tag.addEventListener?(this._tag.addEventListener("ended",this._complete,!1),this._tag.addEventListener("complete",this._complete,!1)):this._tag.onended=this._tag.oncomplete=this._complete:this._tag.addEventListener?this._tag.addEventListener("canplaythrough",this._complete,!1):this._tag.oncanplaythrough=this._complete,this.TagRequest_load()},e._handleTimeout=function(){},e._handleStalled=function(){},e._handleError=function(t){var e;try{throw console.log(t.data),new Error(t.title)}catch(i){return e=i,console.log(e.stack)}},e._handleProgress=function(){var t,e,i;try{e=this._tag.buffered.end(this._tag.buffered.length-1),i=this._tag.duration,this._tag.currentTime=e,this.dispatchEvent(new createjs.ProgressEvent(e,i))}catch(r){t=r}Math.round(e)>=Math.round(i)&&this._complete()},e.destroy=function(){this.TagRequest_destroy()},e._handleTagComplete=function(){this.TagRequest__handleTagComplete()},e._clean=function(){var t,e,i,r;try{e=this._tag.buffered.end(this._tag.buffered.length-1),i=this._tag.duration}catch(n){t=n}Math.round(e)>=Math.round(i)&&(clearInterval(this.____timer),this.____timer=null,this._tag.removeEventListener?(this._tag.removeEventListener("progress",this._handleProgress),this._tag.removeEventListener("stalled",this._handleStalled),this._tag.removeEventListener("error",this._handleError),this._tag.removeEventListener("ended",this._complete),this._tag.removeEventListener("complete",this._complete),this._tag.removeEventListener("canplaythrough",this._complete)):(this._tag.onended=null,this._tag.oncanplaythrough=null,this._tag.onprogress=null,this._tag.onstalled=null,this._tag.onerror=null),null!=(r=this._tag)&&(r.currentTime=1e-4),this.TagRequest__clean())},createjs.MediaRequest=createjs.promote(t,"TagRequest")}(),this.createjs=this.createjs||{},function(){var t,e;t=function(t,e,i){this.AbstractLoader_constructor(t,e,i),this.resultFormatter=this._formatResult,this._tagSrcAttribute="src"},e=createjs.extend(t,createjs.AbstractLoader),e.load=function(){this._tag||(this._tag=this._createTag(this._item.src)),this._tag.preload="auto",this._tag.load(),this.AbstractLoader_load()},e._createTag=function(){},e._createRequest=function(){this._request=new createjs.MediaRequest(this._item,this._tag||this._createTag(),this._tagSrcAttribute)},e._formatResult=function(t){return this._tag.removeEventListener&&this._tag.removeEventListener("complete",this._loadedHandler),this._tag.removeEventListener&&this._tag.removeEventListener("canplaythrough",this._loadedHandler),this._tag.onstalled=null,this._preferXHR&&(t.getTag().src=t.getResult(!0)),t.getTag()},createjs.TagMediaLoader=createjs.promote(t,"AbstractLoader")}(),this.createjs=this.createjs||{},function(){var t,e,i;t=function(t,e){this.___item=t,"video"===t.type?(this.TagMediaLoader_constructor(t,e,createjs.AbstractLoader.VIDEO),createjs.RequestUtils.isVideoTag(t)||createjs.RequestUtils.isVideoTag(t.src)?(this.setTag(createjs.RequestUtils.isVideoTag(t)?t:t.src),this._preferXHR=!1):this.setTag(this._createTag())):(this.TagMediaLoader_constructor(t,e,createjs.AbstractLoader.SOUND),createjs.RequestUtils.isAudioTag(t)?this._tag=t:createjs.RequestUtils.isAudioTag(t.src)?this._tag=t:createjs.RequestUtils.isAudioTag(t.tag)&&(this._tag=createjs.RequestUtils.isAudioTag(t)?t:t.src),null!==this._tag&&(this._preferXHR=!1))},i=t,e=createjs.extend(t,createjs.TagMediaLoader),e._createTag=function(t){var e;return"video"===this.___item.type?(e=document.createElement("video"),e.type="video/mp4",e.preload="auto"):(e=document.createElement("audio"),e.type="audio/mpeg",e.preload="none",e.src=t),null!=this.___item.id&&(e.id=this.___item.id),e.autoplay=this.___item.autoplay&&void 0!==this.___item.autoplay?this.___item.autoplay:!1,e.loop=this.___item.loop&&void 0!==this.___item.loop?this.___item.loop:!1,e.volume=this.___item.volume&&void 0!==this.___item.volume?this.___item.volume:1,e},i.canLoadItem=function(t){return"video"===this.___item.type?t.type===createjs.AbstractLoader.VIDEO:t.type===createjs.AbstractLoader.SOUND},createjs.MediaLoader=createjs.promote(t,"TagMediaLoader")}(),function(){"use strict";var t,e;t=function(){},e=t,e.getPreloadHandlers=function(){return{callback:t.handlers,types:["sound","video"],extensions:["mp3","mp4"]}},e.handlers=function(t){var e;return e=new createjs.MediaLoader(t,!1)},createjs.MediaPlugin=t}();var AssetLoader;AssetLoader=function(t){function e(){this._fileLoad=__bind(this._fileLoad,this),this._onFileError=__bind(this._onFileError,this),this._onError=__bind(this._onError,this),this._groups={}
}return __extends(e,t),e.INITIALIZE="initialize",e.COMPLETE_ALL="complete",e.COMPLETE_FILE="fileload",e.PROGRESS_ALL="progress",e.PROGRESS_FILE="fileprogress",e.START_ALL="loadstart",e.START_FILE="filestart",e.ERROR="error",e.FILE_ERROR="fileerror",e.getInstance=function(){return null!=e._instance?e._instance:e._instance=function(t,e,i){i.prototype=t.prototype;var r=new i,n=t.apply(r,e);return Object(n)===n?n:r}(e,arguments,function(){})},e.prototype._groups=null,e.prototype.loadGroup=function(t,e){var i;return i=this.getGroup(t),i.loadManifest(e),i},e.prototype.getGroup=function(t,i,r){var n;return null==i&&(i=3),null==r&&(r=!0),n=this._groups[t],n||(n=new createjs.LoadQueue(r),n.installPlugin(createjs.CacheControllerPlugin),n.installPlugin(createjs.MediaPlugin),n.id=t,this._groups[t]=n,n.on(e.COMPLETE_FILE,this._fileLoad),n.on(e.ERROR,this._onError),n.on(e.FILE_ERROR,this._onFileError)),n.setMaxConnections(i),n},e.prototype.preferXHR=function(t,e){var i;return null==e&&(e=!0),i=this.getGroup(t).setPreferXHR=e},e.prototype._onError=function(t){throw t.currentTarget.off(e.ERROR,this._onError),t.currentTarget.off(e.COMPLETE_FILE,this._fileLoad),console.log(t),new Error(t.title).stack},e.prototype._onFileError=function(t){throw t.currentTarget.off(e.FILE_ERROR,this._onFileError),t.currentTarget.off(e.COMPLETE_FILE,this._fileLoad),console.log(t),new Error(t.title).stack},e.prototype._fileLoad=function(t){return t.currentTarget.off(e.COMPLETE_FILE,this._fileLoad),t.currentTarget.off(e.ERROR,this._onError),t.currentTarget.off(e.FILE_ERROR,this._onFileError),t.item.tag=t.result,!1},e.prototype.getItem=function(t,e){var i,r,n,s,o;if(null==e&&(e=null),e)return null!=(s=this._groups[e])?s.getItem(t):void 0;o=this._groups;for(r in o)if(n=o[r],i=n.getItem(t))return i},e.prototype.getResult=function(t,e){var i,r,n,s,o,a;null==e&&(e=null),n=null,e&&(n=null!=(o=this._groups[e])?o.getResult(t):void 0),a=this._groups;for(r in a)s=a[r],(i=s.getResult(t))&&(n=i);return n},e.addFiles=function(t,e){var i,r,n,s,o,a;for(r=/.*\.(js|css|svg)$/g,n=/.*\.(mp4)$/g,o=0,a=t.length;a>o;o++)i=t[o],s={id:"",src:""},r.lastIndex=0,s.id=i.id||"item",s.src=i.src,n.test(s.src)&&(s.type="video"),i.src&&r.test(i.src)&&(s.type="text"),s.src&&e.loadFile(s,!1);return t.length>0&&e.load(),!1},e}(EventDispatcher);var BaseDOM,__slice=[].slice;Node.prototype.__appendChild__=Node.prototype.appendChild,Node.prototype.appendChild=function(t){var e;return e=t,t instanceof BaseDOM&&(e=t.element,t.parent=this),Node.prototype.__appendChild__.call(this,e)},Node.prototype.__removeChild__=Node.prototype.removeChild,Node.prototype.removeChild=function(t){var e;e=t,t instanceof BaseDOM&&(e=t.element,t.parent=this);try{return this.__removeChild__.call(this,e)}catch(i){}},Element.prototype.matches=Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector,Node.prototype.findParents=function(t){var e;return null!=(null!=(e=this.parentNode)?e.matches:void 0)?this.parentNode.matches(t)?this.parentNode:this.parentNode.findParents(t):null},BaseDOM=function(t){function e(){var t,i,r,n,s,o;if(o=1<=arguments.length?__slice.call(arguments,0):[],e.__super__.constructor.apply(this,arguments),i="div",t=null,n=null,"string"==typeof o[0]||o[0]instanceof HTMLElement)i=o[0];else for(r=o.length;r--;)s=o[r],null!=s.element&&(i=s.element),null!=s.className&&(t=s.className),null!=s.namespace&&(n=s.namespace);"string"==typeof i?n?(this._namespace=n,this._element=document.createElementNS(this._namespace,i)):this._element=document.createElement(i):i instanceof HTMLElement&&(this._element=i),t&&this.addClass(t),this._element.__instance__=this}return __extends(e,t),e.get({element:function(){return this._element}}),e.get({namespace:function(){return this._namespace}}),e.get({childNodes:function(){return this.element.childNodes}}),e.get({width:function(){return this.getBounds().width}}),e.get({height:function(){return this.getBounds().height}}),e.get({left:function(){return this.getBounds().left}}),e.get({top:function(){return this.getBounds().top}}),e.get({x:function(){return this.getBounds().left}}),e.get({y:function(){return this.getBounds().top}}),e.get({parent:function(){return this._parent}}),e.set({parent:function(t){if(!(t instanceof e||t instanceof Node))throw new Error("Parent instance is not either Node or BaseDOM");return this._parent=t}}),e.get({className:function(){return this.element.className}}),e.set({className:function(t){return this.element.className=t.trim()}}),e.get({text:function(){return this.html}}),e.set({text:function(t){return this.html=t}}),e.get({html:function(){return this.element.innerHTML}}),e.set({html:function(t){return this.element.innerHTML=t}}),e.get({isAttached:function(){return("function"==typeof document.contains?document.contains(this.element):void 0)||document.body.contains(this.element)}}),e.get({attributes:function(){return this.element.attributes}}),e.prototype.appendChild=function(t){return this.appendChildAt(t)},e.prototype.appendChildAt=function(t,i){var r;return null==i&&(i=-1),r=t,t instanceof e&&(r=t.element),-1===i||i>=this.childNodes.length?this.element.appendChild(r):this.element.insertBefore(r,this.childNodes[i]),t instanceof e&&(t.parent=this),t},e.prototype.remove=function(){var t;return null!=(t=this.parent)&&"function"==typeof t.removeChild?t.removeChild(this):void 0},e.prototype.removeChild=function(t){var i;i=t,t instanceof e&&(i=t.element);try{return this.element.removeChild(i)}catch(r){}},e.prototype.removeChildAt=function(t){return null==t&&(t=-1),t<this.childNodes.length?this.removeChild(this.childNodes[i]):void 0},e.prototype.removeAll=function(){var t,e,i;for(t=this.childNodes,e=t.length,i=[];e-->0;)i.push(this.removeChild(t[e]));return i},e.prototype.matches=function(t){return this.element.matches(t)},e.prototype.findParents=function(t){return this.element.findParents(t)},e.prototype.find=function(t,e){var i;return null==e&&(e=!1),i=this.element.querySelector(t),e?null!=i?i.__instance__:void 0:i},e.prototype.findAll=function(t,e){var i,r,n,s,o;if(null==e&&(e=!1),i=this.element.querySelectorAll(t),e){for(r=[],n=-1,s=i.length,o=0;++n<s;)i[n].__instance__&&(r[o++]=i[n].__instance__);i=r}return i},e.prototype.attr=function(t,e,i){var r,n,s;if(null==e&&(e="nonenonenone"),null==i&&(i=!1),"string"==typeof t)return this._attr(t,e,i);if("object"==typeof t){s=[];for(r in t)n=t[r],s.push(this._attr(r,n,i));return s}},e.prototype._attr=function(t,e,i){return null==e&&(e="nonenonenone"),null==i&&(i=!1),i===!1&&(i=this.namespace),"nonenonenone"!==e&&(i?this.element.setAttributeNS(i,t,e):this.element.setAttribute(t,e)),i?this.element.getAttributeNS(i,t):this.element.getAttribute(t)},e.prototype._css=function(t,e){return null==e&&(e=null),null!==e&&(this.element.style[t]=e),this.element.style[t]},e.prototype.css=function(t,e){var i,r,n;if(null==e&&(e=null),"string"==typeof t)return this._css(t,e);if("object"==typeof t){n=[];for(i in t)r=t[i],n.push(this._css(i,r));return n}},e.prototype.addClass=function(t){var e,i,r;if("string"==typeof t)t=t.replace(/\s+/gi," ").split(" ");else if("Array"!=typeof t)return;for(e=this.className.replace(/\s+/gi," ").split(" "),r=e.length,i=t.length;i-->0;)e.indexOf(t[i])>=0||(e[r++]=t[i]);return this.className=e.join(" ")},e.prototype.removeClass=function(t){var e,i,r;if("string"==typeof t)t=t.replace(/\s+/gi," ").split(" ");else if("Array"!=typeof t)return;for(e=this.className.replace(/\s+/gi," ").split(" "),i=t.length;i-->0;)(r=e.indexOf(t[i]))>=0&&e.splice(r,1);return this.className=e.join(" ")},e.prototype.toggleClass=function(t,e){var i,r;if(null==e&&(e=null),null!==e)return void(e?this.addClass(t):this.removeClass(t));if("string"==typeof t)t=t.replace(/\s+/gi," ").split(" ");else if("Array"!=typeof t)return;for(i=t.length,r=[];i-->0;)r.push(this.hasClass(t[i])?this.removeClass(t[i]):this.addClass(t[i]));return r},e.prototype.hasClass=function(t){var e,i,r;if("string"==typeof t)t=t.replace(/\s+/gi," ").split(" ");else if("Array"!=typeof t)return;for(e=this.className.replace(/\s+/gi," ").split(" "),r=t.length,i=!0;r-->0;)i&=e.indexOf(t[r])>=0;return i},e.prototype.getBounds=function(t){var i,r,n,s,o;null==t&&(t=null),r={},i=this.element.getBoundingClientRect();for(n in i)o=i[n],r[n]=o;return t&&(t instanceof e?s=t.getBounds():t instanceof HTMLElement&&(s=t.getBoundingClientRect())),s&&(r.top-=s.top,r.left-=s.left,r.bottom-=s.top,r.right-=s.left),r.width=r.right-r.left,r.height=r.bottom-r.top,r},e.prototype.destroy=function(){return"function"==typeof this.off&&this.off(),"function"==typeof this.remove?this.remove():void 0},e}(EventDispatcher);var BaseView;BaseView=function(t){function e(t,i){null==t&&(t=null),null==i&&(i=null),this.destroyComplete=__bind(this.destroyComplete,this),this.destroy=__bind(this.destroy,this),this.hideComplete=__bind(this.hideComplete,this),this.hide=__bind(this.hide,this),this.hideStart=__bind(this.hideStart,this),this.showComplete=__bind(this.showComplete,this),this.show=__bind(this.show,this),this.showStart=__bind(this.showStart,this),this.createComplete=__bind(this.createComplete,this),this.create=__bind(this.create,this),this.createStart=__bind(this.createStart,this),this.getReverseParentList=__bind(this.getReverseParentList,this),this._created=!1,this._data=t?t:{},this._id=null!=this._data.id?this._data.id:void 0,this._content=null!=this._data.content?this._data.content:void 0,this._route=null!=this._data.route?this._data.route:void 0,this._parent=null!=this._data.parent?this._data.parent:void 0,this._subviews=null!=this._data.subviews?this._data.subviews:void 0,this._destroyable=null!=this._data.destroyable?this._data.destroyable:void 0,e.__super__.constructor.call(this,{element:"div",className:i+"-view"})}return __extends(e,t),e.CREATE_START="create_start",e.CREATE="create",e.CREATE_COMPLETE="create_complete",e.SHOW_START="show_start",e.SHOW="show",e.SHOW_COMPLETE="show_complete",e.HIDE_START="hide_start",e.HIDE="hide",e.HIDE_COMPLETE="hide_complete",e.DESTROY="destroy",e.DESTROY_COMPLETE="destroy_complete",e.get({data:function(){return this._data}}),e.set({data:function(t){return this._data=ObjectUtils.clone(t)}}),e.get({id:function(){return this._id}}),e.set({id:function(t){return this._id=t}}),e.get({content:function(){return this._content}}),e.set({content:function(t){return this._content=t}}),e.get({route:function(){return this._route}}),e.set({route:function(t){return this._route=t}}),e.get({parent:function(){return this._parent}}),e.set({parent:function(t){return this._parent=t}}),e.get({loader:function(){var t;return null!=this._id&&"undefined"!=typeof app&&null!==app&&null!=(t=app.loader)?t.getGroup(this.id):void 0}}),e.get({created:function(){return this._created}}),e.get({subviews:function(){return this._subviews}}),e.set({subviews:function(t){return this._subviews=t}}),e.get({destroyable:function(){return this._destroyable}}),e.set({destroyable:function(t){return this._destroyable=t}}),e.get({type:function(){return this._type}}),e.set({type:function(t){return this._type=t}}),e.get({meta:function(){var t;return null!=(null!=(t=this.content)?t.meta:void 0)?this.content.meta:void 0}}),e.set({meta:function(t){return this._meta=t}}),e.get({progress:function(){return this._progress}}),e.set({progress:function(t){return this._progress=t}}),e.get({openedSubview:function(){return this._openedSubviewID}}),e.set({openedSubview:function(t){return this._openedSubviewID=t}}),e.get({reverseParentPath:function(){return this.getReverseParentList(this),this._parentPath.reverse()}}),e.get({parentPath:function(){return this.getReverseParentList(this),this._parentPath}}),e.prototype.getReverseParentList=function(t){return null==t&&(t=null),this._parentPath=[],null!=(null!=t?t.parent:void 0)&&(this.getReverseParentList(t.parent),this._parentPath.push(t.id)),!1},e.prototype.createStart=function(t){return null==t&&(t=null),this.trigger(e.CREATE_START,this),this.create(),!1},e.prototype.create=function(t){return null==t&&(t=null),this.trigger(e.CREATE,this),this.createComplete(),!1},e.prototype.createComplete=function(t){return null==t&&(t=null),this._created=!0,this.trigger(e.CREATE_COMPLETE,this),!1},e.prototype.showStart=function(t){return null==t&&(t=null),this.trigger(e.SHOW_START,this),this.show(),!1},e.prototype.show=function(t){return null==t&&(t=null),this.trigger(e.SHOW,this),this.showComplete(),!1},e.prototype.showComplete=function(t){return null==t&&(t=null),this.trigger(e.SHOW_COMPLETE,this),!1},e.prototype.hideStart=function(t){return null==t&&(t=null),this.trigger(e.HIDE_START,this),this.hide(),!1},e.prototype.hide=function(t){return null==t&&(t=null),this.trigger(e.HIDE,this),this.hideComplete(),!1},e.prototype.hideComplete=function(t){return null==t&&(t=null),this.trigger(e.HIDE_COMPLETE,this),!1},e.prototype.destroy=function(t){var i;return null==t&&(t=null),this.removeAll(),null!=(i=this._parentPath)&&(i.length=0),this._parentPath=null,this._data=null,this.trigger(e.DESTROY,this),this.destroyComplete(),!1},e.prototype.destroyComplete=function(t){return null==t&&(t=null),this._created=!1,this.trigger(e.DESTROY_COMPLETE,this),this.off(),!1},e}(BaseDOM);var TemplateNode;TemplateNode=function(_super){function TemplateNode(t){this.nodeData=t,this._id=this.nodeData.id,this._external=this.nodeData.external,this._use=this.nodeData.use,this._attributes=this.nodeData.attributes,this._element=this.nodeData.element,this._content=this.nodeData.content,this._condition=this.nodeData.condition,this._conditionData=this.nodeData.conditionData,this._children=[],this._contextSelector=this.nodeData.contextSelector,this._parseNode(this.nodeData)}return __extends(TemplateNode,_super),TemplateNode.get({id:function(){return this._id}}),TemplateNode.get({external:function(){return this._external}}),TemplateNode.get({use:function(){return this._use}}),TemplateNode.get({attributes:function(){return this._attributes}}),TemplateNode.get({element:function(){return this._element}}),TemplateNode.get({content:function(){return this._content}}),TemplateNode.get({condition:function(){return this._condition}}),TemplateNode.get({children:function(){return this._children}}),TemplateNode.set({children:function(t){return this._children=t}}),TemplateNode.prototype._parseNode=function(){},TemplateNode.prototype.find=function(t,e){var i,r,n,s,o,a,h,l,u,c,d,_;for(null==t&&(t=null),null==e&&(e=null),r=null,c=this._children,a=0,l=c.length;l>a;a++)if(i=c[a],!t||i.element===t){if(e){n=!0;for(s in e)o=e[s],(!i.attributes[s]||(null!=(d=i.attributes[s])?d.indexOf(o):void 0)<0)&&(n=!1);if(!n)continue}r=i;break}if(!r)for(_=this._children,h=0,u=_.length;u>h&&(i=_[h],!(r=i.find(t,e)));h++);return r},TemplateNode.prototype.clear=function(){var t,e;for(t=this._childContext.childNodes,e=[];this._childContext.childNodes.length;)e.push(this._childContext.removeChild(this._childContext.childNodes[0]));return e},TemplateNode.prototype.render=function(context,data,originalData,ignoreUse){var attrs,cData,childContext,e,foundData,initialData,k,o,v,_i,_len;if(null==originalData&&(originalData=null),null==ignoreUse&&(ignoreUse=!1),!originalData&&data&&(originalData=data),null==this._condition||null==this._conditionData||(cData=this._conditionData,cData=cData.replace(/\#\{(.*?)\}/gi,"data['$1']"),eval(cData))){if(initialData=data,context.data=data,this.originalData=originalData,foundData=data,!ignoreUse&&this._use&&(o=/([\*\@])?(.*?)$/.exec(this._use))){if(foundData=this._findObjectData(foundData,this._use),null==foundData)return;Array.isArray(foundData)||"object"==typeof foundData?(data=foundData,this._content=""):this._content=foundData}if(this._contextSelector&&(context=(context||document.body).querySelector(this._contextSelector)),this.data=data,context.data=data,Array.isArray(data)||Array.isArray(initialData)||data instanceof String||initialData instanceof String||(initialData=ObjectUtils.merge(initialData,data)),childContext=context,this._element&&(childContext=document.createElement(this._element),context.appendChild(childContext),childContext.templateNode=this),this._content&&(childContext.innerHTML=this._replaceData(this._content,data)),this._attributes){attrs=this._replaceData(this._attributes,initialData);for(k in attrs)if(v=attrs[k],v&&0!==v.length)try{childContext.setAttribute(k,v)}catch(_error){e=_error,console.log(k,v),childContext[k]=v}}if(childContext.data=data,!context)throw new Error("Context was not found.");if(!ignoreUse&&this._use&&data&&Array.isArray(data))for(_i=0,_len=data.length;_len>_i;_i++)v=data[_i],this._renderChildren(childContext,v,originalData);else this._renderChildren(childContext,data,originalData);return this._childContext=childContext}},TemplateNode.prototype.update=function(t){var e,i,r;if(this.clear(),t&&("object"==typeof t||Array.isArray(t)))for(i=0,r=t.length;r>i;i++)e=t[i],this._renderChildren(this._childContext,e,t,!0);else this._renderChildren(this._childContext,t,t,!0);return this.data=t},TemplateNode.prototype._replaceData=function(t,e){var i,r;for(t=JSON.stringify(t);i=/\#\{(.*?)\}/.exec(t);)r=ObjectUtils.findChild(e,i[1]),r||(r=""),r=r.toString().replace(/\"/g,'\\"'),t=t.replace(new RegExp("#\\{"+i[1]+"\\}","g"),r),t=t.replace(new RegExp("\r\n","g"),"\n"),t=t.replace(new RegExp("[\n|\r]","g"),"\\n");return JSON.parse(t)},TemplateNode.prototype._findObjectData=function(t,e){var i;if(!t)return null;if(e&&(i=/([\*\@])?(.*?)$/.exec(e)))switch(i[1]){case"*":break;case"@":break;default:t=ObjectUtils.findChild(t,i[2])}return t},TemplateNode.prototype._renderChildren=function(t,e,i,r){var n,s,o;for(null==r&&(r=!1),s=this._children.length,n=-1,o=[];++n<s;)o.push(this._children[n].render(t,e,i,r));return o},TemplateNode}(EventDispatcher);var TemplateParser;TemplateParser=function(t){function e(t){null==t&&(t=null),this._replaceStringMultilines=__bind(this._replaceStringMultilines,this),this._replaceObject=__bind(this._replaceObject,this),this._parseObjectRecursive=__bind(this._parseObjectRecursive,this),this._loadComplete=__bind(this._loadComplete,this),this._externalTemplateLoadError=__bind(this._externalTemplateLoadError,this),this._externalTemplateLoaded=__bind(this._externalTemplateLoaded,this),this._replaceNodeExternals=__bind(this._replaceNodeExternals,this),this._loadExternalTemplates=__bind(this._loadExternalTemplates,this),this._templateLoadError=__bind(this._templateLoadError,this),this._templateLoadComplete=__bind(this._templateLoadComplete,this),e.rules||e._parseTemplateRules(),this._renderQueue=[],this._loaded=!1,this.id=t,t&&this.loadTemplate(t)}return __extends(e,t),e.LOAD_COMPLETE="templateParser_loadComplete",e.LOAD_ERROR="templateParser_loadError",e._parseTemplateRules=function(){var t,e,i,r;for(i=Template.RULES.replace(/^\s*$/g,""),t=/^[^\s].*?\n(^[\s+].*?(\n|$))+/gm,this._rules=[],r=[];e=t.exec(i);)r.push(this._parseBlock(e[0]));return r},e._parseBlock=function(t){var e,i,r,n;if(e=/^([^\s]+)\s*\:/.exec(t)){for(e=e[1],n={name:e},r=/^\s+([^\s]+)\s*\:\s*(.*?)\s*$/gm;i=r.exec(t);)n[i[1]]=i[2];return this._rules.push(n)}},e.get({loaded:function(){return this._loaded}}),e.prototype.parse=function(t){return this._templateLoadComplete(null,t)},e.prototype.loadTemplate=function(t,e){var i,r;return null==e&&(e=null),/\.tpl$/.test(t)||(t=t.replace(/\./,"/")+Template.EXTENSION),r=0!==t.indexOf("/")?Template.ROOT_PATH:"",i=r+t,API.call({url:i,onComplete:this._templateLoadComplete,onError:this._templateLoadError,type:"template"})},e.prototype.render=function(t,e){var i,r,n;if(this._loaded){for(r=this._nodes.length,i=-1,n=[];++i<r;)n.push(this._nodes[i].render(t,e));return n}return this._renderQueue.push(arguments)},e.prototype._templateLoadComplete=function(t,e){return e+="\n",this._externalTemplates=[],this._nodes=this._parseBlocks(e),this._loadExternalTemplates()},e.prototype._templateLoadError=function(){return this._loaded=!0,this.trigger(e.LOAD_ERROR)},e.prototype._findTemplate=function(t){var e,i;for(e=this._nodes.length;e-->0;)if((null!=(i=this._nodes[e])?i.id:void 0)===t)return this._nodes[e];return Template.find(t)},e.prototype._loadExternalTemplates=function(){var t,i,r;for(t=this._externalTemplates.length;t-->0;){if(i=this._externalTemplates[t],!this._findTemplate(i))return r=new e(this._externalTemplates[t]),r.on(e.LOAD_ERROR,this._externalTemplateLoadError),r.on(e.LOAD_COMPLETE,this._externalTemplateLoaded),Template.addTemplate(this._externalTemplates[t],r),void this._externalTemplates.splice(t,1);this._externalTemplates.splice(t,1)}return 0===this._externalTemplates.length?(this._replaceNodeExternals(this._nodes),this._loadComplete()):this._loadExternalTemplates()},e.prototype._replaceNodeExternals=function(t){var i,r,n,s;for(r=t.length,s=[];r-->0;)n=t[r],n.external&&(i=this._findTemplate(n.external),i&&(i instanceof e?n.children=i.nodes:i instanceof TemplateNode&&(n.children=i.children)),n.children&&0!==n.children.length||t.splice(r,1)),s.push(n.children.length?this._replaceNodeExternals(n.children):void 0);return s},e.prototype._externalTemplateLoaded=function(t){var i;return i=t.currentTarget,i instanceof e&&Template.addTemplate(i.id,i),this._loadExternalTemplates()},e.prototype._externalTemplateLoadError=function(t){return Template.addTemplate(t.target.id,""),this._loadExternalTemplates()},e.prototype._loadComplete=function(){var t,i;for(this._loaded=!0,t=this._nodes.length;t-->0;)this._nodes[t].id&&this._nodes.splice(t,1);for(i=this._renderQueue.length,t=-1;++t<i;)this.render.apply(this,this._renderQueue[t]);return this.trigger(e.LOAD_COMPLETE)},e.prototype._parseBlocks=function(t){var e,i,r,n,s,o,a,h;for(t=t.replace(/\/\*[\s\S]*?\*\//gm,""),t=t.replace(/^\s*$[\n|\r]/gm,""),e=/(\s*)([^\s].*?\n)((?:\1\s[\s\S].*?(?:\n|$))*)/gm,o=this._escapeCharacters(t,this._escapeMap||[]),t=o[0],this._escapeMap=o[1],a=this._escapeLineBreaks(t,this._escapeMap),t=a[0],this._escapeMap=a[1],h=this._escapeConditionals(t,this._escapeMap),t=h[0],this._escapeMap=h[1],i=[];r=e.exec(t);)n=this._parseNodeData(r[2]),n&&(s=new TemplateNode(n),r[3]&&r[3].trim().length>0&&(s.children=this._parseBlocks(r[3])),i.push(s));return i},e.prototype._parseNodeData=function(t){var e,i,r,n,s,o,a,h,l,u,c,d,_,p,f,g,m,v,y,b;if(v=this._escapeConditionals(t,this._escapeMap),t=v[0],n=v[1],f=/^([\>\<\!]?)(.*?)(\:(.*?))?$/m.exec(t),h={},f[1]&&f[1].length>0)switch(f[1]){case">":h.contextSelector=f[2];break;case"<":this._externalTemplates.push(f[2]),h.external=f[2],f[4]&&f[4].length>0&&(r=/^\s*\#\{(.*?)\}\s*$/.exec(this._unescapeCharacters(f[4],n)),h.content=f[4],r&&(h.use=r[1]));break;case"!":h.id=f[2];break;default:throw new Error("Couldn't parse node: "+f[0])}else{if(d=(this._unescapeCharacters(f[2],this._escapeMap)||"").trim(),o=(this._unescapeCharacters(f[4],this._escapeMap)||"").trim(),u=o,o=o.replace(/^([\'\"])(.*?)\1$/,"$2"),y=this._escapeDataObjects(d,this._escapeMap),_=y[0],this._escapeMap=y[1],b=this._parseObjectRecursive(_),_=b[0],e=b[1],_=this._unescapeCharacters(_,e),_=this._unescapeCharacters(_,this._escapeMap),s=/^\s*\((if|for)(.*?)\)\s*$/.exec(d))h.condition=s[1],h.conditionData=s[2];else{for(i=/([\.\#])?([\w\-]+)/g,_||(_=""),g=_.replace(/\{.*?\}/g,""),l=[],a=[];c=i.exec(g);)switch(c[1]){case".":a.push(c[2]);break;case"#":l.push(c[2]);break;default:h.element=c[2]}l.length&&(e.id||(e.id=""),e.id=[].concat(e.id.split(" "),l).join(" ").trim()),a.length&&(e["class"]||(e["class"]=""),e["class"]=[].concat(e["class"].split(" "),a).join(" ").trim());for(p in e)m=e[p],e[p]=this._unescapeCharacters(m,this._escapeMap);h.attributes=e}h.element||h.condition||(h.element="div"),(null!=o?o.length:void 0)>0&&(h.content=o),o===u&&(r=/^\s*\#\{(.*?)\}\s*$/.exec(o))&&(h.use=r[1])}return h},e.prototype._parseObjectRecursive=function(t){var e,i,r;if(this._objData=[],e=/(\{.*?\})/.exec(t))try{e=JSON.parse(e[0])}catch(n){}for(e||(e={});/\{([^\{\}]*)\}/.test(t);)i=this._escapeCharacters(t,this._objData,"£££"),t=i[0],this._objData=i[1],r=this._escapeString(t,/(([\'\"])([^\2]*)\2)/,this._objData,"£££",3),t=r[0],this._objData=r[1],t=t.replace(/\{([^\{\}]*)\}/g,this._replaceObject);return t=t.replace(/\${3}\d+\£{3}/g,""),[t,e]},e.prototype._replaceObject=function(t,e){var i,r,n,s,o,a,h;for(n=this._objData.length,a={},i=/([^\:\,\{\}]+)\:([^\:\,\}]+)/gm;o=i.exec(e);)s=o[1].trim(),r=o[2].trim(),h=/^\-{3}(\d+)\-{3}$/.exec(r),a[s]=h&&this._objData[h[1]]?this._objData[h[1]]:this._unescapeCharacters(o[2].trim(),this._objData,"£££");return this._objData[n]=a,"---"+n+"---"},e.prototype._escapeString=function(t,e,i,r,n){var s,o;if(null==i&&(i=[]),null==r&&(r="---"),null==n&&(n=1),!e)throw new Error("Must define a RegExp object");for(s=i.length,null==r&&(r="---");o=e.exec(t);)t=t.replace(new RegExp(o[0].replace(/(\W)/g,"\\$1"),"g"),r+s+r),i[s++]=o[n],e.lastIndex=0;return[t,i]},e.prototype._escapeDataObjects=function(t,e){return null==e&&(e=[]),this._escapeString(t,/(\#\{[^\{\}]*\})/,e)},e.prototype._escapeConditionals=function(t,e){return null==e&&(e=[]),this._escapeString(t,/((?:\{([^\{\}]+)})|(?:\(([^\(\)]+)\)))/,e)},e.prototype._escapeCharacters=function(t,e,i){var r;return null==e&&(e=[]),null==i&&(i=null),r=this._escapeString(t,/(\\.)/,e,i),t=r[0],e=r[1],[t,e]},e.prototype._escapeLineBreaks=function(t,e){return t=t.replace(/(['"])([\s\S]*?)\1/g,this._replaceStringMultilines),this._escapeString(t,/(\+{3})/,e)},e.prototype._replaceStringMultilines=function(t){return t=t.replace(/^\s+/gm,""),t.replace(/\n/gm,"+++")},e.prototype._unescapeCharacters=function(t,e,i){var r,n,s,o,a;if(null==i&&(i="---"),t){for(s=i.replace(/(.)/g,"\\$1"),n=new RegExp(s+"(\\d+)"+s,"g");a=n.exec(t);)o=a[1],r=e[a[1]]||"",t=t.replace(new RegExp(s+o+s,"g"),r),n.lastIndex=0;return t}},e}(EventDispatcher);var Template;Template=function(){function t(){}return t.RULES="object:\n	start: \\{\n	end: \\}\n	content: \\:+\ndata: \n	start: \\#\\{\n	end: \\}\n	content: [^\\s]+\nif: \n	start: \\(if\n	end: \\)\nforin:\n	start: \\(for\\s+(\\w+)\\s+in\n	end: \\)\nforof: \n	start: \\(for\\s(\\w+)\\sof\n	end: \\)\nselector: \n	start: \\>\nreference: \n	start: \\<\n	content: [^\\s]+\nid: \n	start: \\!\n	content: [^\\s]+\nelement:\n	start: ^(\\w*)\\:\nsequence:\n	start: \\[\n	end: \\]",t.CACHE={},t.ROOT_PATH="",t.EXTENSION=".tpl",t.setRootPath=function(t){return null==t&&(t=""),this.ROOT_PATH=t},t.setExtension=function(t){return null==t&&(t=".tpl"),this.EXTENSION=t},t.addTemplate=function(t,e){var i;return e instanceof TemplateParser?i=e:(i=new TemplateParser,i.parse(e)),this.CACHE[t]=i,i},t.hasTemplate=function(e){return Boolean(t.CACHE[e])},t.renderTemplate=function(t,e,i,r,n){var s;return null==e&&(e=null),null==i&&(i={}),null==r&&(r=null),null==n&&(n=null),this.currentData=i,(s=this.find(t))?s.render(e,i,r,n):void 0},t.render=function(t,e,i,r,n){var s;return null==e&&(e=null),null==i&&(i={}),null==r&&(r=null),null==n&&(n=null),t?(this.CACHE[t]||(s=new TemplateParser(t),s.on(TemplateParser.LOAD_COMPLETE,this._loadComplete),this.CACHE[t]=s),s=this.CACHE[t],s.render(e,i,r,n)):void 0},t._loadComplete=function(){},t.find=function(t){return this.CACHE[t]},t}();var API;API=function(_super){function API(t){if(this._loadingResize=__bind(this._loadingResize,this),this._loaded=__bind(this._loaded,this),this._parseJSONElement=__bind(this._parseJSONElement,this),this._progress=__bind(this._progress,this),this._loadingHideComplete=__bind(this._loadingHideComplete,this),this._hideLoading=__bind(this._hideLoading,this),this.submit=__bind(this.submit,this),this._submitForm=__bind(this._submitForm,this),this._addEventListeners=__bind(this._addEventListeners,this),API.__super__.constructor.apply(this,arguments),this.TYPES=["normal","json","binary"],this._headers=[],this._reuse=!0,this._method="POST",this._jsonp=!1,this._type="normal",t instanceof HTMLElement&&"form"===t.tagName.toLowerCase())this._form=t,setTimeout(this._addEventListeners,10);else if("undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase)this._form=t,setTimeout(this._addEventListeners,10);else if("string"==typeof t)this._url=t;else if(null!=t)throw new Error("The API constructor argument needs to be a URL string or a Form element.")}return __extends(API,_super),API.START="apiStart",API.COMPLETE="apiComplete",API.ERROR="apiError",API.PROGRESS="apiProgress",API._interceptors=[],API._cachedURLs={},API._request=function(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("MSXML2.XMLHTTP.3.0"):void 0},API.call=function(t,e,i,r,n){var s;return null==e&&(e=null),null==i&&(i=null),null==r&&(r=null),null==n&&(n="normal"),s=new API(t),t instanceof HTMLElement&&"form"===t.tagName.toLowerCase()?t.submit():"undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase&&t.submit(),i&&s.on(API.COMPLETE,i),r&&s.on(API.ERROR,r),s.type=n,s.submit(e),s},API.intercept=function(t,e){var i;for(t instanceof RegExp||(t=new RegExp(t)),i=this._interceptors.length;i-->0;)if(this._interceptors[i].regex===t&&this._interceptors[i].callback===e)return;return this._interceptors.push({regex:t,callback:e})},API.unintercept=function(t,e){var i,r;for(null==e&&(e=null),i=this._interceptors.length,r=[];i-->0;)r.push(this._interceptors[i].regex===t&&e&&this._interceptors[i].callback===e?this._interceptors.splice(i,1):void 0);return r},API._findInterceptor=function(t,e){var i,r,n;for(i=this._interceptors.length,n=[];i-->0;)r=this._interceptors[i],r.regex===t&&r.callback===e&&n.push(r);return n},API._checkInterceptor=function(t,e){var i,r,n,s;for(n=this._interceptors.length,i=-1,s=[];++i<n;)r=this._interceptors[i],r.regex.lastIndex=0,s.push(r.regex.test(t)?"function"==typeof r.callback?r.callback(e,t):void 0:void 0);return s},API._cacheURL=function(t,e){var i;return this._cachedURLs[t]?!1:(i=document.createElement("iframe"),i.style.position="absolute",i.style.left="-10000px",document.body.appendChild(i),i.addEventListener("load",this._iframeLoaded),i.scope=e,i.src=t)},API._iframeLoaded=function(t){var e,i;return e=t.currentTarget,i=e.scope,API._cachedURLs[e.getAttribute("src")]=!0,e.removeEventListener("load",API._iframeLoaded),e.scope=null,e.parentNode&&e.parentNode.removeChild(e),i.submit(i._data)},API.get({url:function(){return this._url}}),API.set({url:function(t){return this._url=t}}),API.get({reuse:function(){return this._reuse}}),API.set({reuse:function(t){return this._reuse=Boolean(t)}}),API.get({type:function(){return this._type}}),API.set({type:function(t){if(!(__indexOf.call(this.TYPES,t)>=0))throw new Error("API.type can only be: "+this.TYPES.join(", "));return this._type=t}}),API.get({method:function(){return this._method}}),API.set({method:function(t){if(!/^(get|post)$/i.test(t))throw new Error("Method can only be either GET or POST");return this._method=t.toUpperCase()}}),API.get({jsonp:function(){throw new Error("Not implemented yet")}}),API.set({jsonp:function(){throw new Error("Not implemented yet")}}),API.get({data:function(){return this._data}}),API.get({requestURL:function(){return this._requestURL}}),API.prototype._addEventListeners=function(){return this._form?this._form.on("submit",this._submitForm):void 0},API.prototype._submitForm=function(){return this.submit()},API.prototype.addHeader=function(t,e){return this._headers[t]=e},API.prototype.removeHeader=function(t){return this._headers[t]=null,delete this._headers[t]},API.prototype.load=function(t,e){return null==e&&(e=null),this._url=t,this.submit(e)},API.prototype.submit=function(t){var e,i,r,n,s,o,a,h,l,u,c,d,_,p,f,g;if(null==t&&(t=null),this._currentProgress=0,this._data=t,!this._submitting&&(h=this._url||"",this._form&&this._form.hasAttribute("action")&&(h=this._form.getAttribute("action")),!/\W?login\W?/.test(h)||!this.constructor._cacheURL(h,this))){if(this._submitting=!0,t instanceof HTMLElement&&"form"===t.tagName.toLowerCase()?(this._form=t,t=null):"undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase&&(this._form=t.element,t=null),this._form)this._form.hasAttribute("enctype")&&this.addHeader("Content-type",this._form.getAttribute("enctype")),this._form.hasAttribute("method")&&(this.method=this._form.getAttribute("method")),this._form.hasAttribute("type")&&"json"===this._form.getAttribute("type")?(this.addHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=JSON.stringify(this._parseJSON(this._form))):t=new FormData(this._form);
else if("normal"===this._type){if(t||(t=new FormData),t&&!(t instanceof FormData)){e=new FormData;for(s in t)u=t[s],e.append(s,u);t=e}}else"json"===this._type?(this.addHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=JSON.stringify(t)):"binary"===this._type&&(this.addHeader("Content-type","application/octet-stream;charset=UTF-8"),this.method="POST");if(r={},l=window.location.search)for(l=l.replace(/^\??/,"").split("&"),c=0,d=l.length;d>c;c++)a=l[c],o=a.split("="),(null!=(_=o[0])?_.trim().length:void 0)>0&&(r[o[0].trim()]=null!=(p=o[1])?p.trim():void 0);i=[];for(n in r)u=r[n],i.push(n+"="+u);if(i=i.join("&"),i.length>0&&(h+=h.indexOf("?")>=0?"&"+i:"?"+i),this._requestURL=h,this._request=API._request(),this._request.onreadystatechange=this._loaded,null!=(f=this._request.upload)&&f.addEventListener("progress",this._progress),this._request.addEventListener("progress",this._progress),this._request.open(this.method,h,!0),this._headers){g=this._headers;for(n in g)u=g[n],this._request.setRequestHeader(n,u)}this._form&&this._form.getAttribute("globalLoading")&&(this._loading=new cms.ui.Loading,this._loading.css({position:"fixed"}),this._loading.show(),window.addEventListener("resize",this._loadingResize),app["interface"].context.appendChildAt(this._loading,0),setTimeout(this._loadingResize,0)),this.trigger(API.START),this._request.send(t)}},API.prototype._hideLoading=function(){var t;return this._loading?(null!=(t=this._loading)&&(t.progress=1),this._loading.on(cms.ui.Loading.HIDE_COMPLETE,this._loadingHideComplete),this._loading.hide()):void 0},API.prototype._loadingHideComplete=function(){var t;return this._loading.element.parentNode&&this._loading.element.parentNode.removeChild(this._loading.element),this._loading.remove(),this._loading.off(cms.ui.Loading.HIDE_COMPLETE,this._loadingHideComplete),"function"==typeof(t=this._loading).destroy&&t.destroy(),this._loading=null,window.removeEventListener("resize",this._loadingResize),delete this._loading},API.prototype._progress=function(t){var e;return e=t.loaded>t.total?.5:t.loaded/t.total,e*=.5,t.currentTarget!==this._request.upload&&(e+=.5),e*=.7,this._triggerProgress(e)},API.prototype._triggerProgress=function(t){var e;return t>this._currentProgress&&(this._currentProgress=t),null!=(e=this._loading)&&(e.progress=this._currentProgress),this.trigger(API.PROGRESS,{loaded:t,total:1,progress:this._currentProgress})},API.prototype.parseJSON=function(t){return this._parseJSON(t)},API.prototype._parseJSON=function(t){var e;return this._parsedElements=[],e=this._parseJSONElement(t)},API.prototype._parseJSONElement=function(t,e){var i,r,n,s,o,a,h,l,u,c,d,_,p,f,g;for(null==e&&(e=0),l=t.querySelectorAll("[json-name]"),c={},s="",n=e;n-->0;)s+=" ";for(i=0,_=0,f=l.length;f>_;_++)h=l[_],this._parsedElements.indexOf(h)>=0||(this._parsedElements.push(h),u=h.getAttribute("json-name"),(r=this._parseJSONElement(h,e+2))&&(c[u]||(c[u]=[]),c[u].push(r)));for(a=t.querySelectorAll("input,textarea,select"),p=0,g=a.length;g>p;p++)if(o=a[p],!(this._parsedElements.indexOf(o)>=0)){if(this._parsedElements.push(o),d=o.value,o.hasAttribute("type"))switch(o.getAttribute("type").toLowerCase()){case"radio":case"checkbox":if(c[o.name]||(c[o.name]=[]),!o.checked)continue}c[o.name]?(Array.isArray(c[o.name])||(c[o.name]=[c[o.name]]),c[o.name].push(d)):c[o.name]=d}return c},API.prototype.abort=function(){return this._submitting=!1,this._request&&(this._request.onreadystatechange=null,this._request.abort()),this._reuse?void 0:this.off()},API.prototype._loaded=function(e){var data,o,p,re,response,t,target;if(target=e.currentTarget,t=target.responseText||"",/__p[\d\.]+__/.test(t)){for(re=/__p([\d\.]+)__/g,p=0;o=re.exec(t);)p=Number(o[1]);this._triggerProgress(.7+.3*p)}if(4===target.readyState){if(this._submitting=!1,200===target.status){this._triggerProgress(1),response=target.responseText||target.response||"",response=response.replace(/__p([\d\.]+)__\s*\n?/g,"");try{data=eval("("+response+")")}catch(_error){e=_error;try{data=JSON.stringify(response)}catch(_error){}}return data?"string"==typeof data&&(data=response):data=response,(null!=data?data.error:void 0)?this._loadError(data):this._loadSuccess(data)}return this._loadError(404===e.currentTarget.status?{message:""}:{message:""})}},API.prototype._loadSuccess=function(t){return null==t&&(t=null),this._hideLoading(),this.trigger(API.COMPLETE,t),this.constructor._checkInterceptor(this._requestURL,t)},API.prototype._loadError=function(t){return null==t&&(t=null),this._hideLoading(),this.trigger(API.ERROR,t),this.constructor._checkInterceptor(this._requestURL,t)},API.prototype._loadingResize=function(){var t;if(this._loading)return t=app["interface"].context.getBounds(),this._loading.css({top:t.top+"px",left:t.left+"px",height:t.height+"px",width:t.width+"px"})},API}(EventDispatcher);var User;User=function(t){function e(){this._mouseDown=__bind(this._mouseDown,this),this._userAPIIntercepted=__bind(this._userAPIIntercepted,this),e.__super__.constructor.apply(this,arguments),this._logged=!1,API.intercept(/api\/cms\/user\/.+/g,this._userAPIIntercepted),this._getUser()}return __extends(e,t),e.STATUS_CHANGE="user_statusChange",e.API_PATH="api/cms/user/",e.prototype._userAPIIntercepted=function(t,e){var i,r;if(r=e.replace(/^.*?api\/cms\/user\/([^\?]*)\??.*$/,"$1"),null!=t.error)switch(t.code){case 100:return this._showLogin();case 101:return"Login error";case 102:return"No permission"}else switch(r){case"getUser":case"login":if(this._data=t,this._changeStatus(!0),app["interface"].show(),i=app.router.getParsedPath().params,i.__redirect__)return app.router.removeParam("__redirect__"),window.location=decodeURIComponent(i.__redirect__);break;case"forgot":return 2;case"changePassword":return 3;case"logout":return this._changeStatus(!1),this._logged=!1,this._showLogin()}},e.get({data:function(){return this._data}}),e.get({logged:function(){return this._logged}}),e.prototype._changeStatus=function(t){return this._logged=t,this.trigger(this.constructor.STATUS_CHANGE,t)},e.prototype._getUser=function(){return API.call(app.rootPath+this.constructor.API_PATH+"getUser")},e.prototype._showLogin=function(){return app.template.isCurrent("user/login")?void 0:app.template.render("user/login",null,document.body)},e.prototype._showLoginError=function(){},e.prototype._mouseDown=function(){return this._showLogin()},e}(EventDispatcher);var Resizer;Resizer=function(t){function e(){this._resize=__bind(this._resize,this),e.__super__.constructor.apply(this,arguments),window.addEventListener("resize",this._resize)}return __extends(e,t),e.getInstance=function(){return null!=e._instance?e._instance:e._instance=function(t,e,i){i.prototype=t.prototype;var r=new i,n=t.apply(r,e);return Object(n)===n?n:r}(e,arguments,function(){})},e.prototype._resize=function(){return this.trigger("resize")},e}(EventDispatcher);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.core.InterfaceController=function(){function t(){this._loginStatusChange=__bind(this._loginStatusChange,this),this._interfaceRendered=__bind(this._interfaceRendered,this),this._interfaceLoaded=__bind(this._interfaceLoaded,this),this._pageShown=__bind(this._pageShown,this),this._apiRedirectInterceptor=__bind(this._apiRedirectInterceptor,this),app.user.on(User.STATUS_CHANGE,this._loginStatusChange),API.intercept(/.*/g,this._apiRedirectInterceptor)}return t.getInstance=function(){return null!=t._instance?t._instance:t._instance=function(t,e,i){i.prototype=t.prototype;var r=new i,n=t.apply(r,e);return Object(n)===n?n:r}(t,arguments,function(){})},t.get({context:function(){return this._context}}),t.prototype._apiRedirectInterceptor=function(t){return(null!=t?t.goto:void 0)?app.router.goto(t.goto):(null!=t?t.redirect:void 0)?app.router.goto(t.redirect):(null!=t?t.refresh:void 0)?1:void 0},t.prototype.show=function(t){return null==t&&(t=null),app.user.logged?this._interfaceShown?(t||(t=app.router.getCurrentPath()),t=t.trim("/"),0===t.length&&(t="index"),this._showPage(t)):void this._showInterface():void 0},t.prototype._showPage=function(t){var e,i,r,n,s,o,a;if(this._loading||(this._loading=new cms.ui.Loading),this._context.appendChildAt(this._loading,0),this._loading.show(),this._loading.progress=.5,o=this._findValidPage(t)){n={},r=app.router.getParsedPath(),t=t.replace(/(\?|\#).*?$/,""),i=t.substr(t.indexOf(o)+o.length).trim("/").split("/");for(e in i)s=i[e],n[e]=s;a=r.params;for(e in a)s=a[e],n[e]=s;return slikland.Mara.setGlobalObject("$",n),slikland.Mara.setGlobalObject("#",r.hashes),app.template.render("pages/"+o,{},this._context.element,this._pageShown)}},t.prototype._pageShown=function(){return this._loading.progress=1,this._loading.hide()},t.prototype._findValidPage=function(t){var e,i;for(null==t&&(t=""),t=t.trim("/"),e=this._availPages.length;e-->0;)if(i=this._availPages[e].path,0===t.indexOf(i))return i;return null},t.prototype._showInterface=function(){return app.user.logged?(this._interfaceShown=!0,API.call(app.rootPath+"api/cms/cms/getInterface",null,this._interfaceLoaded)):void 0},t.prototype._interfaceLoaded=function(t,e){var i;return this._availPages=e.pages,this._availPages.sort(this._sortPages),i={user:app.user.data,"interface":e},app.template.render("interface/interface",i,document.body,this._interfaceRendered)},t.prototype._sortPages=function(t,e){var i,r,n,s;return t=t.path.trim("/"),e=e.path.trim("/"),i=t.split("/").length,n=e.split("/").length,n>i?-1:i>n?1:(r=t.length,s=e.length,s>r?-1:r>s?1:0)},t.prototype._interfaceRendered=function(t){var e;return e=t[0][1],this._header=e.querySelector("header"),this._menu=e.querySelector("nav"),this._context=new BaseDOM({element:e.querySelector("main")}),this.show()},t.prototype._loginStatusChange=function(){return this._interfaceShown=!1},t}();var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Update=function(_super){function Update(){return Update.__super__.constructor.apply(this,arguments)}var Plugin;return __extends(Update,_super),Update.SELECTOR="[update]",Update.prototype._update=function(t){var e,i,r,n,s,o,a,h,l;for(a=t.add,r=0,s=a.length;s>r;r++)e=a[r],this._plugins[e]=new Plugin(e);for(h=t.remove,l=[],n=0,o=h.length;o>n;n++)e=h[n],i=this._plugins[e],l.push(i?"function"==typeof i.destroy?i.destroy():void 0:void 0);return l},Plugin=function(_super1){function Plugin(t){this._input=__bind(this._input,this),this._change=__bind(this._change,this),this._updateTargets=__bind(this._updateTargets,this);var e,i,r;if(Plugin.__super__.constructor.call(this,{element:t}),this.attr("update")){for(this._updateParams=[],r=this.attr("update"),i=/\[([^\[\]]+)\]/g;e=i.exec(r);)this._updateParams.push(e[1].split(","));this._updateParams.length>0&&(this.element.on("change",this._change),this.element.on("input",this._input),this.element.on("update",this._input),setTimeout(this._updateTargets,1))}}return __extends(Plugin,_super1),Plugin._destroyPlugin=function(){},Plugin.prototype._updateTargets=function(){var i,items,j,li,lj,params,v,value,_ref;if("input"!==this.element.tagName.toLowerCase()||"radio"!==(_ref=this.element.getAttribute("type"))&&"checkbox"!==_ref||this.element.checked)for(li=this._updateParams.length,i=-1;++i<li;){params=this._updateParams[i],items=document.body.querySelectorAll(params[0]);try{with(v=null,this.element)v=eval(params[2]);v&&(value=v)}catch(_error){value=this.element.value}if(v||(value=this.element.value),value&&void 0!==value||(value=this.element.itemData),void 0===value)return;for(lj=items.length,j=-1;++j<lj;)items[j].trigger(params[1],value)}},Plugin.prototype._updateDelayed=function(){return clearTimeout(this._updateTimeout),this._updateTimeout=setTimeout(this._updateTargets,200)},Plugin.prototype._change=function(){return this._updateTargets()},Plugin.prototype._input=function(){return this._updateDelayed()},Plugin}(BaseDOM),Update}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.attributes.Template=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="a[template],button[template]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._click=function(){var t;return t={template:this.attr("template"),target:this.attr("templateTarget"),currentTarget:this},app.trigger(Main.RENDER_TEMPLATE,t)},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Sort=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[sort]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._sortByOrder=__bind(this._sortByOrder,this),this._click=__bind(this._click,this),this._update=__bind(this._update,this),this._resetOthers=__bind(this._resetOthers,this),this._parseParam=__bind(this._parseParam,this),e.__super__.constructor.call(this,{element:t}),this._name=this.attr("sort"),this._element.setAttribute("name","sort"),this._sortButton=document.createElement("span"),this._sortButton.className="sort",this._icon=document.createElement("i"),this._icon.className="fa icon",this._sortButton.appendChild(this._icon),this._sortOrder=document.createElement("sup"),this._sortButton.appendChild(this._sortOrder),this._getTarget(),this._parseParam(),this._element.on("click",this._click),this._element.on("update",this._update),this.appendChild(this._sortButton)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._getTarget=function(){return this.attr("for")?(this._target=document.querySelector("#"+this.attr("for")),this._parentTarget=this._target.parentNode):(this._target=this.findParents("[service]"),this._parentTarget=this._target)},e.prototype._parseParam=function(){var t,e,i;if(i=this._target.getAttribute("id")){if(t=app.router.getParam(i),!t)return;return t.sort&&(t=[].concat(t.sort),(e=t.indexOf(this._name))>=0?(t.length>1&&(this._element.sortOrder=e),this._element.value=this._name):(e=t.indexOf("-"+this._name))>=0&&(t.length>1&&(this._element.sortOrder=e),this._element.value="-"+this._name)),this._element.setAttribute("for",i),this._update()}},e.prototype._resetOthers=function(){var t,e,i;for(e=this._parentTarget.querySelectorAll("[sort]"),t=e.length,i=[];t-->0;)e[t].sortOrder=null,delete e[t].sortOrder,e[t]!==this._element&&i.push(e[t].value=null);return i},e.prototype._updateAll=function(){var t,e,i;for(e=this._parentTarget.querySelectorAll("[sort]"),t=e.length,i=[];t-->0;)i.push(e[t].trigger("update"));return i},e.prototype._update=function(){return this._getTarget(),this._element.value?this._element.setAttribute("value",this._element.value):this._element.removeAttribute("value"),isNaN(this._element.sortOrder)?(this._element.removeAttribute("sortOrder"),this._sortOrder.innerHTML=""):(this._element.setAttribute("sortOrder",this._element.sortOrder),this._sortOrder.innerHTML=this._element.sortOrder)},e.prototype._click=function(t){var e,i,r,n;if(n=this._element.value,n=n&&!/^\-/.test(n)?"-"+this._name:this._name,t.metaKey){for(r=ArrayUtils.toArray(this._parentTarget.querySelectorAll("[sort][value]")),r.sort(this._sortByOrder),i=r.length,e=r.length;e-->0;)r[e].sortOrder=e,r[e]===this._element&&(i=e);this._element.sortOrder=i}else this._resetOthers();return this._element.value=n,this._updateAll(),this._target.trigger("update")},e.prototype._sortByOrder=function(t,e){return t.sortOrder<e.sortOrder?-1:t.sortOrder>e.sortOrder?1:0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.attributes.Size=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR="[height],[width]",e.prototype._update=function(t){var e,i,r,n,s;for(r=t.add,e=r.length,s=[];e-->0;)i=r[e],i.hasAttribute("width")&&(n=i.getAttribute("width"),/^\s*[\d\.]+\s*$/.test(n)&&(n+="px"),i.style.width=n),i.hasAttribute("height")?(n=i.getAttribute("height"),/^\s*[\d\.]+\s*$/.test(n)&&(n+="px"),s.push(i.style.height=n)):s.push(void 0);return s},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.ShowModal=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[showModal]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._buttonClick=__bind(this._buttonClick,this),this._modalRendered=__bind(this._modalRendered,this),this._click=__bind(this._click,this),this._addEventListener=__bind(this._addEventListener,this),e.__super__.constructor.call(this,{element:t}),this._modalRef=this.attr("showModal"),setTimeout(this._addEventListener,1)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._addEventListener=function(){return this._element.on("click",this._click)},e.prototype._click=function(t){return app.template.renderBlockByReference(this._modalRef,null,null,this._modalRendered),t.preventDefault(),t.stopImmediatePropagation()},e.prototype._modalRendered=function(t){var e,i,r,n,s;for(this._target=t[0][1],i=this._target.querySelectorAll("button"),s=[],r=0,n=i.length;n>r;r++)e=i[r],s.push(e.on("click",this._buttonClick));return s},e.prototype._buttonClick=function(t){return t.preventDefault(),t.stopImmediatePropagation(),this._target.parentNode.removeChild(this._target)},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Service=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[service]",e._queue=[],e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],e.hasAttribute("service")&&(this._plugins[e]=new i(e));for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],this.removeQueue(r),u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},e.prototype.removeQueue=function(){},e.prototype.queueService=function(t,e){null==e&&(e=0)},e.prototype._sortByOrder=function(t,e){return t.order>e.order?1:t.order<e.order?-1:0},i=function(t){function e(t){this._sortByOrder=__bind(this._sortByOrder,this),this._serviceError=__bind(this._serviceError,this),this._serviceLoaded=__bind(this._serviceLoaded,this),this._parseData=__bind(this._parseData,this),this._onProgress=__bind(this._onProgress,this),this._showProgress=__bind(this._showProgress,this),this._removeProgress=__bind(this._removeProgress,this),this._loadService=__bind(this._loadService,this),this._update=__bind(this._update,this),this._abort=__bind(this._abort,this),e.__super__.constructor.call(this,{element:t}),this._element.on("update",this._update),this._element.on("abort",this._abort),this._loadServiceTimeout=setTimeout(this._loadService,1)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._abort=function(){var t;return clearTimeout(this._loadServiceTimeout),null!=(t=this._api)&&t.abort(),this._removeProgress()},e.prototype._update=function(){return clearTimeout(this._loadServiceTimeout),this._loadServiceTimeout=setTimeout(this._loadService,300)},e.prototype._loadService=function(){var t;return clearTimeout(this._loadServiceTimeout),t=this._parseData(),this._api=API.call(this._element.getAttribute("service"),t,this._serviceLoaded,this._serviceError),this._api.on(API.PROGRESS,this._onProgress),this._showProgress()},e.prototype._removeEventListeners=function(){return this._api.off(API.PROGRESS,this._onProgress)},e.prototype._removeProgress=function(){return this._loading?this._loading.hide():void 0},e.prototype._showProgress=function(){return this.element.hasAttribute("noloading")?void 0:(this._loading||(this._loading=new cms.ui.Loading),this._loading.reset(),this._loading.show(),this.appendChildAt(this._loading,0))},e.prototype._onProgress=function(t,e){var i;return null!=(i=this._loading)?i.progress=e.progress:void 0},e.prototype._parseData=function(){var t,e,i,r,n,s,o,a,h,l,u,c,d,_,p;if(a=app.router.getParam(this.attr("id")),this.attr("id")){for(e=this.attr("id"),a={},o=!1,r=document.querySelectorAll("[for="+e+"]"),c=0,d=r.length;d>c;c++){switch(i=r[c],n=!1,s=i.getAttribute("name"),u=i.value,i.tagName.toLowerCase()){case"input":"checkbox"===(_=i.getAttribute("type"))&&(n=!0),("checkbox"===(p=i.getAttribute("type"))||"radio"===p)&&(i.checked||(u=null));break;case"pagination":i.index&&(o=!0,a._index=i.index),i.numItems&&(a._numItems=i.numItems);break;default:if(i.hasAttribute("sort"))continue}u&&(o=!0,n?(a[s]||(a[s]=[]),a[s].push(u)):a[s]=u)}if(h=[].concat(ArrayUtils.toArray(this._element.querySelectorAll("[sort][value]")),ArrayUtils.toArray(document.querySelectorAll('[for="'+e+'"][sort][value]'))),h.length>0){for(h.sort(this._sortByOrder),l=[],t=h.length;t-->0;)l[t]=h[t].value;o=!0,a.sort=l}o?app.router.setParam(e,a):app.router.removeParam(e)}return a},e.prototype._serviceLoaded=function(t,e){var i,r,n,s,o;if(app.template.renderBlock(this._element,e),this.attr("id"))for(r=this.attr("id"),n=document.querySelectorAll("[for="+r+"]"),i=n.length;i-->0;)n[i].trigger("update",e);return(null!=e&&null!=(s=e.notification)&&null!=(o=s.message)?o.length:void 0)>0&&(e.notification.type||(e.notification.type=3),app.notification.showNotification(e.notification)),this._element.trigger("updated",e),this._removeEventListeners(),this._removeProgress()},e.prototype._serviceError=function(t,e){var i;return(null!=e&&null!=(i=e.message)?i.length:void 0)>0&&(e.type||(e.type=1),app.notification.showNotification(e)),this._element.getAttribute("onError")&&app.router.goto(this._element.getAttribute("onError")),this._removeEventListeners(),this._removeProgress()},e.prototype._sortByOrder=function(t,e){return t.sortOrder<e.sortOrder?-1:t.sortOrder>e.sortOrder?1:0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Remove=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[remove]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._click=function(t){var e;return t.preventDefault(),t.stopImmediatePropagation(),e=this.findParents(this.attr("remove")),e?e.parentNode.removeChild(e):void 0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Href=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[href]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],e.hasAttribute("href")&&!e.getAttribute("target")&&(this._plugins[e]=new i(e));for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._click=function(t){return app.router.goto(this.attr("href")),t.preventDefault(),t.stopImmediatePropagation()},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.For=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[for]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],e.hasAttribute("sort")||(this._plugins[e]=new i(e));for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._change=__bind(this._change,this),e.__super__.constructor.call(this,{element:t}),this._target=document.querySelector("#"+this.attr("for")),this._value="",this._setItemValue(),this._element.on("change",this._change),this._element.on("input",this._change)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._setItemValue=function(){var t,e,i,r,n,s;return e=this._element.getAttribute("for"),(t=app.router.getParam(e))?(i=this._element.getAttribute("name"),i&&t[i]?(t=t[i],"input"!==this._element.tagName.toLowerCase()||"checkbox"!==(r=null!=(n=this._element.getAttribute("type"))?n.toLowerCase():void 0)&&"radio"!==r?(this._element.value=t,this._value=t):(s=this._element.value,__indexOf.call(t,s)>=0?(this._element.checked=!0,this._element.trigger("change"),this._value=!0):this._value=!1)):void 0):void 0},e.prototype._change=function(){var t,e,i,r,n;return this._target=document.querySelector("#"+this.attr("for")),t=!1,e=null,"input"!==this._element.tagName.toLowerCase()||"checkbox"!==(i=null!=(r=this._element.getAttribute("type"))?r.toLowerCase():void 0)&&"radio"!==i?(e=this._element.value,e.trim()!==this._value.trim()&&(t=!0,this._value=e)):(e=this._element.checked,e!==this._value&&(t=!0,this._value=e)),t&&null!=(n=this._target)?n.trigger("update"):void 0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.attributes.Focus=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR="[focus]",e.prototype._update=function(t){var e,i,r,n;for(r=t.add,e=r.length,n=[];e-->0;)i=r[e],n.push(i.focus());return n},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.FAB=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR='fab,button[type="fab"]',e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._checkPosition=__bind(this._checkPosition,this),this._scroll=__bind(this._scroll,this),this.destroy=__bind(this.destroy,this),this._setPosition=__bind(this._setPosition,this),e.__super__.constructor.call(this,{element:t}),this.attr("on")&&(this.css("visibility","hidden"),setTimeout(this._setPosition,100))}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._setPosition=function(){return this._target=document.querySelector("#"+this.attr("on")),this._position="TR",this.attr("position")&&(this._position=this.attr("position")),this._checkPosition(),this.css("visibility","")},e.prototype.destroy=function(){return e.__super__.destroy.apply(this,arguments),this._target=null,window.cancelAnimationFrame(this._checkPositionTicker)},e.prototype._scroll=function(){},e.prototype._checkPosition=function(){var t,e,i,r,n;if(this._target&&this._element.parentNode)return this._checkPositionTicker=window.requestAnimationFrame(this._checkPosition),e=this._getTargetBounds(this._target),r=this._element.parentNode.getBoundingClientRect(),t=this.getBounds(),n=e.top+.25*t.height,i=e.left,e.bottom<1.5*t.height?n=e.bottom-1.25*t.height:n<.25*t.height&&(n=.25*t.height),n+=r.top,e.right<1.25*t.width?i=e.bottom-1.25*t.width:0>i&&(i=0),i+=r.left+e.width-1.25*t.width,this.css({top:n+"px",left:i+"px"})},e.prototype._getTargetBounds=function(t){var e,i,r,n,s;null==t&&(t=null),i={},e=t.getBoundingClientRect();for(r in e)s=e[r],i[r]=s;return this._element.parentNode&&(n=this._element.parentNode.getBoundingClientRect()),n&&(i.top-=n.top,i.left-=n.left,i.bottom-=n.top,i.right-=n.left),i.width=i.right-i.left,i.height=i.bottom-i.top,i},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Duplicate=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[duplicate]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._form=null,e._destroyPlugin=function(){},e.prototype._click=function(t){var e,i,r,n,s,o,a;for(t.preventDefault(),t.stopImmediatePropagation(),s=app["interface"].context.find(this.attr("duplicate")),e=slikland.mara.Block.findBlock(s.getAttribute("mara")),i=s.cloneNode(!0),n=i.querySelectorAll("input,textarea"),o=0,a=n.length;a>o;o++)r=n[o],r.value="",r.innerHTML="";return s.parentNode.appendChild(i)},e}(BaseDOM),e}(cms.ui.Base);var MouseUtils;MouseUtils=function(){function t(){}return t.getMousePos=function(t,e){var i,r;return null==e&&(e=!0),i=t.pageX||t.clientX,r=t.pageY||t.clientY,e&&(i+=document.body.scrollLeft+document.documentElement.scrollLeft,r+=document.body.scrollTop+document.documentElement.scrollTop),[i,r]},t.toGlobal=function(t,e){return t+=document.body.scrollLeft+document.documentElement.scrollLeft,e+=document.body.scrollTop+document.documentElement.scrollTop,[t,e]},t}();var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Draggable=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[draggable]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._moveCloned=__bind(this._moveCloned,this),this._mouseUp=__bind(this._mouseUp,this),this._sortPosition=__bind(this._sortPosition,this),this._switchElement=__bind(this._switchElement,this),this._findElementToSwitch=__bind(this._findElementToSwitch,this),this._mouseMove=__bind(this._mouseMove,this),this._mouseDown=__bind(this._mouseDown,this),this._findParentContext=__bind(this._findParentContext,this),e.__super__.constructor.call(this,{element:t}),this._draggableName=this.attr("draggable"),this._dragHandler=document.createElement("i"),this._dragHandler.className="drag-handle fa fa-ellipsis-h",this._dragHandler.on("mousedown",this._mouseDown),this._draggableContextSelector='[draggableContext="'+this._draggableName+'"]',this.appendChild(this._dragHandler),this._parentContexts=this._findParentContext(),0===this._parentContexts.length&&(this._parentContexts=[t.parentNode]),this._setupDraggables(),this._getDraggableItems()}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._findParentContext=function(t){var e,i,r;for(null==t&&(t=null),e=document.body.querySelectorAll(this._draggableContextSelector),r=[],i=e.length;i-->0;)e[i].findParents(this._draggableContextSelector)||r.push(e[i]);return r},e.prototype._addEventListeners=function(){return window.addEventListener("mousemove",this._mouseMove),window.addEventListener("mouseup",this._mouseUp),window.addEventListener("mouseleave",this._mouseLeave)},e.prototype._removeEventListeners=function(){return window.removeEventListener("mousemove",this._mouseMove),window.removeEventListener("mouseup",this._mouseUp),window.removeEventListener("mouseleave",this._mouseLeave)
},e.prototype._drop=function(){return this._items=null,this._removeEventListeners(),this._cloned.parentNode.removeChild(this._cloned),this._element.style.opacity="",this.element.trigger("update")},e.prototype._mouseDown=function(t){var e,i;return this._updateDraggableItems(),t.preventDefault(),this._cloned=this._element.cloneNode(!0),this._cloned.setAttribute("cloned","1"),this._cloned.style.position="absolute",this._cloned.style.opacity="0.4",i=this.getBounds(this._dragHandler),this._elOffset={x:t.offsetX-i.left,y:t.offsetY-i.top},this._cloned.style.top="0px",this._cloned.style.left="0px",this._cloned.style.zIndex="100",e=this.getBounds(),this._cloned.style.width=e.width+"px",this._cloned.style.height=e.height+"px",this._element.style.opacity="0.6",this._element.parentNode.appendChild(this._cloned),this._moveCloned(t),this._addEventListeners()},e.prototype._setupDraggables=function(){var t,e,i,r,n,s,o,a,h;if(!this._parentContexts[0].querySelector("draggableplaceholder")){for(a=this._parentContexts,h=[],s=0,o=a.length;o>s;s++){for(i=a[s],e=i.querySelectorAll('[draggableContext="'+this._draggableName+'"]'),r=e.length;r-->0;)t=e[r],n=document.createElement("draggableplaceholder"),n.style.width="100%",n.style.height="100%",n.style.display="inline-block",t.appendChild(n);n=document.createElement("draggableplaceholder"),n.style.width="100%",n.style.height="100%",n.style.display="inline-block",h.push(i.appendChild(n))}return h}},e.prototype._getDraggableItems=function(){var t;return t=this._getDraggableChildren(this._parentContexts)},e.prototype._getDraggableChildren=function(t){var e,i,r,n,s,o;for(n=[],t=[].concat(t),s=0,o=t.length;o>s;s++)for(i=t[s],e=i.children,r=e.length;r-->0;)e[r]===this._element||e[r].hasAttribute("cloned")||n.push({element:e[r]});return n},e.prototype._updateDraggableItems=function(){var t,e,i,r,n,s,o;for(this._items||(this._items=this._getDraggableItems()),r=this._items.length,o=[];r-->0;)n=this._items[r],i=n.element,s=this._getElementPosition(i),(t=i.querySelector("draggableContext"))&&(e=this._getElementPosition(t),s.h-=e.h,s.cy=s.y+.5*e.h),o.push(n.pos=s);return o},e.prototype._getElementPosition=function(t,e){var i,r,n,s,o,a,h,l;return null==e&&(e=!1),n={},h=document.body.scrollLeft+document.documentElement.scrollLeft,l=document.body.scrollTop+document.documentElement.scrollTop,i=t.getBoundingClientRect(),s=i.left,o=i.top,a=i.right-s,r=i.bottom-o,n.x=s+h,n.y=o+l,n.w=a,n.h=r,n.cx=n.x+.5*a,n.cy=n.y+.5*r,n},e.prototype._mouseMove=function(t){var e,i;return this._moveCloned(t),i=this._getElementPosition(this._cloned),e=this._findElementToSwitch(i),e?(this._switchElement(e.element,e.after),this._moveCloned(t)):void 0},e.prototype._findElementToSwitch=function(t,e){var i,r,n,s,o,a,h,l,u,c,d,_,p,f,g,m,v,y,b,w,E;for(null==e&&(e=null),e||(e=this._parentContexts),e=[].concat(e),a=null,c=Number.MAX_VALUE,y=0,b=e.length;b>y;y++){for(l=e[y],o=l.children,m=[],p=o.length;p-->0;)s=o[p],s.matches("[cloned]")||m.push(s);for(p=m.length;p-->0;)g=m[p],f=this._getElementPosition(g),d=f.cx-t.cx,_=f.cy-t.cy,u=d*d+_*_,c>u&&(c=u,i=Math.atan2(_,d),a=g,h=f)}return a===this._element?null:a?(l=a.querySelector('[draggableContext="'+this._draggableName+'"]'))&&(n=this._getElementPosition(l),n.x<(w=t.cx)&&w<n.x+n.w&&n.y<(E=t.cy)&&E<n.y+n.y)?this._findElementToSwitch(t,l):(v=2*Math.PI,i=(i%v+v)%v,r=i>.375*v&&.875*v>i,{element:a,after:r}):void 0},e.prototype._switchElement=function(t,e){var i,r,n,s,o,a;for(o=t.parentNode,r=o.children,n=-1,a=-1,s=r.length;s-->0;)i=r[s],i===t&&(a=s),i===this._element&&(n=s);return e&&(a+=1),n!==a?(a>=r.length-1?o.appendChild(this._element):o.insertBefore(this._element,r[a]),this._updateDraggableItems()):void 0},e.prototype._sortPosition=function(){return 0},e.prototype._mouseUp=function(){return this._drop()},e.prototype._moveCloned=function(t){var e,i,r,n;return i=MouseUtils.getMousePos(t),e=this._cloned.parentNode.getBoundingClientRect(),r=i[0]-e.left-this._elOffset.x,n=i[1]-e.top-this._elOffset.y,this._cloned.style.left=r+"px",this._cloned.style.top=n+"px"},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Confirm=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="[confirm]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._click=function(t){var e;return e=this.attr("confirm"),window.confirm(e)?void 0:(t.preventDefault(),t.stopImmediatePropagation())},e}(BaseDOM),e}(cms.ui.Base);var ColorUtils;ColorUtils=function(){function t(){}return t.lightenColor=function(t,e){var i,r,n,s,o;return o=!1,"#"===t[0]&&(t=t.slice(1),o=!0),n=parseInt(t,16),s=(n>>16)+e,s>255?s=255:0>s&&(s=0),i=(n>>8&255)+e,i>255?i=255:0>i&&(i=0),r=(255&n)+e,r>255?r=255:0>r&&(r=0),o?"#"+(r|i<<8|s<<16).toString(16):(r|i<<8|s<<16).toString(16)},t.luminance=function(t){var e;return e=this.hexToRGBArray(t),(.2126*e[0]+.7152*e[1]+.0722*e[2])/255},t.hexToRGB=function(t){var e;return e=this.hexToRGBArray(t),{r:e[0],g:e[1],b:e[2],a:e[3]}},t.hexToRGBArray=function(t){return t=Number(t.replace(/^\#?([0-9a-f]*?)$/i,"0x$1")),[t>>16&255,t>>8&255,255&t,t>>24&255]},t.rgbToHex=function(t,e,i,r){return null==r&&(r=0),this.rgbArrayToHex([t,e,i,r])},t.rgbArrayToHex=function(t){var e,i;for(i=6,e=t[0]<<16|t[1]<<8|t[2],t[3]&&(i=8,e|=t[3]<<24),e=e.toString();e.length<i;)e="0"+e;return e},t}();var __hasProp={}.hasOwnProperty;cms.ui.attributes.Background=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR="[background]",e.prototype._update=function(t){var e,i,r,n,s,o;for(n=t.add,i=n.length,o=[];i-->0;){r=n[i],e=r.getAttribute("background");try{s=ColorUtils.luminance(e),isNaN(s)||(r.style.color=s>.75?"#666666":"#FFFFFF")}catch(a){}o.push(r.style.background=e)}return o},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tag.attributes.Action=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR=":not(form)[action]",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u,c;for(l=t.add,s=0,a=l.length;a>s;s++)r=l[s],r.hasAttribute("action")&&!r.getAttribute("target")&&(e=r.getAttribute("action"),/\/api\/.*?$/.test(e)&&(this._plugins[r]=new i(r)));for(u=t.remove,c=[],o=0,h=u.length;h>o;o++)r=u[o],n=this._plugins[r],c.push(n?"function"==typeof n.destroy?n.destroy():void 0:void 0);return c},i=function(t){function e(t){this._apiError=__bind(this._apiError,this),this._apiComplete=__bind(this._apiComplete,this),this._loadingResize=__bind(this._loadingResize,this),this._progress=__bind(this._progress,this),this._loadingHideComplete=__bind(this._loadingHideComplete,this),this._hideLoading=__bind(this._hideLoading,this),this._abort=__bind(this._abort,this),this._click=__bind(this._click,this),this._addEventListener=__bind(this._addEventListener,this),e.__super__.constructor.call(this,{element:t}),setTimeout(this._addEventListener,1)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._addEventListener=function(){return this._element.on("click",this._click),this._element.on("abort",this._abort)},e.prototype._click=function(t){return this._api=API.call(this._element.getAttribute("action"),null,this._apiComplete,this._apiError),this._element.getAttribute("globalLoading")&&(this._api.on(API.PROGRESS,this._progress),this._loading=new cms.ui.Loading,this._loading.css({position:"fixed"}),this._loading.show(),window.addEventListener("resize",this._loadingResize),app["interface"].context.appendChildAt(this._loading,0),setTimeout(this._loadingResize,0)),this.attr("prevent")&&"false"===this.attr("prevent")?void 0:(t.preventDefault(),t.stopImmediatePropagation())},e.prototype._abort=function(){var t;return null!=(t=this._api)&&t.abort(),this._hideLoading()},e.prototype._hideLoading=function(){var t;return this._loading?(null!=(t=this._loading)&&(t.progress=1),this._loading.on(cms.ui.Loading.HIDE_COMPLETE,this._loadingHideComplete),this._loading.hide()):void 0},e.prototype._loadingHideComplete=function(){var t;return this._loading.element.parentNode&&this._loading.element.parentNode.removeChild(this._loading.element),this._loading.remove(),this._loading.off(cms.ui.Loading.HIDE_COMPLETE,this._loadingHideComplete),"function"==typeof(t=this._loading).destroy&&t.destroy(),this._loading=null,window.removeEventListener("resize",this._loadingResize),delete this._loading},e.prototype._progress=function(t){var e,i;return e=t.loaded/t.total,null!=(i=this._loading)?i.progress=e:void 0},e.prototype._loadingResize=function(){var t;if(this._loading)return t=app["interface"].context.getBounds(),this._loading.css({top:t.top+"px",left:t.left+"px",height:t.height+"px",width:t.width+"px"})},e.prototype._apiComplete=function(t,e){var i,r,n,s,o,a;if(s=this.attr("success"),s&&s.length>0)switch(s){case"update":this._element.trigger("update");break;case"refresh":app["interface"].show();break;case"reload":window.location.reload();break;default:if(n=/^update\:(.*?)$/.exec(s))for(r=document.body.querySelectorAll(n[1]),i=r.length;i-->0;)r[i].trigger("update");else app["interface"].show(s)}return(null!=e&&null!=(o=e.notification)&&null!=(a=o.message)?a.length:void 0)>0&&(e.notification.type||(e.notification.type=3),app.notification.showNotification(e.notification)),this._hideLoading()},e.prototype._apiError=function(t,e){var i,r,n;if(i=this.attr("error"),i&&i.length>0)switch(i){case"refresh":app["interface"].show();break;case"reload":window.location.reload();break;default:app["interface"].show(i)}else(null!=e&&null!=(r=e.message)?r.length:void 0)>0&&(null!=e&&null!=(n=e.message)?n.length:void 0)>0&&(e.type||(e.type=1),app.notification.showNotification(e));return this._hideLoading()},e}(BaseDOM),e}(cms.ui.Base);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.ui.tags.Card=function(t){function e(){this._resize=__bind(this._resize,this),this._update=__bind(this._update,this),e.__super__.constructor.apply(this,arguments),window.addEventListener("resize",this._resize),app.on("redraw",this._update)}return __extends(e,t),e.SELECTOR="card",e.prototype._update=function(){return setTimeout(this._resize,0),setTimeout(this._resize,500)},e.prototype._resize=function(){var t,e,i,r,n,s,o,a,h,l,u,c,d,_,p,f,g,m;for(i=document.querySelectorAll("card.even-height"),g=[],n=[],c=i.length;c-->0;)e=i[c],e.style.height="",l=e.querySelector("header"),a=e.querySelector("footer"),s=e.querySelector("content"),null!=l&&(l.style.height=""),null!=s&&(s.style.height=""),null!=a&&(a.style.height=""),f=e.parentNode,g.indexOf(f)<0&&g.push(f),p=g.indexOf(f),n[p]||(n[p]={height:0,children:[]}),t=e.getBoundingClientRect(),h=t.bottom-t.top,n[p].height<h&&(n[p].height=h),n[p].children.push(e);for(c=g.length,m=[];c-->0;)d=n[c],_=d.children.length,h=d.height,m.push(function(){var t;for(t=[];_-->0;)r=d.children[_],r.style.height=h+"px",l=r.querySelector("header"),a=r.querySelector("footer"),s=r.querySelector("content"),u=0,o=0,l&&(u=l.getBoundingClientRect(),u=u.bottom-u.top),a&&(o=a.getBoundingClientRect(),o=o.bottom-o.top),t.push(s?s.style.height=h-u-o+"px":void 0);return t}());return m},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Validation=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="field validation",e._validate_email=function(t){return/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+)+(\.[a-zA-Z0-9]{2,63})+$/.test(t)},e._validate_required=function(t){var e;return t&&0!==(null!=(e=t.trim())?e.length:void 0)?!0:!1},e._validate_regex=function(t,e){var i,r,n;return(r=null!=e&&null!=(n=e.item)?n.getAttribute("pattern"):void 0)&&(i=/^(\/?)(.*?)(?:\1([a-z]*))?$/.exec(r))?(r=new RegExp(i[2],i[3]),r.test(t)):!1},e._validate_match=function(t,e,i){var r,n;return r=null!=e&&null!=(n=e.item)?n.getAttribute("field"):void 0,r=i[r],r||(r=i.querySelector(r)),r?r.value===t:!1},e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function i(t){this._submit=__bind(this._submit,this),this._validate=__bind(this._validate,this),this._blur=__bind(this._blur,this),this._change=__bind(this._change,this),this._parseValidations=__bind(this._parseValidations,this),this.destroy=__bind(this.destroy,this),i.__super__.constructor.call(this,{element:t}),this._parseValidations(),this._form=this.findParents("form"),this._field=new BaseDOM(this.findParents("field")),this._input=this._field.find("input"),this._input.on("blur",this._blur),this._input.on("change",this._change),this._input.on("input",this._change),this._form.on("submit",this._submit)}return __extends(i,t),i._destroyPlugin=function(){},i.prototype.destroy=function(){},i.prototype._parseValidations=function(){var t,i,r,n,s,o,a,h;for(s=[],r=this._element.childNodes,t=r.length,o=0,a=r.length;a>o;o++)i=r[o],i.nodeType&&i.nodeType===Node.ELEMENT_NODE&&e["_validate_"+i.tagName.toLowerCase()]&&(n={item:i,type:i.tagName.toLowerCase(),validation:e["_validate_"+i.tagName.toLowerCase()],message:(null!=(h=i.querySelector("message"))?h.innerHTML:void 0)||i.getAttribute("message")||null},s.push(n));return this._validations=s},i.prototype._change=function(){return this._passed?this._validate():void 0},i.prototype._blur=function(){return this._passed=!0,this._validate()},i.prototype._validate=function(){var t,e,i,r,n,s;for(i=this._input.value,t=!0,s=this._validations,r=0,n=s.length;n>r;r++)if(e=s[r],!e.validation(i,e,this._form)){t=!1;break}return t?(this._field.removeClass("invalid"),this._field.addClass("valid"),this._hideMessage()):(this._field.removeClass("valid"),this._field.addClass("invalid"),e.message&&this._showMessage(e.message)),t},i.prototype._showMessage=function(t){var e;return e=this._field.find(".validation-message"),e||(e=document.createElement("div"),e.className="validation-message",this._field.appendChild(e)),e.style.display="",e.innerHTML=t},i.prototype._hideMessage=function(){var t;return(t=this._field.find(".validation-message"))?t.style.display="none":void 0},i.prototype._submit=function(t){return this._blur()?void 0:t.preventDefault()},i}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Upload=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="upload",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(){this._dragLeave=__bind(this._dragLeave,this),this._dragEnter=__bind(this._dragEnter,this),this._dragEnd=__bind(this._dragEnd,this),this._dragOver=__bind(this._dragOver,this),this._drop=__bind(this._drop,this),this._fileSelect=__bind(this._fileSelect,this),this._click=__bind(this._click,this),this._filesLoaded=__bind(this._filesLoaded,this),this._fileLoaded=__bind(this._fileLoaded,this),this._loadNextFile=__bind(this._loadNextFile,this),this._parseFiles=__bind(this._parseFiles,this),this._apiCompleted=__bind(this._apiCompleted,this),this._chunkUploadError=__bind(this._chunkUploadError,this),this._chunkUploadComplete=__bind(this._chunkUploadComplete,this),this._chunkProgress=__bind(this._chunkProgress,this),this._apiStarted=__bind(this._apiStarted,this),this._startUpload=__bind(this._startUpload,this),this._remove=__bind(this._remove,this);var t,i,r,n,s;e.__super__.constructor.apply(this,arguments),this._loading=new cms.ui.Loading,this._loading.reset(),this._loading.hide(),this.appendChild(this._loading),t=(this.attr("accept")||"").trim(),this._apiPath=this.attr("api")||app.apiPath+"upload",t&&0!==t.length||(t="*/*"),t=t.split(/,|;/),this._acceptStr=t.join(",");for(n in t)s=t[n],t[n]=s.replace(/\./g,"\\.").replace(/\*/g,"[^/]*").replace(/\//g,"\\/");this._accept=new RegExp("("+t.join("|")+")","i"),this._maxSize=.95*Number(this.attr("maxSize")||2e6),this._input=document.createElement("input"),this._input.setAttribute("name",this.attr("name")),this._input.setAttribute("type","hidden"),this.appendChild(this._input),this._container=document.createElement("div"),this._container.className="container",(r=this.find("placeholder"))&&this._container.appendChild(r),(r=this.find("preview"))&&this._container.appendChild(r),this.appendChild(this._container),this.element.on("drop",this._drop),this.element.on("dragenter",this._dragEnter),this.element.on("dragleave",this._dragLeave),this.element.on("dragover",this._dragOver),this._container.on("click",this._click),this._deleteBtn=document.createElement("a"),this._deleteBtn.className="delete-btn",i=document.createElement("i"),i.className="fa fa-trash text-1",this._deleteBtn.on("click",this._remove),this._deleteBtn.appendChild(i),this.appendChild(this._deleteBtn),this.attr("value")&&this._setValue(this.attr("value"))}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._remove=function(){return this._setValue(null)},e.prototype.upload=function(){return this._uploading?void 0:(this._uploading=!0,this._startUpload())},e.prototype._startUpload=function(){return this._api||(this._apiStarter=new API(this._apiPath+"/start"),this._apiStarter.reuse=!0,this._apiStarter.type="json",this._apiStarter.on(API.COMPLETE,this._apiStarted),this._apiCompleter=new API(this._apiPath+"/complete"),this._apiCompleter.reuse=!0,this._apiCompleter.type="json",this._apiCompleter.on(API.COMPLETE,this._apiCompleted),this._api=new API(this._apiPath),this._api.reuse=!0,this._api.type="binary",this._api.on(API.COMPLETE,this._chunkUploadComplete),this._api.on(API.PROGRESS,this._chunkProgress),this._api.on(API.ERROR,this._chunkUploadError)),this._apiStarter.submit(this._items)},e.prototype._apiStarted=function(t,e){return this._loading.show(),this._uploadId=e.id,this._apiUploadURL=this._apiPath+"/"+this._uploadId+"/",this._splitChunks(),this._uploadNextChunk()},e.prototype._splitChunks=function(){var t,e,i,r,n;for(this._chunks=[],i=0,n=this._buffer.byteLength;n>i;)r=i,e=i+this._maxSize,e>n&&(e=n),t=this._buffer.slice(r,e),this._chunks.push({buffer:t,index:r}),i=e;return this._numChunks=this._chunks.length},e.prototype._chunkProgress=function(t){var e;return e=1-(this._chunks.length+1)/this._numChunks+t.progress/this._numChunks,this._loading.progress=e},e.prototype._uploadNextChunk=function(){var t;return 0===this._chunks.length?void this._completeUpload():(this._loading.progress=1-this._chunks.length/this._numChunks,t=this._chunks.shift(),this._api.url=this._apiUploadURL+t.index,this._api.submit(t.buffer))},e.prototype._chunkUploadComplete=function(){return this._uploadNextChunk()},e.prototype._chunkUploadError=function(){},e.prototype._completeUpload=function(){return this._loading.progress=1,this._loading.hide(),this._apiCompleter.url=this._apiPath+"/complete/"+this._uploadId,this._apiCompleter.submit()},e.prototype._apiCompleted=function(t,e){return this._uploading=!1,this._setValue(e)},e.prototype._setValue=function(t){return t?t.id?this._input.value=t.id:"string"!=typeof t&&isNaN(t)||(this._input.value=t):(this._input.value="__none__",this.removeClass("showPreview")),t&&this.find("preview")&&(this.addClass("showPreview"),app.template.renderBlock(this.find("preview"),t)),this.removeClass("deny"),this.removeClass("accept")},e.prototype._parseFiles=function(t){var e,i,r;for(this._items=[],r=0,i=t.length;i-->0;){if(t[i]instanceof File)e=t[i];else{if(null==t[i].getAsFile)continue;e=t[i].getAsFile()}this._items[i]={name:e.name,size:e.size,file:e,init:r},r+=e.size}return this._totalSize=r,this._buffer=new ArrayBuffer(this._totalSize),this._bufferView=new Uint8Array(this._buffer),this._loadNextFile()},e.prototype._loadNextFile=function(){var t,e,i;for(this._fileReader||(this._fileReader=new FileReader,this._fileReader.addEventListener("load",this._fileLoaded)),t=!0,i=this._items.length;i-->0;)if(this._items[i].file){t=!1,this._currentItem=this._items[i],e=this._currentItem.file,this._fileReader.readAsArrayBuffer(e);break}return t?(this._currentItem=null,this._filesLoaded()):void 0},e.prototype._fileLoaded=function(){return this._currentItem.file=null,this._bufferView.set(new Uint8Array(this._fileReader.result),this._currentItem.init),delete this._currentItem.file,setTimeout(this._loadNextFile,0)},e.prototype._filesLoaded=function(){return this.upload()},e.prototype._click=function(){return this._fileBrowser||(this._fileBrowser=document.createElement("input"),this._fileBrowser.setAttribute("type","file"),this._acceptStr&&(console.log(this._acceptStr),this._fileBrowser.setAttribute("accept",this._acceptStr)),this._fileBrowser.addEventListener("change",this._fileSelect)),this._fileBrowser.click()},e.prototype._fileSelect=function(){return this._fileBrowser.files.length>0?this._parseFiles(this._fileBrowser.files):void 0},e.prototype._drop=function(t){var e,i;return t.preventDefault(),i=t.dataTransfer.items,e=this._checkAccepts(i),e?this._parseFiles(i):1},e.prototype._dragOver=function(t){return t.preventDefault(),t.stopImmediatePropagation()},e.prototype._dragEnd=function(t){var e,i;if(e=t.dataTransfer.items){for(i=[];e.length>0;)i.push(e.remove(0));return i}return t.dataTransfer.clearData()},e.prototype._dragEnter=function(t){var e,i,r;return t.preventDefault(),t.dataTransfer.dropEffect="move",i=t.dataTransfer.items[0].getAsFile(),r=t.dataTransfer.items,e=this._checkAccepts(r),e?(this.removeClass("deny"),this.addClass("accept")):(this.removeClass("accept"),this.addClass("deny"))},e.prototype._dragLeave=function(t){return t.dataTransfer.dropEffect="none",this.removeClass("accept"),this.removeClass("deny")},e.prototype._checkAccepts=function(t){var e,i;for(e=!0,i=t.length,0===i&&(e=!1);i-->0;)if(!this._accept.test(t[i].type)){e=!1;break}return e},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Toggle=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="toggle",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._update=__bind(this._update,this),this._toggle=__bind(this._toggle,this),this._change=__bind(this._change,this),e.__super__.constructor.call(this,{element:t}),this._input=this.find("input"),this._input&&(this.selected=this._input.checked,this._input.on("change",this._update)),this._element.on("click",this._toggle),this._element.on("change",this._change)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._change=function(){var t,e,i,r;if(this._input&&(t=this.findParents("form"))){for(i=t.querySelectorAll('input[name="'+this._input.getAttribute("name")+'"]'),e=i.length,r=[];e-->0;)r.push(i[e]!==this._input?i[e].trigger("change"):void 0);return r}},e.get({selected:function(){return this._selected}}),e.set({selected:function(t){var e;if(t!==this._selected)return this._selected=t,this._element.setAttribute("selected",t),this._element.selected=t,this._input&&(this._input.checked=t,null!=(e=this._input)&&e.trigger("update")),this._element.trigger("change")}}),e.prototype._toggle=function(){var t,e;return"radio"===(null!=(t=this._input)?t.getAttribute("type"):void 0)?void this._input.click():(this.selected=!this._selected,null!=(e=this._input)?e.trigger("change"):void 0)},e.prototype._update=function(t){return null==t&&(t=null),this._input?this.selected=this._input.checked:void 0},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Select=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="select",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(){this._updateTargets=__bind(this._updateTargets,this),this._updated=__bind(this._updated,this);var t,i,r;if(e.__super__.constructor.apply(this,arguments),this.element.on("updated",this._updated),this.attr("update")){for(this._updateParams=[],r=this.attr("update"),i=/\[([^\[\]]+)\]/g;t=i.exec(r);)this._updateParams.push(t[1].split(","));this._updateParams.length>0&&(this.element.on("change",this._updateTargets),setTimeout(this._updateTargets,1))}}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._updated=function(){return setTimeout(this._updateTargets,1)},e.prototype._updateTargets=function(){var t,e,i,r,n,s;if(this._updateParams){for(t=this._updateParams.length,n=this.element.value,s=[];t-->0;)r=this._updateParams[t],e=document.body.querySelectorAll(r[0]),i=e.length,s.push(function(){var t;for(t=[];i-->0;)t.push(e[i].trigger(r[1],n));return t}());return s}},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Form=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="form",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._clearMessage=__bind(this._clearMessage,this),this._apiError=__bind(this._apiError,this),this._apiComplete=__bind(this._apiComplete,this),this._apiStart=__bind(this._apiStart,this),this._resetFields=__bind(this._resetFields,this),this._reset=__bind(this._reset,this),this._submit=__bind(this._submit,this),this._change=__bind(this._change,this),this._abort=__bind(this._abort,this),this._addListeners=__bind(this._addListeners,this),e.__super__.constructor.call(this,{element:t}),setTimeout(this._addListeners,50)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._addListeners=function(){return this._api=new API(this._element),this._element.getAttribute("target")&&"_blank"===this._element.getAttribute("target").toLowerCase()||(this._api.on(API.START,this._apiStart),this._api.on(API.COMPLETE,this._apiComplete),this._api.on(API.ERROR,this._apiError)),this._element.on("submit",this._submit),this._element.on("change",this._change),this._element.on("reset",this._reset),this._element.on("abort",this._abort)},e.prototype._abort=function(){var t;return null!=(t=this._api)?t.abort():void 0},e.prototype._change=function(){return this._clearMessage()},e.prototype._submit=function(t){var e,i;return"_blank"===(null!=(i=this.attr("target"))&&"function"==typeof i.toLowerCase?i.toLowerCase():void 0)?(e=this._api.parseJSON(this._element),this._dataElement||(this._dataElement=document.createElement("textarea"),this._dataElement.name="__data",this._dataElement.style.display="none",this.appendChild(this._dataElement)),this._dataElement.innerHTML=JSON.stringify(e)):(this._clearFieldMessages(),t.defaultPrevented?void t.stopImmediatePropagation():t.preventDefault())},e.prototype._reset=function(){return setTimeout(this._resetFields,0)},e.prototype._resetFields=function(){var t,e,i;for(e=this._element.querySelectorAll("[type=checkbox],[type=radio]"),t=e.length,i=[];t-->0;)i.push(e[t].trigger("change"));return i},e.prototype._apiStart=function(){},e.prototype._apiComplete=function(t,e){var i,r,n;if(this._element.reset(),i=this.attr("success"),i&&i.length>0)switch(i){case"update":this._element.trigger("update");break;case"refresh":app["interface"].show();break;case"reload":window.location.reload();break;default:app.router.goto(i)}return(null!=e&&null!=(r=e.notification)&&null!=(n=r.message)?n.length:void 0)>0?(e.notification.type||(e.notification.type=3),app.notification.showNotification(e.notification)):void 0},e.prototype._apiError=function(t,e){var i,r,n,s,o;if(this._showMessage(null!=e?e.message:void 0),Array.isArray(e.data)){for(s=e.data,o=[],r=0,n=s.length;n>r;r++)i=s[r],o.push((null!=i?i.field:void 0)?this._showFieldMessage(i.field,i.message):void 0);return o}},e.prototype._showFieldMessage=function(t,e,i){var r,n,s;return null==i&&(i=1),r=null!=(s=this.find('[name="'+t+'"]'))?s.findParents("field"):void 0,r&&r.__instance__?(r=r.__instance__,n=r.find(".validation-message"),r.removeClass("valid"),r.addClass("invalid"),n?n=n.__instance__?n.__instance__:new BaseDOM({element:n}):(n=new BaseDOM({element:"div",className:"validation-message"}),r.appendChild(n)),n.css({display:""}),n.html=e,n.element.scrollIntoView()):void 0},e.prototype._clearFieldMessages=function(){var t,e,i,r,n;for(e=this.findAll("field .validation-message"),n=[],i=0,r=e.length;r>i;i++)t=e[i],t=t.__instance__?t.__instance__:new BaseDOM({element:t}),t.css({display:"none"}),t.findParents("field").__instance__.removeClass("invalid"),n.push(t.html="");return n},e.prototype._showMessage=function(t,e){var i,r,n,s,o,a,h,l;if(null==e&&(e=1),!this._messageField){if(!t||0===t.length)return;for(r=this.findAll("validation message"),n=r.length,a=[];n-->0;)a[n]=r[n];for(s=this.findAll("message"),o=[],h=0,l=s.length;l>h;h++)i=s[h],a.indexOf(i)<0&&o.push(i);o.length>0&&(this._messageField=o[0]),this._messageField||(this._messageField=document.createElement("message"),this.appendChildAt(this._messageField,0))}return this._messageField.innerHTML=t,this._messageField.scrollIntoView()},e.prototype._clearMessage=function(){return this._showMessage("")},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Field=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="field",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],i._checkPlugin(e)?this._plugins[e]=new i(e):e.className+=" filled";for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._checkFilled=__bind(this._checkFilled,this),this._change=__bind(this._change,this),this._blur=__bind(this._blur,this),this._focus=__bind(this._focus,this),this._password=__bind(this._password,this),this._passwordPreviewChange=__bind(this._passwordPreviewChange,this);var i,r,n,s,o,a,h,l,u,c;if(e.__super__.constructor.call(this,{element:t}),this._input=this._element.querySelector('input:not([type="hidden"]),select,textarea'),i=this._input.getAttribute("type"),"date"===i||"time"===i)this._checkFilled(!0);else{if(("select"===(r=null!=(n=this._input)?n.tagName.toLowerCase():void 0)||"textarea"===r)&&null!=(s=this._input)&&s.setAttribute("type",null!=(o=this._input)?o.tagName.toLowerCase():void 0),null!=(a=this._input)?a.hasAttribute("type"):void 0)switch(this.addClass(this._input.getAttribute("type")),this._input.getAttribute("type").toLowerCase()){case"password":this._checkPasswordPreview()}null!=(h=this._input)&&h.on("focus",this._focus),null!=(l=this._input)&&l.on("blur",this._blur),null!=(u=this._input)&&u.on("change",this._change),null!=(c=this._input)&&c.on("input",this._change),setTimeout(this._checkFilled,1)}}return __extends(e,t),e._destroyPlugin=function(){},e._checkPlugin=function(t){var e;return e=t.querySelector('input:not([type="hidden"]),select,textarea'),e?e.findParents("field")!==t?!1:!0:!1
},e.prototype._checkPasswordPreview=function(){var t;return(t=this.find(".show-password"))?(this._passwordPreview=t,this._passwordPreview.on("change",this._passwordPreviewChange)):void 0},e.prototype._passwordPreviewChange=function(){var t,e;return this._passwordPreview.selected?null!=(t=this._input)?t.setAttribute("type","text"):void 0:null!=(e=this._input)?e.setAttribute("type","password"):void 0},e.prototype._password=function(t){var e;return null!=(e=this._input)&&(e.type="text"),t.preventDefault(),t.stopImmediatePropagation()},e.prototype._focus=function(){return this._focused=!0,this._checkFilled()},e.prototype._blur=function(){return this._focused=!1,this._checkFilled()},e.prototype._change=function(){return this._checkFilled()},e.prototype._checkFilled=function(t){var e,i,r;return null==t&&(t=!1),this._focused||t?void this.addClass("filled"):(e=null!=(i=this._input)?i.value.trim():void 0,0===e.length?(this.removeClass("filled"),null!=(r=this._input)?r.value=e:void 0):this.addClass("filled"))},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Checkbox=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR='input[type="checkbox"]',e.prototype._update=function(t){var e,i,r,n,s;for(n=t.add,s=[],i=0,r=n.length;r>i;i++)e=n[i],s.push(this._buildCheckbox(e));return s},e.prototype._buildCheckbox=function(t){var e,i,r,n,s,o,a,h,l,u,c;if((0===(c=t.getAttribute("checked"))||"0"===c||c===!1||"false"===c||null===c||"null"===c)&&t.removeAttribute("checked"),h=document.createElement("toggle"),r=document.createElement("default"),a=document.createElement("selected"),n=document.createElement("i"),n.className="fa fa-square-o",r.appendChild(n),n=document.createElement("i"),n.className="fa fa-check-square-o",a.appendChild(n),h.append(r),h.append(a),o=t.parentNode,"field"===t.parentNode.tagName.toLowerCase()){for(i=ArrayUtils.toArray(o.children),l=0,u=i.length;u>l;l++)e=i[l],h.appendChild(e);return o.appendChild(h)}return(s=t.parentNode.querySelector("label"))?(h.appendChild(s),o.insertBefore(h,t),h.appendChild(t)):void 0},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.ButtonFile=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR='button[type="file"]',e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._inputChange=__bind(this._inputChange,this),this._click=__bind(this._click,this);var i,r,n,s,o,a;if(e.__super__.constructor.call(this,{element:t}),r=t.querySelector('input[type="file"]'),!r)for(r=document.createElement("input"),a=t.attributes,s=0,o=a.length;o>s;s++)i=a[s],n=i.name||i.nodeName,r.setAttribute(n,t.getAttribute(n));this._input=r,this._input.className=this._input.className+" hidden-file-input",this._input.on("change",this._inputChange),this._element.parentNode.appendChild(this._input),this._element.on("click",this._click)}return __extends(e,t),e.prototype._click=function(t){return"function"==typeof t.preventDefault&&t.preventDefault(),"function"==typeof t.stopImmediatePropogation&&t.stopImmediatePropogation(),this._input.click()},e.prototype._inputChange=function(){var t;return this._input.files.length>0?(t=this.findParents("form"),t.trigger("submit")):void 0},e.prototype.destroy=function(){return this._input,this._element.off("click",this._click)},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags["interface"].Viewstack=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="viewstack",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._showView=__bind(this._showView,this),e.__super__.constructor.call(this,{element:t}),this.element.on("show",this._showView),this._parseViews()}return __extends(e,t),e.prototype.destroy=function(){return e.__super__.destroy.apply(this,arguments)},e.prototype._showView=function(t){var e;return e=t.data,this.show(e)},e.prototype._parseViews=function(){var t,e,i,r,n,s,o,a,h;for(this._views={},a=this.findAll("view[name]"),e=a.length;e-->0;)o=a[e],n=o.findParents("viewstack"),n===this._element&&(r=o.getAttribute("name"),o.name=r,o.getAttribute("default")&&(this._defaultView=o),this._views[r]=o);this._defaultView||(this._defaultView=o),t=!1,h=slikland.Mara.globals["#"];for(i in h)if(s=h[i],s&&0!==s.length)try{this.matches(i)&&(t=!0,console.log(s),this.show(s))}catch(l){}return t?void 0:this.reset()},e.prototype.reset=function(){return this.show(this._defaultView.name)},e.prototype.show=function(t){var e,i,r,n,s,o,a,h;n=null,h=this._views;for(r in h)if(s=h[r],r===t){if(n=s,s===this._selectedView)continue;s.style.display="",app.template.resetContext(s),app.template.renderBlock(s,s.itemData)}else for(s.style.display="none",i=s.querySelectorAll("form,[action],[service]"),o=0,a=i.length;a>o;o++){e=i[o];try{e.trigger("abort")}catch(l){}}return this._selectedView=n,n},e.prototype.getView=function(t){return this._views[t]},e.prototype.getViews=function(){return this._views},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags["interface"].Tagcloud=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="tagcloud",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._addSuggested=__bind(this._addSuggested,this),this._removeTag=__bind(this._removeTag,this),this._validateComplete=__bind(this._validateComplete,this),this._commitAddTag=__bind(this._commitAddTag,this),this._buttonClick=__bind(this._buttonClick,this),this._keyDown=__bind(this._keyDown,this);var i;e.__super__.constructor.call(this,{element:t}),(i=this.find("add"))&&this._buildAddElement(i),this._values={},this._suggestions={},this._template=this.find("template"),this._container=this.find("content"),this._container||(this._container=document.createElement("content"),this.appendChild(this._container)),this._suggestion=this.find("suggestion"),this.attr("name")&&(this._content=document.createElement("textarea"),this._content.setAttribute("name",this.attr("name")),this._content.style.display="none",this.appendChild(this._content)),this.attr("validateaction")&&(this._validateAction=this.attr("validateaction"))}return __extends(e,t),e.prototype._buildAddElement=function(t){var e,i,r,n;return i=new BaseDOM({element:"group"}),r=new BaseDOM({element:"input",className:"col-1_3"}),e=new BaseDOM({element:"button",className:t.className}),n=t.innerHTML,n&&0!==n.length||(n="Adicionar"),e.html=n,i.appendChild(r),i.appendChild(e),t.parentNode.insertBefore(i.element,t),t.parentNode.removeChild(t),r.element.on("keydown",this._keyDown),e.element.on("click",this._buttonClick),this._input=r.element},e.prototype._keyDown=function(t){return t.stopImmediatePropagation(),13===t.keyCode?(t.preventDefault(),this._addTag()):void 0},e.prototype._buttonClick=function(t){return"function"==typeof t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.preventDefault(),this._addTag()},e.prototype._addTag=function(){var t;return t=this._input.value,t=t.trim(),t=t.replace(/\s+/g," "),this.addTag(t),this._input.value=""},e.prototype._updateValues=function(){var t,e,i,r,n;i=[],r=this._values;for(t in r)e=r[t],i.push(e.value);return null!=(n=this._content)?n.innerHTML=JSON.stringify(i):void 0},e.prototype.removeTag=function(t){var e,i;if(t&&0!==t.trim().length&&(e=t.toLowerCase(),this._values[e]))return i=this._values[e],i.element.parentNode.removeChild(i.element),this._values[e]=null,delete this._values[e]},e.prototype._commitAddTag=function(t){var e,i;return this._template&&(i=t.toLowerCase(),e=this.addItem(t,this._container),this._values[i]={element:e,value:t}),this._input.focus(),this._updateValues()},e.prototype.addSuggestion=function(t){var e,i;return i=t.toLowerCase(),this._suggestions[i]?void 0:(e=this.addItem(t,this._suggestion),this._suggestions[i]={element:e,value:t})},e.prototype.addItem=function(t,e){var i,r,n,s;return n=document.createDocumentFragment(),app.template.renderBlock(this._template,{value:t},n),s=n.querySelector(".remove"),i=n.querySelector(".add"),r=n.querySelector("*"),s&&(s.value=t,s.on("click",this._removeTag)),i&&(i.value=t,i.on("click",this._addSuggested)),e||(e=this._container),e.appendChild(n),r},e.prototype.addTag=function(t){var e;if(t&&0!==t.trim().length&&(e=t.toLowerCase(),!this._values[e]))return this._validateAction?(this._loading||(this._loading=new cms.ui.Loading,this.appendChild(this._loading)),this._input.blur(),this._loading.show(),API.call(this._validateAction,{value:t},this._validateComplete,this._validateComplete)):this._commitAddTag(t)},e.prototype._validateComplete=function(t,e){var i,r,n,s;if(this._loading.hide(),e.suggestions)for(s=e.suggestions,r=0,n=s.length;n>r;r++)i=s[r],this.addSuggestion(i);return(null==(null!=e?e.confirm:void 0)||window.confirm(e.confirm))&&e.value?this._commitAddTag(e.value):void 0},e.prototype._removeTag=function(t){var e,i;return e=t.currentTarget,i=e.value,this.removeTag(i)},e.prototype._addSuggested=function(t){var e,i,r,n,s;return r=t.currentTarget,n=r.value,i=n.toLowerCase(),e=this._suggestions[i],e&&null!=(s=e.element.parentNode)&&s.removeChild(e.element),this.addTag(n),this._suggestions[i]=null,delete this._suggestions[i]},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags["interface"].Tabs=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="tabs",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._update=__bind(this._update,this),this._tabClick=__bind(this._tabClick,this),this._updateTargets=__bind(this._updateTargets,this);var i,r,n;if(e.__super__.constructor.call(this,{element:t}),this.attr("update")){for(this._updateParams=[],n=this.attr("update"),r=/\[([^\[\]]+)\]/g;i=r.exec(n);)this._updateParams.push(i[1].split(","));this._updateParams.length>0&&(this.element.on("change",this._updateTargets),setTimeout(this._updateTargets,1))}this._parseTabs()}return __extends(e,t),e.prototype._updateTargets=function(){var t,e,i,r,n,s;for(t=this._updateParams.length,n=this.element.value,s=[];t-->0;)r=this._updateParams[t],e=document.body.querySelectorAll(r[0]),i=e.length,s.push(function(){var t;for(t=[];i-->0;)t.push(e[i].trigger(r[1],n));return t}());return s},e.prototype._parseTabs=function(){var t,e,i,r,n,s,o,a;for(n="tab_"+Date.now()+"_"+Math.random(),s=this._element.querySelectorAll("tab"),e=s.length,this._tabs=[];e-->0;)r=s[e],r.on("click",this._tabClick),this._tabs[e]=r;t=!1,a=slikland.Mara.globals["#"];for(i in a)if(o=a[i],o&&0!==o.length)try{this.matches(i)&&(t=!0,this._select(o))}catch(h){}return t?void 0:this._select(this._tabs[0].getAttribute("name"))},e.prototype._tabClick=function(t){return this.attr("id")&&app.router.setHash("#"+this.attr("id"),t.currentTarget.getAttribute("name")),this._select(t.currentTarget.getAttribute("name"))},e.prototype._select=function(t){var e;for(e=this._tabs.length;e-->0;)this._tabs[e].className=this._tabs[e].getAttribute("name")===t?"selected":"";return this.element.value=t,this._updateTargets()},e.prototype._update=function(){},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags["interface"].Renderer=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="renderer",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._update=__bind(this._update,this),e.__super__.constructor.call(this,{element:t}),this.element.on("update",this._update)}return __extends(e,t),e.prototype._update=function(t,e){return app.template.renderBlock(this.elemnet,e)},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags["interface"].NavLink=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="nav ul a",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._routeChange=__bind(this._routeChange,this),this._parseItems=__bind(this._parseItems,this),e.__super__.constructor.call(this,{element:t}),app.router.on(NavigationRouter.CHANGE,this._routeChange),setTimeout(this._routeChange,1)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype.destroy=function(){return e.__super__.destroy.apply(this,arguments),app.router.off(NavigationRouter.CHANGE,this._routeChange)},e.prototype._parseItems=function(){},e.prototype._routeChange=function(){var t,e;return t=app.router.getCurrentPath().trim("/").replace(/\?.*?$/,""),e=this.attr("href").trim("/"),this.toggleClass("selected",t===e)},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.visualizer.ChartHelper=function(_super){function ChartHelper(){return ChartHelper.__super__.constructor.apply(this,arguments)}var Plugin;return __extends(ChartHelper,_super),ChartHelper.SELECTOR="chart",ChartHelper.prototype._update=function(t){var e,i,r,n,s,o,a,h,l;for(a=t.add,r=0,s=a.length;s>r;r++)e=a[r],this._plugins[e]=new Plugin(e);for(h=t.remove,l=[],n=0,o=h.length;o>n;n++)e=h[n],i=this._plugins[e],l.push(i?"function"==typeof i.destroy?i.destroy():void 0:void 0);return l},Plugin=function(_super1){function Plugin(t){this._labelTooltip=__bind(this._labelTooltip,this),this._labelTooltipTitle=__bind(this._labelTooltipTitle,this),this._resize=__bind(this._resize,this),this._parseFunctions=__bind(this._parseFunctions,this),this._update=__bind(this._update,this);var e,i,r;Plugin.__super__.constructor.call(this,{element:t}),(r=this.attr("width"))&&(/^[\d\.]$/.test(r)&&(r+="px"),this.css("width",r)),(e=this.attr("height"))&&(/^[\d\.]$/.test(e)&&(e+="px"),this.css("height",e)),this._canvas=document.createElement("canvas"),this._canvas.setAttribute("width","100%"),this._canvas.setAttribute("height",400),this._context=this._canvas.getContext("2d"),this._element.on("updated",this._update),window.addEventListener("resize",this._resize),i=t.itemData,i&&null!=i.type&&this._update({data:i})}return __extends(Plugin,_super1),Plugin._destroyPlugin=function(){},Plugin.prototype._update=function(t){var e;return e=t.data,this.appendChild(this._canvas),this._resize(),this._data=e,(!e.options||Array.isArray(e.options))&&(e.options={}),e.options.responsive=!1,e.options.maintainAspectRatio=!1,e.options.tooltips={callbacks:{label:this._labelTooltip,title:this._labelTooltipTitle}},e=this._parseFunctions(e),this._chart=new Chart(this._canvas,e),this._chart.onHover=this._mouseMove,this._chart.onMouseMove=this._mouseMove},Plugin.prototype._parseFunctions=function(data){var k,v;for(k in data)v=data[k],"string"==typeof v?/function\s*\(/.test(v)&&(data[k]=eval("("+v+")")):"object"==typeof v&&(data[k]=this._parseFunctions(v));return data},Plugin.prototype._resize=function(){var t;return t=this.getBounds(),this._canvas.setAttribute("width",t.width),this._canvas.setAttribute("height",t.height),this._canvas.style.width=t.width+"px",this._canvas.style.height=t.height+"px",this._chart?(this._chart.chart.width=t.width,this._chart.chart.height=t.height,this._chart.update(0)):void 0},Plugin.prototype._labelTooltipTitle=function(t,e){var i;return Array.isArray(t)&&(t=t[0]),i=e.datasets[t.datasetIndex].data[t.index],null!=i.title?i.title:""},Plugin.prototype._labelTooltip=function(t,e){var i,r,n,s;if(i=e.datasets[t.datasetIndex].data[t.index],null!=i.label)return i.label;if(Array.isArray(i))return i.join(", ");n=[];for(r in i)s=i[r],"string"!=typeof s&&isNaN(s)||n.push(r+": "+s);return n.join(", ")},Plugin}(BaseDOM),ChartHelper}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.Tooltip=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="tooltip",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._out=__bind(this._out,this),this._over=__bind(this._over,this),e.__super__.constructor.call(this,{element:t}),this._parent=t.parentNode,this._parent.on("mouseover",this._over),this._parent.on("mouseout",this._out)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._over=function(){return this.addClass("show")},e.prototype._out=function(){return this.removeClass("show")},e.prototype.destroy=function(){},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.Pagination=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="pagination",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._update=__bind(this._update,this),this._getClosest=__bind(this._getClosest,this),this._mouseMove=__bind(this._mouseMove,this),this._setSeeking=__bind(this._setSeeking,this),this._startPageSeek=__bind(this._startPageSeek,this),this._stopPageSeek=__bind(this._stopPageSeek,this),this._cancelSeek=__bind(this._cancelSeek,this),this._mouseUp=__bind(this._mouseUp,this),this._keyDown=__bind(this._keyDown,this),this._pageMouseDown=__bind(this._pageMouseDown,this),this._lastClick=__bind(this._lastClick,this),this._nextClick=__bind(this._nextClick,this),this._prevClick=__bind(this._prevClick,this),this._firstClick=__bind(this._firstClick,this),e.__super__.constructor.call(this,{element:t}),this._page=0,this._pages=[],this._pageWrapper=new BaseDOM({element:"div",className:"wrapper"}),this._pageContainer=new BaseDOM({element:"div",className:"page-container"}),this._shadowLeft=new BaseDOM({element:"span",className:"shadow-left"}),this._shadowRight=new BaseDOM({element:"span",className:"shadow-right"}),this._first=new BaseDOM({element:"a",className:"arrow first"}),this._prev=new BaseDOM({element:"a",className:"arrow prev"}),this._next=new BaseDOM({element:"a",className:"arrow next"}),this._last=new BaseDOM({element:"a",className:"arrow last"}),this._first.element.on("click",this._firstClick),this._prev.element.on("click",this._prevClick),this._next.element.on("click",this._nextClick),this._last.element.on("click",this._lastClick),this._first.html="<i />",this._prev.html="<i />",this._next.html="<i />",this._last.html="<i />",this._pageWrapper.appendChild(this._pageContainer),this._pageWrapper.appendChild(this._shadowLeft),this._pageWrapper.appendChild(this._shadowRight),this.appendChild(this._first),this.appendChild(this._prev),this.appendChild(this._pageWrapper),this.appendChild(this._next),this.appendChild(this._last),this._pageContainer.element.on("mousedown",this._pageMouseDown),this._setItemValue(),this.attr("numItems")&&(this.element.numItems=this.attr("numItems")),this._element.on("update",this._update)}return __extends(e,t),e._destroyPlugin=function(){},e.get({page:function(){return this._page}}),e.set({page:function(t){var e,i,r,n,s,o,a,h,l;if(t>=this._total-1?(t=this._total-1,this._last.attr("disabled","1"),this._next.attr("disabled","1")):(this._last.element.removeAttribute("disabled"),this._next.element.removeAttribute("disabled")),0>=t?(t=0,this._first.attr("disabled","1"),this._prev.attr("disabled","1")):(this._first.element.removeAttribute("disabled"),this._prev.element.removeAttribute("disabled")),i=!1,this._page!==t&&(i=!0),this._page=t,this._element.index=this._page*this._numItems,this._element.numItems=this._numItems,KTween.remove(this),o=this._pages[this._page]){for(r=this._pages.length;r-->0;)this._pages[r].className=r===this._page?"hover":"";return s=this._pageContainer.getBounds(),e=o.getBoundingClientRect(),a=this._pageContainer.element.scrollLeft,n=.5*(e.right+e.left)-s.left+a-.25*s.width,n/=this._pageContainer.element.scrollWidth-.5*s.width,0>n?n=0:n>1&&(n=1),a=this._pageContainer.element.scrollLeft,h=this._pageContainer.element.scrollWidth,h-s.width<1?(this._shadowLeft.css("width",0),this._shadowRight.css("width",0)):(this._shadowLeft.css("width",2*n+"em"),this._shadowRight.css("width",2*(1-n)+"em")),KTween.tween(this,{scrollPosition:n,onUpdate:this._test},"easeInOutQuart",.3),i&&null!=(l=this._target)?l.trigger("update"):void 0}}}),e.get({_target:function(){return document.querySelector("#"+this.attr("for"))}}),e.get({total:function(){return this._total}}),e.get({scrollPosition:function(){return this._pageContainer.element.scrollLeft/(this._pageContainer.element.scrollWidth-this._pageContainer.getBounds().width)}}),e.set({scrollPosition:function(t){return this._pageContainer.element.scrollLeft=(this._pageContainer.element.scrollWidth-this._pageContainer.getBounds().width)*t}}),e.prototype._setItemValue=function(){var t,e;return e=this._element.getAttribute("for"),(t=app.router.getParam(e))?(this.attr("numItems")?this._numItems=this.attr("numItems"):t._numItems&&(this._numItems=t._numItems),t._index?(this.page=this._page=t._index/this._numItems,this.element.index=t._index):void 0):void 0},e.prototype._firstClick=function(){return this.page=0},e.prototype._prevClick=function(){return this.page-=1},e.prototype._nextClick=function(){return this.page+=1},e.prototype._lastClick=function(){return this.page=this.total-1},e.prototype._pageMouseDown=function(t){return this._seeking=!1,this._mousePos=MouseUtils.getMousePos(t),window.addEventListener("mouseup",this._mouseUp),window.addEventListener("mousemove",this._mouseMove),window.addEventListener("keydown",this._keyDown),this._startPageSeek(t),t.preventDefault()},e.prototype._keyDown=function(t){return 27===t.keyCode?this._cancelSeek():void 0},e.prototype._mouseUp=function(){return clearTimeout(this._pageSeekTimeout),this._stopPageSeek()},e.prototype._cancelSeek=function(){return window.removeEventListener("mousemove",this._mouseMove),window.removeEventListener("mouseup",this._mouseUp),window.removeEventListener("keydown",this._keyDown),this.removeClass("seeking"),this._seeking=!0,this.page=this._page},e.prototype._stopPageSeek=function(){return window.removeEventListener("mousemove",this._mouseMove),window.removeEventListener("mouseup",this._mouseUp),window.removeEventListener("keydown",this._keyDown),this.removeClass("seeking"),this._seeking=!0,this._closestItem?this.page=this._closestItem.index:void 0},e.prototype._startPageSeek=function(t){return this._pageSeekTimeout=setTimeout(this._setSeeking,100),this._seeking=!0,this._mouseMove(t)},e.prototype._setSeeking=function(){return this.addClass("seeking")},e.prototype._mouseMove=function(t){var e,i,r,n,s,o,a,h,l,u;return this._prevPos=this._mousePos,this._mousePos=MouseUtils.getMousePos(t,!1),this._seeking&&this._prevPos?(e=this._pageWrapper.getBounds(),n=MouseUtils.toGlobal(e.left,e.top),s=(this._prevPos[0]-n[0])/e.width,i=(this._mousePos[0]-n[0])/e.width,0>s?s=0:s>1&&(s=1),0>i?i=0:i>1&&(i=1),u=s,r=(i-s)*e.width,h=this._pageContainer.element.scrollLeft,o=this._pageContainer.element.scrollWidth,r>0?(u=1-u,l=o-h-e.width*u):l=h+e.width*u,r/=e.width*u,a=h+r*l,0>a?a=0:a>o-e.width&&(a=o-e.width),this._pageContainer.element.scrollLeft+=r*l,this._getClosest()):void 0},e.prototype._getClosest=function(){var t,e,i,r,n,s,o,a,h,l;for(l=[].concat(this._mousePos),a=this._pageWrapper.getBounds(),h=MouseUtils.toGlobal(a.left,a.top),l=[l[0]-h[0],l[1]-h[1]],s=this._pages.length,r=Number.MAX_VALUE,e=null;s-->0;)o=this._pages[s],t=o.getBoundingClientRect(),i=.5*(t.right+t.left)-a.left,n=i-l[0],n*=n,o.className="",r>n&&(r=n,e=o);return e?(e.className="hover",this._closestItem=e):void 0},e.prototype._update=function(t){var e,i,r,n;if(e=t.data,e&&null!=e.total&&null!=e.numItems){for(this._pageContainer.removeAll(),this._pages.length=0,r=Math.ceil(e.total/e.numItems),this._total=r,this._numItems=e.numItems,0===this._total?this.css("display","none"):this.css("display",""),i=-1;++i<r;)n=document.createElement("a"),n.innerHTML=i+1,n.index=i,this._pageContainer.appendChild(n),this._pages[i]=n;return this.page=this._page=Math.floor(e.index/e.numItems)}},e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.form.Figure=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="figure",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){e.__super__.constructor.call(this,{element:t}),this.css("background-image","url("+this.attr("src")+")")}return __extends(e,t),e}(BaseDOM),e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.visualizer.ChartistHelper=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="chartist",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],this._plugins[e]=new i(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._resize=__bind(this._resize,this),this._update=__bind(this._update,this);var i,r;e.__super__.constructor.call(this,{element:t}),(r=this.attr("width"))&&(/^[\d\.]$/.test(r)&&(r+="px"),this.css("width",r)),(i=this.attr("height"))&&(/^[\d\.]$/.test(i)&&(i+="px"),this.css("height",i)),this._element.on("updated",this._update),window.addEventListener("resize",this._resize)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._update=function(t){var e,i;if(i=t.data,!Chartist[i.type])throw new Error("Chart not found");return e=Chartist[i.type],this._chart=new e(this.element,i.data,i.options)},e.prototype._resize=function(){},e}(BaseDOM),e}(cms.ui.Base);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.ui.tags.Card=function(t){function e(){this._resize=__bind(this._resize,this),this._update=__bind(this._update,this),e.__super__.constructor.apply(this,arguments),window.addEventListener("resize",this._resize),app.on("redraw",this._update)}return __extends(e,t),e.SELECTOR="card",e.prototype._update=function(){return setTimeout(this._resize,0),setTimeout(this._resize,500)},e.prototype._resize=function(){var t,e,i,r,n,s,o,a,h,l,u,c,d,_,p,f,g,m;for(i=document.querySelectorAll("card.even-height"),g=[],n=[],c=i.length;c-->0;)e=i[c],e.style.height="",l=e.querySelector("header"),a=e.querySelector("footer"),s=e.querySelector("content"),null!=l&&(l.style.height=""),null!=s&&(s.style.height=""),null!=a&&(a.style.height=""),f=e.parentNode,g.indexOf(f)<0&&g.push(f),p=g.indexOf(f),n[p]||(n[p]={height:0,children:[]}),t=e.getBoundingClientRect(),h=t.bottom-t.top,n[p].height<h&&(n[p].height=h),n[p].children.push(e);for(c=g.length,m=[];c-->0;)d=n[c],_=d.children.length,h=d.height,m.push(function(){var t;for(t=[];_-->0;)r=d.children[_],r.style.height=h+"px",l=r.querySelector("header"),a=r.querySelector("footer"),s=r.querySelector("content"),u=0,o=0,l&&(u=l.getBoundingClientRect(),u=u.bottom-u.top),a&&(o=a.getBoundingClientRect(),o=o.bottom-o.top),t.push(s?s.style.height=h-u-o+"px":void 0);return t}());return m},e}(cms.ui.Base);var __hasProp={}.hasOwnProperty;cms.ui.tags.Back=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.SELECTOR="back",e.prototype._update=function(t){var e,r,n,s,o,a,h,l,u;for(h=t.add,n=0,o=h.length;o>n;n++)e=h[n],app.main.hasHistory?this._plugins[e]=new i(e):null!=e&&e.parentNode.removeChild(e);for(l=t.remove,u=[],s=0,a=l.length;a>s;s++)e=l[s],r=this._plugins[e],u.push(r?"function"==typeof r.destroy?r.destroy():void 0:void 0);return u},i=function(t){function e(t){this._click=__bind(this._click,this),e.__super__.constructor.call(this,{element:t}),this._element.on("click",this._click)}return __extends(e,t),e._destroyPlugin=function(){},e.prototype._click=function(){return app.trigger("back")},e}(BaseDOM),e}(cms.ui.Base);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.ui.UI=function(){function t(){this._updateInstances=__bind(this._updateInstances,this),this._domChanged=__bind(this._domChanged,this),this._initListeners=__bind(this._initListeners,this),this._registerUIs=__bind(this._registerUIs,this),this._instances=[],setTimeout(this._registerUIs,0)}return t.set({_dirty:function(t){this._updateInstances()}}),t.prototype._registerUIs=function(){return this._parseUIs(cms.ui,!0),this._initListeners()},t.prototype._parseUIs=function(t,e){var i,r,n;null==e&&(e=!1),n=[];for(r in t)i=t[r],n.push(i instanceof Function?e?void 0:this._instances.push(new i):this._parseUIs(i));return n},t.prototype._initListeners=function(){return MutationObserver?(this._mutationObserver=new MutationObserver(this._domChanged),this._mutationObserver.observe(document.body,{childList:!0,subtree:!0})):target.addEventListener("DOMSubtreeModified",this._domChanged),this._domChanged()},t.prototype._domChanged=function(){return this._dirty=!0},t.prototype._updateInstances=function(){var t,e;for(t=this._instances.length,e=[];t-->0;)e.push(this._instances[t].update());return e},t}();var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.ui.tags.Tag=function(t){function e(){return this._setupTag=__bind(this._setupTag,this),e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.SELECTOR="tag",e.prototype._update=function(t){var e,i,r,n,s,o,a,h,l;for(a=t.add,r=0,s=a.length;s>r;r++)e=a[r],this._setupTag(e);for(h=t.remove,l=[],n=0,o=h.length;o>n;n++)e=h[n],i=this._plugins[e],l.push(i?"function"==typeof i.destroy?i.destroy():void 0:void 0);return l},e.prototype._setupTag=function(t){var e;return e=t.getAttribute("color"),e?(t.style["background-color"]=e,t.style["border-color"]=e,t.style["box-shadow"]="inset 1px 1px 1px "+e+", inset -1px -1px 1px "+e):void 0},e}(cms.ui.Base);var Notification;Notification=function(t){function e(){this._hideNotification=__bind(this._hideNotification,this),this._showNotification=__bind(this._showNotification,this),this.showNotification=__bind(this.showNotification,this),this.showNotifications=__bind(this.showNotifications,this),e.__super__.constructor.apply(this,arguments)}var i;return __extends(e,t),e.DEFAULT_TIMEOUT=4,e.prototype.destroy=function(){},e.prototype.showNotifications=function(t){var e,i,r,n,s;for(t=[].concat(t),e=t.length,s=[],r=0,n=t.length;n>r;r++)i=t[r],s.push(null!=i.delay?setTimeout(this.showNotification,1e3*i.delay,i):this.showNotification(i));
return s},e.prototype.showNotification=function(t){var e;if("string"==typeof t){if(0===t.length)return}else{if(null==t.message)return;if(0===t.message.length)return}return e=document.querySelector("notification"),e||(e=document.body),e=("function"==typeof e.getInstance?e.getInstance():void 0)?e.getInstance():new BaseDOM({element:e}),t=new i(t),e.appendChildAt(t),t.element.scrollIntoView()},e.prototype._showNotification=function(t,e){return e=[].concat(e)},e.prototype._hideNotification=function(){},i=function(t){function i(t){this._closeClick=__bind(this._closeClick,this),this._hideNotification=__bind(this._hideNotification,this),i.__super__.constructor.call(this,{element:"div",className:"notification-item show-down"}),"string"==typeof t&&(t={message:t}),t.message&&(this.text=t.message),this.addClass(t.type?"p"+t.type:"p3"),this.timeout=e.DEFAULT_TIMEOUT,t.timeout&&(this.timeout=Number(t.timeout)),this.timeout>0&&(this._closeTimeout=setTimeout(this._hideNotification,1e3*this.timeout)),this.closeBtn=new BaseDOM({element:"i",className:"closeBtn fa fa-close"}),this.closeBtn.element.on("click",this._closeClick),this.appendChild(this.closeBtn)}return __extends(i,t),i.prototype._hideNotification=function(){return this._hide()},i.prototype._hide=function(){return clearTimeout(this._closeTimeout),this.element.parentNode.removeChild(this.element),"function"==typeof this.destroy?this.destroy():void 0},i.prototype._closeClick=function(){return this._hide()},i}(BaseDOM),e}(EventDispatcher);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};cms.ui.Loading=function(t){function e(){this._hideComplete=__bind(this._hideComplete,this),this._hideStart=__bind(this._hideStart,this),e.__super__.constructor.call(this,{element:"loading"}),this._progress=this._currentPosition=0,this._showPosition=0,this._element.removable=!1,this._background=new BaseDOM({element:"div",className:"background"}),this._progressBar=new BaseDOM({element:"div",className:"progress-bar"}),this.appendChild(this._background),this.appendChild(this._progressBar)}return __extends(e,t),e.HIDE_COMPLETE="loading_hideComplete",e.get({progress:function(){return this._progress}}),e.set({progress:function(t){return 0>t?t=0:t>1&&(t=1),this._progress=t,KTween.remove(this,"_position"),KTween.tween(this,{_position:this._progress},"easeOutQuart",.3)}}),e.get({_position:function(){return this._currentPosition}}),e.set({_position:function(t){return 0>t?t=0:t>1&&(t=1),this._currentPosition=t,this._progressBar.css({width:100*t+"%"})}}),e.get({showPosition:function(){return this._showPosition}}),e.set({showPosition:function(t){var e;return 0>t?t=0:t>1&&(t=1),this._showPosition=t,e=2*t-1,0>e?e=0:e>1&&(e=1),this._background.css({opacity:e}),this._progressBar.css({height:4*t+"px"})}}),e.prototype.reset=function(){return KTween.remove(this),this.showPosition=0,this.progress=this._position=0},e.prototype.show=function(){return this.css({visibility:""}),this.reset(),this.removeClass("disabled"),KTween.tween(this,{showPosition:1},"easeOutQuart",.1)},e.prototype.hide=function(){return this.addClass("disabled"),this.progress=1,KTween.remove(this,"_position"),KTween.tween(this,{_position:this._progress,onComplete:this._hideStart},"easeOutQuart",.2)},e.prototype._hideStart=function(){return KTween.remove(this,"showPosition"),KTween.tween(this,{showPosition:0,onComplete:this._hideComplete},"easeOutQuart",.1)},e.prototype._hideComplete=function(){return this.css({visibility:"hidden"}),this.trigger(this.HIDE_COMPLETE)},e}(BaseDOM);var Blocker;Blocker=function(t){function e(){this._transitionEnd=__bind(this._transitionEnd,this),e.__super__.constructor.call(this,{element:"div",className:"blocker"}),this.css({display:"none"}),this.element.on("transitionend",this._transitionEnd),this.element.on("moztransitionend",this._transitionEnd),this.element.on("otransitionend",this._transitionEnd),this.element.on("webkittransitionend",this._transitionEnd),this._showing=!1}return __extends(e,t),e.prototype.show=function(t){return null==t&&(t=!0),this._showing=!0,this.element.parentNode||document.body.appendChild(this.element),this.css({display:"block"}),this.addClass("show")},e.prototype.hide=function(){return this._showing=!1,this.removeClass("show")},e.prototype._transitionEnd=function(){return this._showing?void 0:this.css({display:"none"})},e}(BaseDOM);var __bind=function(t,e){return function(){return t.apply(e,arguments)}};slikland.mara.Block=function(){function Block(t,e){if(this._renderLoadedBlock=__bind(this._renderLoadedBlock,this),this._replaceObject=__bind(this._replaceObject,this),this._maraId=this.constructor._MARA_ID++,this.constructor._registerBlock(this),this._file=e,this._type=null,this._instance=null,this._renderQueue=[],t=this.constructor._INSTRUCTION_RE.exec(t),"#"===t[1])throw new Error("Comment line");this._parseInstruction(t)}var k,v,_ref;Block._INSTRUCTION_RE=/^([\(\#\@\>\<])?([^\:]*?)?(?:(?::)(.*?)(?:\#{([^\#\{\}\'\"]*?)})?)?\s*$/m,Block.TYPES={1:"NORMAL",2:"CONDITIONAL",3:"REFERENCE",4:"INSTANCE",5:"FILE"},Block._blocks={},Block._MARA_ID=1,_ref=Block.TYPES;for(k in _ref)v=_ref[k],Block.TYPES[v]=Number(k);return Block._registerBlock=function(t){return this._blocks[t.maraId]=t},Block.findBlock=function(t){return t=Number(t),this._blocks[t]},Block.get({maraId:function(){return this._maraId}}),Block.get({file:function(){return this._file}}),Block.get({name:function(){return this._instance?this._instance:null}}),Block.get({children:function(){return this._children}}),Block.set({children:function(t){var e,i;if(!t||!Array.isArray(t))throw new Error("slikland.mara.Block children needs to be an Array");for(e=0,i=t.length;i>e;e++)if(v=t[e],!(v instanceof Block))throw new Error("slikland.mara.Block children needs to be an Array of slikland.mara.Block");return this._children=t}}),Block.get({type:function(){return this._type}}),Block.prototype.toValue=function(){var t;switch(t={},this._type){case 2:t.condition=this._condition;break;case 3:t.reference=this._reference;break;case 4:t.instance=this._instance;break;case 5:t.file=this._file,this._reference&&(t.reference=this._reference);break;default:t.tag=this._tag}return t.type=this.constructor.TYPES[this._type],t.data=this._data,t},Block.prototype.duplicate=function(t,e){return this.render(e,t)},Block.prototype._parseInstruction=function(t){var e,i,r,n,s,o,a;switch(s=t[2]||"",this._attributes=t[3]||"",this._data=t[4]||"",t[1]){case"(":o=this.constructor.TYPES.CONDITIONAL,s=s.replace(/\)\s*$/,""),this._condition=s;break;case">":o=this.constructor.TYPES.REFERENCE,this._reference=s;break;case"<":o=this.constructor.TYPES.INSTANCE,this._instance=s;break;case"@":o=this.constructor.TYPES.FILE,n=/(.*?)(?:(?:\>)(.*?))?$/.exec(s),this._file=n[1],(null!=(a=n[2])?a.length:void 0)>0&&(this._reference=n[2]);break;default:for(o=this.constructor.TYPES.NORMAL,r=/(#|.)([^\#\.]+)/g,i=null,e=[];n=r.exec(s);)switch(n[1]){case"#":i=n[2];break;case".":e.push(n[2])}i&&(this._id=i),e&&(this._classes=e),s=s.replace(/[#.].*?$/,""),this._tag=s}return this._type=o},Block.prototype._parseObjectString=function(object,data,test){var e,glob,replaceObject,_ref1;null==data&&(data={}),null==test&&(test=!1),glob=slikland.Mara.globals,replaceObject=object.replace(/\#\{(\$|\@)([^\}\}\#]+)\}/g,"(glob['$1']['$2'] || '')"),replaceObject=replaceObject.replace(/\#\{([^\}\}\#]+)\}/g,"(data['$1'] || '')").replace(/\#\{\}/g,"(data || '')");try{object=eval("(function(){return ("+replaceObject+");})();")}catch(_error){}if(test)return Boolean(object);"string"!=typeof object&&(object=JSON.stringify(object));try{object=this._replaceString(object,data),object=JSON.parse(object)}catch(_error){e=_error,object=object?{html:object}:{}}return("string"==(_ref1=typeof object)||"number"===_ref1)&&(object={html:object}),object},Block.prototype._replaceString=function(t,e){return this._currentReplaceObjectData=e,t=t.replace(/\(glob\[\'(.*?)\'\]\[\'([^\s]+)\'\] \|\| \'\'\)/g,"#{$1$2}"),t=t.replace(/\(data\[\'(.*?)\'\]\ \|\| \'\'\)/g,"#{$1}"),t=t.replace(/\(data \|\| \'\'\)/g,"#{}"),t=t.replace(/\#\{(\$|\@)?([^\}\}\#]+)?\}/g,this._replaceObject)},Block.prototype._replaceObject=function(t,e,i){var r;return r=null,e&&e.length>0?i&&(r=ObjectUtils.find(slikland.Mara.globals[e],i)):r=i?ObjectUtils.find(this._currentReplaceObjectData,i):this._currentReplaceObjectData,null==r&&(r=""),r},Block.prototype.render=function(t,e,i){var r,n,s,o,a,h,l,u,c;if(null==e&&(e=null),null==i&&(i=!1),e||(e=document.createElement("div")),s=i?[t,e]:"function"==typeof this[u="_render_"+this.constructor.TYPES[this._type]]?this[u](t,e):void 0)for(s[1]&&s[1]instanceof Node&&(s=[s]),o=0,h=s.length;h>o;o++)if(n=s[o],t=n[0],e=n[1],this._children)for(c=this._children,a=0,l=c.length;l>a;a++)r=c[a],r.render(t,e);return s},Block.prototype._render_NORMAL=function(t,e){var i,r,n,s,o,a,h,l,u,c;if(!this._tag)return[t,e];if(a=t,this._data&&this._data.length>0&&(a=null!=a?a[this._data]:void 0),h=[],a)for(a=[].concat(a),l=0,u=a.length;u>l;l++){o=a[l],n=document.createElement(this._tag),r=this._parseObjectString(this._attributes,o),s=null,r.html?s=r.html:r.text?s=r.text:r.content&&(s=r.content,delete r.content),delete r.html,delete r.text,s&&(n.innerHTML=s);for(k in r)v=r[k],("string"==(c=typeof k)||"number"===c)&&v&&n.setAttribute(k,v);n.itemData=o,n.data=t,n.setAttribute("mara",this._maraId),this._id&&n.setAttribute("id",this._id),this._classes&&(i=n.className||"",i=i.split(" "),i=[].concat(i,this._classes),n.className=i.join(" ")),e.appendChild(n),h.push([o,n])}return h},Block.prototype._renderLoadedBlock=function(t){var e,i,r,n,s,o,a,h,l,u,c,d,_,p,f;for(f=this._renderQueue,c=0,_=f.length;_>c;c++){if(u=f[c],n=u.data,r=u.context,a=n,this._data&&this._data.length>0&&(a=null!=a?a[this._data]:void 0),a)for(a=[].concat(a),d=0,p=a.length;p>d;d++)o=a[d],t.render(o,r);for(h=r.parentNode,i=r.childNodes,l=r,s=i.length;s-->0;)e=i[s],e&&(l?h.insertBefore(e,l):h.appendChild(e),l=e);h.removeChild(r)}return this._renderQueue.length=0},Block.prototype._render_FILE=function(t,e){var i,r;i=document.createElement("div"),i.style.display="none",e.appendChild(i),this._renderQueue.push({data:t,context:i}),r=this._file,this._reference&&(r+=">"+this._reference);try{r=this._replaceString(r,t),slikland.mara.Templates.getInstance().get(r,this._renderLoadedBlock)}catch(n){}return[[t,i]]},Block.prototype._render_INSTANCE=function(t,e){return[[t,e]]},Block.prototype._render_REFERENCE=function(t,e){var i;return i=document.createElement("div"),i.style.display="none",e.appendChild(i),this._renderQueue.push({data:t,context:i}),slikland.mara.Templates.getInstance().get(this._file+">"+this._reference,this._renderLoadedBlock),[[t,i]]},Block.prototype._render_CONDITIONAL=function(t,e){return this._parseObjectString(this._condition,t,!0)?[[t,e]]:!1},Block}();var __bind=function(t,e){return function(){return t.apply(e,arguments)}};slikland.mara.Templates=function(){function t(t){null==t&&(t=null),this._fileLoaded=__bind(this._fileLoaded,this),this._checkCallbacks=__bind(this._checkCallbacks,this),this._callCallback=__bind(this._callCallback,this),this._templates=[],this._rootPath="",this._callbacks=[],t&&(this.rootPath=t)}return t.getInstance=function(){return null!=t._instance?t._instance:t._instance=function(t,e,i){i.prototype=t.prototype;var r=new i,n=t.apply(r,e);return Object(n)===n?n:r}(t,arguments,function(){})},t.get({rootPath:function(){return this._rootPath}}),t.set({rootPath:function(t){return"string"==typeof t?(t=t.trim().rtrim("/"),t.length>0&&(t+="/"),this._rootPath=t):void 0}}),t.prototype._addInstance=function(t){return this._templates.push(t)},t.prototype._findInstance=function(t,e){var i,r,n;for(null==e&&(e=null),n=/(.*?)(?:(?:\>)(.*?))?$/.exec(t),t=n[1],!e&&n[2]&&(e=n[2]),r=this._templates.length;r-->0;)if(i=this._templates[r],i.file===t&&i.name===e)return i;return null},t.prototype.get=function(t,e){var i;return i=this._findInstance(t),i?setTimeout(this._callCallback,0,e,i):(this._callbacks.push({file:t,callback:e}),this.load(t))},t.prototype._callCallback=function(t,e){return"function"==typeof t?t(e):void 0},t.prototype.load=function(t){var e,i;return e=/(.*?)(?:(?:\>)(.*?))?$/.exec(t),t=e[1],t=t.trim(),t.length<2?void 0:(/\.mara$/i.test(t)||(t+=".mara"),i="/"===t.charAt(0)?t:this._rootPath+t,API.call(i,{file:t},this._fileLoaded))},t.prototype._checkCallbacks=function(){var t,e,i,r,n,s;for(r=this._callbacks.length,s=[];r-->0;)n=this._callbacks[r],i=n.file,e=n.callback,t=this._findInstance(i),t?("function"==typeof e&&e(t),s.push(this._callbacks.splice(r,1))):s.push(void 0);return s},t.prototype._fileLoaded=function(t,e){return this._parse(e,t.currentTarget.data.file),this._checkCallbacks()},t.prototype._parse=function(t,e){var i,r;return null==e&&(e=""),e=e.replace(/\.mara$/,""),r=this._parseBlocks(t+"\n",e),r.length>1?(i=new slikland.mara.Block("",e),i.children=r):i=1===r.length?r[0]:new slikland.mara.Block("",e),this._addInstance(i)},t.prototype._removeIndent=function(t){var e,i,r,n,s;for(r=Number.MAX_VALUE,i=null,n=/^(\s*)[^\s].*?$/gm;s=n.exec(t);)e=s[1],e.length<r&&(r=e.length,i=e);return i&&(t=t.replace(new RegExp("^"+i,"gm"),"")),t},t.prototype._parseBlocks=function(t,e){var i,r,n,s,o,a,h;for(null==e&&(e=""),t=this._removeIndent(t.replace(/^\s*\n/gm,"")),r=/(\s*)([^\s].*?\n)((?:^\1[ |\t]+[^\n]*?(?:\n|$))*)/gm,n=[];h=r.exec(t);){try{i=new slikland.mara.Block(h[2],e)}catch(l){a=l;continue}i.type===slikland.mara.Block.TYPES.INSTANCE?this._addInstance(i):n.push(i),o=h[3],o.length>0&&(s=this._parseBlocks(o,e),i.children=s)}return n},t}();var __bind=function(t,e){return function(){return t.apply(e,arguments)}};slikland.Mara=function(t){function e(t){null==t&&(t=null),this._referenceLoaded=__bind(this._referenceLoaded,this),this._removeChildren=__bind(this._removeChildren,this),this._showContext=__bind(this._showContext,this),this._holdContextToRender=__bind(this._holdContextToRender,this),this._templateLoaded=__bind(this._templateLoaded,this),this._templates=slikland.mara.Templates.getInstance(t)}var i,r,n;return __extends(e,t),e.RENDERED="mara_rendered",e._rootPath="",e.globals={},e.setGlobalObject=function(t,e){return this.globals[t]=e},e.getGlobal=function(t){return this.globals[t]},e.setRootPath=function(t){return this._rootPath=t},i=[],n=null,r=null,e.get({name:function(){return n}}),e.get({id:function(){return r}}),e.get({children:function(){return[].concat(i)}}),e.prototype.isCurrent=function(t){var e,i,r;return e=(null!=(i=this._renderData)?i.file:void 0)||(null!=(r=this._block)?r.file:void 0)||"",t===e},e.prototype.render=function(t,e,i,r){return null==e&&(e={}),null==i&&(i=null),null==r&&(r=null),(null!=i?i.element:void 0)&&(i=i.element),this._renderData={file:t,data:e,context:i,callback:r},i&&i.setAttribute("loading","true"),this._templates.get(t,this._templateLoaded)},e.prototype.reset=function(){return this._renderData=null},e.prototype._templateLoaded=function(t){var e,i;if(this._renderData)return this._renderData.context&&(this._renderData.context.removeAttribute("loading"),this._resetContext(this._renderData.context),this._holdContextToRender(this._renderData.context)),e=t.render(this._renderData.data,this._renderData.context),this._block=t,"function"==typeof(i=this._renderData).callback?i.callback(e,this._block):void 0},e.prototype._holdContextToRender=function(t){return t.style.visibility="hidden",setTimeout(this._showContext,1,t)},e.prototype._showContext=function(t){return t.style.visibility=""},e.prototype._resetContext=function(t){var e,i,r;for(e=t.childNodes,i=e.length,r=[];i-->0;)r[i]=e[i],r[i].style.display="none";return setTimeout(this._removeChildren,0,t,r)},e.prototype.resetContext=function(t){var e,i,r,n;for(e=t.childNodes,i=e.length,n=[];i-->0;)(null!=(r=e[i])?r.removable:void 0)!==!1&&n.push(t.removeChild(e[i]));return n},e.prototype._removeChildren=function(t,e){var i,r;for(i=e.length,r=[];i-->0;)e[i].removable!==!1&&r.push(t.removeChild(e[i]));return r},e.prototype.renderBlockByReference=function(t,e,i,r){return null==i&&(i=!1),null==r&&(r=null),this._renderData.callback=r,this._templates.get(this._renderData.file+t,this._referenceLoaded)},e.prototype._referenceLoaded=function(t){var e,i;if(this._renderData)return e=t.render(this._renderData.data),this._renderData.context.appendChild(e[0][1]),this._block=t,"function"==typeof(i=this._renderData).callback?i.callback(e,this._block):void 0},e.prototype.renderBlock=function(t,e,i){var r,n;return null==i&&(i=null),t instanceof HTMLElement&&t.getAttribute("mara")?(i||(this._resetContext(t),i=t),r=slikland.mara.Block.findBlock(t.getAttribute("mara")),n=r.render(e,i,!0),app.trigger("redraw"),n):void 0},e.prototype.find=function(){},e.prototype.findAll=function(){},e.prototype.vilha=e.prototype.render,e}(EventDispatcher);var Main;Main=function(){function t(){this._renderTemplate=__bind(this._renderTemplate,this),this._loadComplete=__bind(this._loadComplete,this),this._error=__bind(this._error,this),this._indexComplete=__bind(this._indexComplete,this),this._goBack=__bind(this._goBack,this),this._routeChange=__bind(this._routeChange,this),this._init=__bind(this._init,this),this._history=[],new cms.ui.UI,app.body=new BaseDOM({element:document.body}),app.rootPath=window.rootPath||"../",app.apiPath=window.apiPath||app.rootPath+"api/",app.template=new slikland.Mara("templates/"),slikland.Mara.setGlobalObject("@",app),app.templateContext=document.body,app.user=new User,app["interface"]=new cms.core.InterfaceController,setTimeout(this._init,0),app.on(t.RENDER_TEMPLATE,this._renderTemplate),app.router=new NavigationRouter(app.basePath),app.router.on(NavigationRouter.CHANGE,this._routeChange),app.router.setup(app.basePath),app.notification=new Notification,app.main=this,app.on("back",this._goBack)}return t.RENDER_TEMPLATE="app_renderTemplate",t.get({hasHistory:function(){return this._history.length>1}}),t.prototype._init=function(){return app.body.css("visibility","")},t.prototype._routeChange=function(t,e){return this._history.push(e),app["interface"].show()},t.prototype._goBack=function(){var t;if(!(this._history.length<2))return t=this._history.pop(),t=this._history.pop(),app.router.goto(t.rawPath)},t.prototype._indexComplete=function(){},t.prototype._error=function(){},t.prototype._loadComplete=function(){},t.prototype._renderTemplate=function(t,e){var i;return console.log("> render",e),e.target&&e.currentTarget&&(i=e.currentTarget.findParents(e.target),i||(i=document.body.querySelector(e.target))),app.template.render(e.template,e.data||{},i||app.templateContext)},t}(),app.on("windowLoad",function(){return new Main})}).call(this);