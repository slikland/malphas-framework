(function(){function __addNamespace(t,e){for(k in e)t[k]||(t[k]={}),__addNamespace(t[k],e[k])}var __bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r));return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};__addNamespace(this,{slikland:{utils:{keyboard:{}}}});var __bind=function(t,e){return function(){return t.apply(e,arguments)}};slikland.utils.keyboard.Shortcut=function(){function t(t){null==t&&(t=null),this._keyDown=__bind(this._keyDown,this),t||(t=window),this._target=t,this._shortcuts=[],this._target.addEventListener("keydown",this._keyDown),this._target.addEventListener("keyup",this._keyUp)}return t.MODIFIERS=["alt","ctrl","meta","shift"],t.MAP=["tab","enter","esc"],t.KEY_MAP={9:"tab",13:"enter",27:"esc"},t.CODE_MAP={189:"-",219:"[",221:"]"},t.MODIFIER_CODES=[16,18,17,91],t.prototype.destroy=function(){var t,e;return null!=(t=this._target)&&t.removeEventListener("keydown",this._keyDown),null!=(e=this._target)&&e.removeEventListener("keyup",this._keyUp),this._shortcuts.length=0,delete this._shortcuts,delete this._target},t.prototype._keyDown=function(t){var e,n,r,i,o,s,a,h,u,c,l,d,_,p;for(o=t.keyCode,i="",s=[],this.constructor.KEY_MAP[o]?s.push(this.constructor.KEY_MAP[o]):__indexOf.call(this.constructor.MODIFIER_CODES,o)>=0||(i=this.constructor.CODE_MAP[o]?this.constructor.CODE_MAP[o].toLowerCase():String.fromCharCode(o).toLowerCase()),a=[],_=this.constructor.MODIFIERS,u=0,l=_.length;l>u;u++)r=_[u],t[r+"Key"]&&a.push(r);for(a.sort(),s.sort(),h="["+a.join("][")+"]["+s.join("][")+"]"+i,n=this._findShortcut(h),p=[],c=0,d=n.length;d>c;c++)e=n[c],"function"==typeof e.callback&&e.callback(e),p.push(e.preventDefault?t.preventDefault():void 0);return p},t.prototype._normalizeShortcut=function(t){var e,n,r,i,o;for(t=t.toLowerCase(),r=/\[(.*?)\]/g,i=[],e=[];o=r.exec(t);)n=o[1],"cmd"===n&&(n="meta"),__indexOf.call(this.constructor.MODIFIERS,n)>=0&&i.push(n),__indexOf.call(this.constructor.MAP,n)>=0&&e.push(n);return t=t.replace(/\[.*?\]/g,"").split(""),t.sort(),i.sort(),e.sort(),"["+i.join("][")+"]["+e.join("][")+"]"+t.join("")},t.prototype._findShortcut=function(t){var e,n;for(e=[],n=this._shortcuts.length;n-->0;)this._shortcuts[n].normalized===t&&e.push(this._shortcuts[n]);return e},t.prototype.addShortcut=function(t,e,n){var r,i;for(null==n&&(n=!0),i=this._normalizeShortcut(t),r=this._shortcuts.length;r-->0;)if(this._shortcuts[r].normalized===i&&this._shortcuts[r].callback===e)return;return this._shortcuts.push({normalized:i,shortcut:t,callback:e,preventDefault:n})},t.prototype.removeShortcut=function(t,e){var n,r,i;for(r=this._normalizeShortcut(t),n=this._shortcuts.length,i=[];n-->0;)i.push(this._shortcuts[n].normalized===r?!e||e&&this._shortcuts[n].callback===e?this._shortcuts.splice(n,1):void 0:void 0);return i},t}();var EventDispatcher;EventDispatcher||(EventDispatcher=function(){function t(){this._triggerStacked=__bind(this._triggerStacked,this),this.trigger=__bind(this.trigger,this)}return t.prototype._events=null,t.prototype.on=function(t,e){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),__indexOf.call(this._events[t],e)>=0?void 0:this._events[t].unshift(e)},t.prototype.off=function(t,e){var n,r;if(null==t&&(t=null),null==e&&(e=null),!this._events)return void(this._events={});if(null!=t&&Boolean(this._events[t])){if(n=this._events[t],e){for(;(r=n.indexOf(e))>=0;)n.splice(r,1);return this._events[t]=n}return this._events[t].length=0}return this._events={}},t.prototype.trigger=function(t,e,n,r){var i,o,s,a,h,u,c,l;if(null==e&&(e=null),null==n&&(n=null),null==r&&(r=null),Array.isArray(t))for(u=0,c=t.length;c>u;u++)i=t[u],this.trigger(t,e);else if(this._events||(this._events={}),o=this._events[t],o&&0!==o.length){if(n||(n=this),i={type:t,target:n,currentTarget:this,originalEvent:r},null!=r&&(i.preventDefault=function(){return"function"==typeof r.preventDefault?r.preventDefault():void 0},i.stopPropagation=function(){return"function"==typeof r.stopPropagation?r.stopPropagation():void 0}),"object"==typeof e)for(a in e)h=e[a],i[a]||(i[a]=h);for(s=o.length,l=[];s-->0;)l.push("function"==typeof o[s]?o[s](i,e):void 0);return l}},t.prototype.hasEvent=function(t,e){var n;if(!this._events)return void(this._events={});for(n in this._events)if(n===t&&this._events[n].indexOf(e)>-1)return!0;return!1},t.prototype.stackTrigger=function(t,e,n){return null==e&&(e=null),null==n&&(n=null),this._stackTriggerer||(this._stackTriggerer=[]),this._stackTriggerer.push([t,e,n]),clearTimeout(this._stackTriggerTimeout),this._stackTriggerTimeout=setTimeout(this._triggerStacked,0)},t.prototype._triggerStacked=function(){var t,e;for(e=this._stackTriggerer.length,t=-1;++t<e;)this.trigger.apply(this,this._stackTriggerer[t]);return this._stackTriggerer.length=0},t}());var App,app,windowLoaded;App=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.project_version_raw="SL_PROJECT_VERSION:1.0.0",e.project_date_raw="SL_PROJECT_DATE:1480020799493",e.FRAMEWORK_VERSION="2.2.15",e.prototype.getInfo=function(){var t;return t={},t.versionRaw=void 0===e.project_version_raw||"undefined"===e.project_version_raw?"SL_PROJECT_VERSION:Not versioned":e.project_version_raw,t.version=t.versionRaw.replace("SL_PROJECT_VERSION:",""),t.lastUpdateRaw=void 0===e.project_date_raw||"undefined"===e.project_date_raw?"SL_PROJECT_DATE:Not versioned":e.project_date_raw,t.lastUpdate=new Date(parseFloat(t.lastUpdateRaw.replace("SL_PROJECT_DATE:",""))),t},e.prototype._checkWindowActivity=function(){var t,e,n,r;return this._hidden="hidden",t=this._hidden,__indexOf.call(document,t)>=0?document.addEventListener("visibilitychange",this._windowVisibilityChange):(e=this._hidden="mozHidden",__indexOf.call(document,e)>=0?document.addEventListener("mozvisibilitychange",this._windowVisibilityChange):(n=this._hidden="webkitHidden",__indexOf.call(document,n)>=0?document.addEventListener("webkitvisibilitychange",this._windowVisibilityChange):(r=this._hidden="msHidden",__indexOf.call(document,r)>=0?document.addEventListener("msvisibilitychange",this._windowVisibilityChange):__indexOf.call(document,"onfocusin")>=0?document.onfocusin=document.onfocusout=this._windowVisibilityChange:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=this._windowVisibilityChange))),void 0!==document[this._hidden]?this._windowVisibilityChange.call(window,{type:document[this._hidden]?"blur":"focus"}):void 0},e.prototype._windowVisibilityChange=function(t){var e,n,r,i,o,s,a,h;a="visible",i="hidden",r={focus:!1,focusin:!1,pageshow:!1,blur:!0,focusout:!0,pagehide:!0},t=t||window.event,h=t.type,o=__indexOf.call(r,h)>=0?r[t.type]:document[this._hidden],n=o?"windowInactive":"windowActive";try{return this.dispatchEvent(new Event(n))}catch(u){return e=u,s=document.createEvent("Event"),s.initEvent(n,!0,!0),this.dispatchEvent(s)}},e}(EventDispatcher),app||(app=new App),windowLoaded=function(){return function(){return window.remove?window.remove("load",windowLoaded):window.detachEvent?window.detachEvent("onload",windowLoaded):window.onload=null,app.trigger("windowLoad")}}(this),window.addEventListener?window.addEventListener("load",windowLoaded):window.attachEvent?window.attachEvent("onload",windowLoaded):window.onload=windowLoaded;var isIE,__scopeIE8;isIE=function(){var t;return t=navigator.userAgent.toLowerCase(),-1!==t.indexOf("msie")?parseInt(t.split("msie")[1]):!1},8===isIE()&&(__scopeIE8=document.createElement("IE8_"+Math.random())),Function.prototype["const"]=function(t){var e,n,r,i;i=__scopeIE8?__scopeIE8:this;for(e in t)r=t[e],n={},n.get=function(){return r},n.set=function(){throw new Error("Can't set const "+e)},n.configurable=!0,n.enumerable=!0,Object.defineProperty(i,e,n);return null},Function.prototype.get=function(t,e){var n,r,i,o;n=!1,e?(n=!0,o=t):(e=t,o=__scopeIE8?__scopeIE8:this.prototype);for(i in e)r=e[i],Object.defineProperty(o,i,{get:r,configurable:!0,enumerable:n});return null},Function.prototype.set=function(t,e){var n,r,i,o;n=!1,e?(n=!0,o=t):(e=t,o=__scopeIE8?__scopeIE8:this.prototype);for(r in e)i=e[r],Object.defineProperty(o,r,{set:i,configurable:!0,enumerable:n});return null},"bind"in Function.prototype||(Function.prototype.bind=function(t){var e,n;return n=this,arguments_.length<=1?function(){return n.apply(t,arguments_)}:(e=Array.prototype.slice.call(arguments_,1),function(){return n.apply(t,0===arguments_.length?e:e.concat(Array.prototype.slice.call(arguments_)))})}),String.prototype.trim=function(t){return null==t&&(t=null),this.ltrim(t).rtrim(t)},String.prototype.ltrim=function(t){var e;return null==t&&(t=null),t||(t="\\s"),e=new RegExp("^"+t+"*"),e.global=!0,e.multiline=!0,this.replace(e,"")},String.prototype.rtrim=function(t){var e;return null==t&&(t=null),t||(t="\\s"),e=new RegExp(t+"*$"),e.global=!0,e.multiline=!0,this.replace(e,"")},String.prototype.padLeft=function(t,e){var n;for(null==e&&(e=" "),0===e.length&&(e=" "),n=this;n.length<t;)n=e+n;return n},String.prototype.padRight=function(t,e){var n;for(null==e&&(e=" "),0===e.length&&(e=" "),n=this;n.length<t;)n+=e;return n},"isArray"in Array.prototype||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(t,e){var n;for(void 0===e&&(e=0),0>e&&(e+=this.length),0>e&&(e=0),n=this.length;n>e;){if(e in this&&this[e]===t)return e;e++}return-1}),"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(t,e){for(void 0===e&&(e=this.length-1),0>e&&(e+=this.length),e>this.length-1&&(e=this.length-1),e++;e-->0;)if(e in this&&this[e]===t)return e;return-1}),"forEach"in Array.prototype||(Array.prototype.forEach=function(t,e){var n,r,i;for(n=0,r=this.length,i=[];r>n;)n in this&&t.call(e,this[n],n,this),i.push(n++);return i}),"map"in Array.prototype||(Array.prototype.map=function(t,e){var n,r,i;for(i=new Array(this.length),n=0,r=this.length;r>n;)n in this&&(i[n]=t.call(e,this[n],n,this)),n++;return i}),"filter"in Array.prototype||(Array.prototype.filter=function(t,e){var n,r,i,o;for(i=[],o=void 0,n=0,r=this.length;r>n;)n in this&&t.call(e,o=this[n],n,this)&&i.push(o),n++;return i}),"every"in Array.prototype||(Array.prototype.every=function(t,e){var n,r;for(n=0,r=this.length;r>n;){if(n in this&&!t.call(e,this[n],n,this))return!1;n++}return!0}),"some"in Array.prototype||(Array.prototype.some=function(t,e){var n,r;for(n=0,r=this.length;r>n;){if(n in this&&t.call(e,this[n],n,this))return!0;n++}return!1}),Node.prototype.on=Node.prototype.addEventListener,Node.prototype.off=Node.prototype.removeEventListener,Node.prototype.trigger=function(t,e){var n;return n=new Event(t),n.data=e,this.dispatchEvent(n)},null==navigator.mediaDevices&&(navigator.mediaDevices={}),navigator.getUserMedia=navigator.mediaDevices.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var API;API=function(_super){function API(t){if(this._loaded=__bind(this._loaded,this),this._parseJSONElement=__bind(this._parseJSONElement,this),this._progress=__bind(this._progress,this),this.submit=__bind(this.submit,this),this._submitForm=__bind(this._submitForm,this),this._addEventListeners=__bind(this._addEventListeners,this),API.__super__.constructor.apply(this,arguments),this.TYPES=["normal","json"],this._headers=[],this._reuse=!0,this._method="POST",this._jsonp=!1,this._type="normal",t instanceof HTMLElement&&"form"===t.tagName.toLowerCase())this._form=t,setTimeout(this._addEventListeners,10);else if("undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase)this._form=t,setTimeout(this._addEventListeners,10);else if("string"==typeof t)this._url=t;else if(null!=t)throw new Error("The API constructor argument needs to be a URL string or a Form element.")}return __extends(API,_super),API.COMPLETE="apiComplete",API.ERROR="apiError",API.PROGRESS="apiProgress",API._interceptors=[],API._request=function(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("MSXML2.XMLHTTP.3.0"):void 0},API.call=function(t,e,n,r,i){var o;return null==e&&(e=null),null==n&&(n=null),null==r&&(r=null),null==i&&(i="normal"),o=new API(t),t instanceof HTMLElement&&"form"===t.tagName.toLowerCase()?t.submit():"undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase&&t.submit(),n&&o.on(API.COMPLETE,n),r&&o.on(API.ERROR,r),o.type=i,o.submit(e),o},API.intercept=function(t,e){var n;for(t instanceof RegExp||(t=new RegExp(t)),n=this._interceptors.length;n-->0;)if(this._interceptors[n].regex===t&&this._interceptors[n].callback===e)return;return this._interceptors.push({regex:t,callback:e})},API.unintercept=function(t,e){var n,r;for(null==e&&(e=null),n=this._interceptors.length,r=[];n-->0;)r.push(this._interceptors[n].regex===t&&e&&this._interceptors[n].callback===e?this._interceptors.splice(n,1):void 0);return r},API._findInterceptor=function(t,e){var n,r,i;for(n=this._interceptors.length,i=[];n-->0;)r=this._interceptors[n],r.regex===t&&r.callback===e&&i.push(r);return i},API._checkInterceptor=function(t,e){var n,r,i,o;for(i=this._interceptors.length,n=-1,o=[];++n<i;)r=this._interceptors[n],r.regex.lastIndex=0,o.push(r.regex.test(t)?"function"==typeof r.callback?r.callback(e,t):void 0:void 0);return o},API.get({reuse:function(){return this._reuse}}),API.set({reuse:function(t){return this._reuse=Boolean(t)}}),API.get({type:function(){return this._type}}),API.set({type:function(t){if(!(__indexOf.call(this.TYPES,t)>=0))throw new Error("API.type can only be: "+this.TYPES.join(", "));return this._type=t}}),API.get({method:function(){return this._method}}),API.set({method:function(t){if(!/^(get|post)$/i.test(t))throw new Error("Method can only be either GET or POST");return this._method=t.toUpperCase()}}),API.get({jsonp:function(){throw new Error("Not implemented yet")}}),API.set({jsonp:function(){throw new Error("Not implemented yet")}}),API.get({data:function(){return this._data}}),API.get({requestURL:function(){return this._requestURL}}),API.prototype._addEventListeners=function(){return this._form?this._form.on("submit",this._submitForm):void 0},API.prototype._submitForm=function(){return this.submit()},API.prototype.addHeader=function(t,e){return this._headers[t]=e},API.prototype.removeHeader=function(t){return this._headers[t]=null,delete this._headers[t]},API.prototype.load=function(t,e){return null==e&&(e=null),this._url=t,this.submit(e)},API.prototype.submit=function(t){var e,n,r,i,o,s,a,h,u,c,l,d,_,p,f,g;if(null==t&&(t=null),this._data=t,!this._submitting){if(this._submitting=!0,t instanceof HTMLElement&&"form"===t.tagName.toLowerCase()?(this._form=t,t=null):"undefined"!=typeof BaseDOM&&null!==BaseDOM&&t instanceof BaseDOM&&"form"===t.element.tagName.toLowerCase&&(this._form=t,t=null),h=this._url||"",this._form)this._form.hasAttribute("action")&&(h=this._form.getAttribute("action")),this._form.hasAttribute("enctype")&&this.addHeader("Content-type",this._form.getAttribute("enctype")),this._form.hasAttribute("method")&&(this.method=this._form.getAttribute("method")),this._form.hasAttribute("type")&&"json"===this._form.getAttribute("type")?(this.addHeader("Content-type","application/json;charset=UTF-8"),t=JSON.stringify(this._parseJSON(this._form))):t=new FormData(this._form);else if("normal"===this._type){if(t||(t=new FormData),t&&!(t instanceof FormData)){e=new FormData;for(o in t)c=t[o],e.append(o,c);t=e}}else"json"===this._type&&(this.addHeader("Content-type","application/json;charset=UTF-8"),t=JSON.stringify(t));if(r={},u=window.location.search)for(u=u.replace(/^\??/,"").split("&"),l=0,d=u.length;d>l;l++)a=u[l],s=a.split("="),(null!=(_=s[0])?_.trim().length:void 0)>0&&(r[s[0].trim()]=null!=(p=s[1])?p.trim():void 0);n=[];for(i in r)c=r[i],n.push(i+"="+c);if(n=n.join("&"),n.length>0&&(h+=h.indexOf("?")>=0?"&"+n:"?"+n),this._requestURL=h,this._request=API._request(),this._request.onreadystatechange=this._loaded,null!=(f=this._request.upload)&&f.addEventListener("progress",this._progress),this._request.addEventListener("progress",this._progress),this._request.open(this.method,h,!0),this._headers){g=this._headers;for(i in g)c=g[i],this._request.setRequestHeader(i,c)}this._request.send(t)}},API.prototype._progress=function(t){var e;return e=t.loaded>t.total?.5:t.loaded/t.total,e*=.5,t.currentTarget!==this._request.upload&&(e+=.5),this._triggerProgress(e)},API.prototype._triggerProgress=function(t){return this.trigger(API.PROGRESS,{loaded:t,total:1,progress:t})},API.prototype._parseJSON=function(t){var e;return this._parsedElements=[],e=this._parseJSONElement(t)},API.prototype._parseJSONElement=function(t,e){var n,r,i,o,s,a,h,u,c,l,d,_,p,f,g;for(null==e&&(e=0),u=t.querySelectorAll("[json-name]"),l={},o="",i=e;i-->0;)o+=" ";for(n=0,_=0,f=u.length;f>_;_++)h=u[_],this._parsedElements.indexOf(h)>=0||(this._parsedElements.push(h),c=h.getAttribute("json-name"),(r=this._parseJSONElement(h,e+2))&&(l[c]||(l[c]=[]),l[c].push(r)));for(a=t.querySelectorAll("input,textarea"),p=0,g=a.length;g>p;p++)if(s=a[p],!(this._parsedElements.indexOf(s)>=0)){if(this._parsedElements.push(s),d=s.value,s.hasAttribute("type"))switch(s.getAttribute("type").toLowerCase()){case"radio":case"checkbox":if(l[s.name]||(l[s.name]=[]),!s.checked)continue}l[s.name]?(Array.isArray(l[s.name])||(l[s.name]=[l[s.name]]),l[s.name].push(d)):l[s.name]=d}return l},API.prototype.abort=function(){return this._submitting=!1,this._request&&(this._request.onreadystatechange=null,this._request.abort()),this._reuse?void 0:this.off()},API.prototype._loaded=function(e){var data,response;if(4===e.currentTarget.readyState){if(this._submitting=!1,200===e.currentTarget.status){this._triggerProgress(1),response=e.currentTarget.responseText||e.currentTarget.response||"";try{data=eval("("+response+")")}catch(_error){e=_error;try{data=JSON.stringify(response)}catch(_error){}}return data?"string"==typeof data&&(data=response):data=response,(null!=data?data.error:void 0)?this._loadError(data):this._loadSuccess(data)}return this._loadError(404===e.currentTarget.status?{message:""}:{message:""})}},API.prototype._loadSuccess=function(t){return null==t&&(t=null),this.trigger(API.COMPLETE,t),this.constructor._checkInterceptor(this._requestURL,t)},API.prototype._loadError=function(t){return null==t&&(t=null),this.trigger(API.ERROR,t),this.constructor._checkInterceptor(this._requestURL,t)},API}(EventDispatcher);var LiveEditor;LiveEditor=function(t){function e(t){this._shortcutCommand=__bind(this._shortcutCommand,this),this._removeEventListeners=__bind(this._removeEventListeners,this),this._addEventListeners=__bind(this._addEventListeners,this),this._discardChanges=__bind(this._discardChanges,this),this._commitChanges=__bind(this._commitChanges,this),this._stopEdit=__bind(this._stopEdit,this),this._startEdit=__bind(this._startEdit,this),this._target=t,this._target.addEventListener("dblclick",this._startEdit),this._shortcut=new slikland.utils.keyboard.Shortcut(this._target),this._shortcutCommands={}}return __extends(e,t),e.prototype._startEdit=function(){return this._initialContent=this._target.innerHTML,this._addEventListeners(),this._target.contentEditable=!0,this._target.focus()},e.prototype._stopEdit=function(){return this._removeEventListeners(),this._target.contentEditable=!1},e.prototype._commitChanges=function(){var t;return this._stopEdit(),"function"==typeof(t=this._target).normalize&&t.normalize(),this._initialContent=null,this.trigger("change")},e.prototype._discardChanges=function(){return this._stopEdit(),this._target.innerHTML=this._initialContent},e.prototype._addEventListeners=function(){return this._target.addEventListener("blur",this._commitChanges),this._shortcut.addShortcut("[cmd][enter]",this._commitChanges),this._shortcut.addShortcut("[esc]",this._discardChanges)},e.prototype._removeEventListeners=function(){return this._target.removeEventListener("blur",this._commitChanges),this._shortcut.removeShortcut("[cmd][enter]",this._commitChanges),this._shortcut.removeShortcut("[esc]",this._discardChanges)},e.prototype._shortcutCommand=function(t){return this._shortcutCommands[t.shortcut]?document.execCommand(this._shortcutCommands[t.shortcut].command,!0,this._shortcutCommands[t.shortcut].value):void 0},e.prototype.addShortcutCommand=function(t,e,n){return null==n&&(n=null),this._shortcutCommands[t]={command:e,value:n},this._shortcut.addShortcut(t,this._shortcutCommand)},e}(EventDispatcher);var NumberUtils;NumberUtils=function(){function t(){}return t.isEven=function(t){return t%2===0?!0:!1},t.isZero=function(t){return Math.abs(t)<1e-5},t.toPercent=function(t,e,n){return(t-e)/(n-e)*100},t.percentToValue=function(t,e,n){return(n-e)*t+e},t.getBytesAsMegabytes=function(t){return Math.floor(t/1024/1024*100)/100+" MB"},t.bytesTo=function(t){return t>=1e9?(t/1e9).toFixed(2)+" GB":t>=1e6?(t/1e6).toFixed(2)+" MB":t>=1e3?(t/1e3).toFixed(2)+" KB":t>1?t+" bytes":1===t?t+" byte":"0 byte"},t.rangeRandom=function(t,e,n){return null==n&&(n=!1),n?Math.round(Math.round(Math.random()*(e-t))+t):Math.random()*(e-t)+t},t.distanceBetweenCoordinates=function(t,e,n){var r,i,o,s,a;switch(null==n&&(n="km"),n){case"km":a=6371;break;case"meters":a=6378e3;break;case"feet":a=20925525;break;case"miles":a=3963}return o=(e.x-t.x)*Math.PI/180,s=(e.y-t.y)*Math.PI/180,r=Math.sin(o/2)*Math.sin(o/2)+Math.sin(s/2)*Math.sin(s/2)*Math.cos(t.x*Math.PI/180)*Math.cos(e.x*Math.PI/180),i=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),a*i},t}();var ArrayUtils;ArrayUtils=function(){function t(){}return t.removeItem=function(t,e,n){var r,i,o,s,a;for(null==n&&(n=!1),i=n?t.slice(0):t,o=s=0,a=i.length;a>s;o=++s)r=i[o],r===e&&i.splice(o,1);return i},t.removeItemByIndex=function(t,e,n){var r;return null==n&&(n=!1),r=n?e.slice(0):e,r.splice(t,1),r},t.removeDuplicateStrings=function(t,e){return null==e&&(e=!1),t.filter(function(t,e,n){return n.indexOf(t)===e})},t.hasItem=function(t,e){return e.indexOf(t)>-1},t.merge=function(t,e){var n,r,i;for(n=0,r=0,i=[];n<t.length||r<e.length;)n<t.length&&(i.push(t[n]),n++),r<e.length&&(i.push(e[r]),r++);return i},t.randomIndex=function(t){return NumberUtils.rangeRandom(0,t.length-1,!0)},t.randomItem=function(e){return e[t.randomIndex(e)]},t.shuffle=function(t,e){var n,r,i,o,s,a,h;for(null==e&&(e=!1),o=e?t.slice(0):t,n=a=0,h=o.length;h>a;n=++a)r=o[n],i=Math.floor(Math.random()*o.length),s=o[n],o[n]=o[i],o[i]=s;return o},t.move=function(t,e,n,r){var i,o;if(null==r&&(r=!1),o=r?t.slice(0):t,n>=o.length)for(i=new_index-o.length;i--+1;)o.push(void 0);return o.splice(n,0,o.splice(e,1)[0]),o},t.fromMiddleToEnd=function(t){var e,n,r,i,o;return r=t.length,o=Math.floor(.5*r),e=t.slice(o,r),n=t.slice(0,o).reverse(),i=this.merge(e,n)},t.fromEndToMiddle=function(t){return this.fromMiddleToEnd(t).reverse()},t.lastIndexOf=function(t,e){var n,r,i;for(n=0,i=t.length,r=-1;n!==i;)t[n]===e&&(r=n),n++;return r},t.toArray=function(t){var e,n;if(n=[],t.length)for(e=t.length;e-->0;)n[e]=t[e];return n},t}();var Nav;Nav=function(t){function e(){this._linkClick=__bind(this._linkClick,this),this._parseNodes=__bind(this._parseNodes,this),this._change=__bind(this._change,this),this._navLoaded=__bind(this._navLoaded,this),this._target=document.querySelector("nav"),API.call("data/nav.html",null,this._navLoaded)}return __extends(e,t),e.prototype._navLoaded=function(t,e){return this._target.innerHTML=e,this._parseLinks(),this._content=document.querySelector("content"),this._content||(this._content=document.createElement("content"),this._target.appendChild(this._content)),this._navEditor=new LiveEditor(this._content),this._navEditor.on("change",this._change),this._navEditor.addShortcutCommand("[cmd][","outdent"),this._navEditor.addShortcutCommand("[cmd]]","indent"),this.trigger("ready")},e.prototype._change=function(){var t,e,n,r,i,o;this._links=[],this._parseNodes(this._content),i=[],o=this._links;for(n in o)e=o[n],r={},e.getAttribute("href")&&(r.prev=e.getAttribute("href")),r.name=(Number(n)+1).toString().padLeft(4,"0")+"."+e.innerText.replace(/[^a-z0-9]/gi,"-"),e.href=r.name,i.push(r);return t={},t.pages=i,t.raw=this._target.innerHTML,this._parseLinks(),API.call("php/editNav.php",t,null,null,"json")},e.prototype._parseNodes=function(t){var e,n,r,i,o,s,a;for(o=t.childNodes,a=[],r=0,i=o.length;i>r;r++)n=o[r],"a"===(null!=(s=n.tagName)?s.toLowerCase():void 0)?a.push(0===n.innerText.trim().length?t.removeChild(n):this._links.push(n)):3===n.nodeType?0===n.data.trim().length?a.push(t.removeChild(n)):(e=document.createElement("a"),e.innerText=n.data,this._links.push(e),a.push(t.replaceChild(e,n))):a.push(this._parseNodes(n));return a},e.prototype._parseLinks=function(){var t,e,n;for(this._links=ArrayUtils.toArray(this._target.querySelectorAll("a")),t=this._links.length,n=[];t-->0;)e=this._links[t],n.push(e.addEventListener("click",this._linkClick));return n},e.prototype._linkClick=function(t){var e;return e=t.currentTarget,t.preventDefault(),t.stopImmediatePropagation(),app.router.goto(e.getAttribute("href"))},e.prototype.isValid=function(t){var e,n,r;for(n=this._links.length;n-->0;)if(r=this._links[n],e=r.getAttribute("href"),e===t)return!0;return!1},e.prototype.select=function(t){var e,n,r,i,o;for(r=this._links.length,o=[];r-->0;)i=this._links[r],n=i.getAttribute("href"),e="",n===t&&(e="selected"),o.push(i.className=e);return o},e}(EventDispatcher);var Content;Content=function(){function t(){this._change=__bind(this._change,this),this._contentLoaded=__bind(this._contentLoaded,this),this._onPaste=__bind(this._onPaste,this),this._target=document.querySelector("main"),this._api=new API,this._api.on(API.COMPLETE,this._contentLoaded),this._api.reuse=!0,this._contentEditor=new LiveEditor(this._target),this._contentEditor.on("change",this._change),this._contentEditor.addShortcutCommand("[cmd][","outdent"),this._contentEditor.addShortcutCommand("[cmd]]","indent"),this._contentEditor.addShortcutCommand("[cmd][alt]1","formatBlock","h1"),this._contentEditor.addShortcutCommand("[cmd][alt]2","formatBlock","h2"),this._contentEditor.addShortcutCommand("[cmd][alt]3","formatBlock","h3"),this._contentEditor.addShortcutCommand("[cmd][alt]4","formatBlock","h4"),this._contentEditor.addShortcutCommand("[cmd][alt]5","formatBlock","h5"),this._contentEditor.addShortcutCommand("[cmd][alt]6","formatBlock","h6"),this._contentEditor.addShortcutCommand("[cmd][alt]-","insertHorizontalRule"),this._contentEditor.addShortcutCommand("[cmd][alt]e","formatBlock","pre"),this._contentEditor.addShortcutCommand("[cmd][alt]o","insertOrderedList"),this._contentEditor.addShortcutCommand("[cmd][alt]l","insertUnorderedList"),this._target.addEventListener("paste",this._onPaste)}return t.prototype._onPaste=function(t){var e,n,r,i,o;for(i=t.clipboardData.items,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(console.log(e));return o},t.prototype._contentLoaded=function(t,e){return this._target.innerHTML=e},t.prototype._change=function(){var t;return t={},t.content=this._target.innerHTML,t.page=this._currentPage,API.call("php/editPage.php",t,null,null,"json")},t.prototype.show=function(t){return this._api.abort(),this._currentPage=t,this._api.load("data/pages/"+t+".html")},t}();var NavigationRouter;NavigationRouter=function(t){function e(){this._onPathChange=__bind(this._onPathChange,this),this._routes=[],this._numRoutes=0,this._trigger=!0,e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.CHANGE="route_path_change",e.CHANGE_ROUTE="route_match",e.prototype.setup=function(t,e){var n,r,i,o;if(null==t&&(t=null),null==e&&(e=!1),!t){t=window.location.href;try{n=document.getElementsByTagName("base"),n.length>0&&(n=n[0],t=n.getAttribute("href"))}catch(s){r=s,console.log(r.stack)}}return this._rootPath=t.replace(/^(.*?)\/*$/,"$1/"),this._rawPath="",this._usePushState=e?!1:null!=("undefined"!=typeof window&&null!==window&&null!=(o=window.history)?o.pushState:void 0),this._usePushState?(this._rootPath!==window.location.href&&(i=this._getPath(),this.goto(i,!1)),window.addEventListener?window.addEventListener("popstate",this._onPathChange):window.attachEvent("onpopstate",this._onPathChange)):(this._rootPath!==window.location.href&&(i=this._getPath(),window.location=this._rootPath+"#!/"+i),window.addEventListener?window.addEventListener("hashchange",this._onPathChange):window.attachEvent("onhashchange",this._onPathChange)),this._onPathChange(),this},e.prototype._getPath=function(){var t;return t=window.location.href.replace(/\/*$/g,""),0===t.indexOf(this._rootPath.replace(/\/*$/g,""))&&(t=t.substr(this._rootPath.length)),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1")},e.prototype._parsePath=function(t){var e,n,r;return r=/^(?:#?!?\/*)([^?]*)\??(.*?)$/.exec(t),n=r[1],e=this._parseParams(r[2]),{rawPath:t,path:n,params:e}},e.prototype._parseParams=function(t){var e,n,r,i;if(i={},t)for(r=/&?([^=&]+)=?([^=&]*)/g,e=0;n=r.exec(t);)i[n[1]]=n[2];return i},e.prototype._onPathChange=function(t){return null==t&&(t=null),this._currentPath=this._getPath(),this._trigger&&this._triggerPath(this._currentPath),this._trigger=!0,this._replaceData?(this.goto(this._replaceData[0],!1),this._replaceData=null):this.trigger(e.CHANGE,this._parsePath(this._currentPath)),!1},e.prototype._triggerPath=function(t){var n,r,i,o,s,a;if(r=this._parsePath(t),a=this._checkRoutes(r.path),s=a[0],o=a[1],s)for(n=s.length;n-->0;)i=s[n],this.trigger(e.CHANGE_ROUTE,{route:i.route,routeData:o,path:t,pathData:r,data:i.data});return!1},e.prototype.getCurrentPath=function(){return this._currentPath},e.prototype.getParsedPath=function(){return this._parsePath(this._currentPath)},e.prototype.goto=function(t,e){return null==e&&(e=!0),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1"),t!==this._currentPath?(this._currentPath=t,this._trigger=e,this._usePushState?(history.pushState({},t,this._rootPath+t),this._trigger&&this._onPathChange(),this._trigger=!0):window.location.hash="!/"+t,!1):void 0},e.prototype.replace=function(t,e){return null==e&&(e=!1),t=t.replace(/^(?:#?!?\/*)([^?]*\??.*?)$/,"$1"),t!==this._currentPath&&(this._currentPath=t,this._usePushState?history.replaceState({},t,this._rootPath+t):(this._trigger=!1,history.back(),this._replaceData=[t])),e&&this.triggerPath(t),!1},e.prototype.triggerPath=function(t){return this._triggerPath(t),!1},e.prototype.triggerCurrentPath=function(){return this._triggerPath(this._getPath()),!1},e.prototype.addRoute=function(t,e){var n,r,i,o,s,a,h;if(null==e&&(e=null),"string"!=typeof t)for(r=t.length;r-->0;)this.addRoute(t[r],e);for(a=/\{(.*?)\}/g,i=[],s=0;o=a.exec(t);)i[s++]=o[1];a=t,"*"===a&&(a=".*");try{a=a.replace(/(.*?)\/*$/,"$1"),h=new RegExp("(?:"+a.replace(/\{.*?\}/g,"(.+?)")+"$)","g")}catch(u){return n=u,void console.log(n.stack)}return this._routes[this._numRoutes++]={data:e,route:t,routeRE:h,labels:i,numLabels:i.length,numSlashes:t.split("/").length},this._routes.sort(this._sortRoutes),!1},e.prototype.removeRoute=function(t){var e,n;for(e=this._numRoutes;e-->0;)n=this._routes[e],n.route===t&&this._routes.splice(e,1);return this._numRoutes=this._routes.length,!1},e.prototype.removeAllRoutes=function(){return this._routes.length=0,this._numRoutes=this._routes.length},e.prototype._checkRoutes=function(t){var e,n,r,i,o,s,a,h,u,c,l,d,_,p;for(r=this._numRoutes,n=null,e=null,u=[],c=0,t="/"+t;r-->0;){if(h=this._routes[r],n){if(h.route!==n)break;u[c++]=h}if(a=h.routeRE,a.lastIndex=0,s=a.exec(t))for(e={},u[c++]=h,n=h.route,p=h.labels,i=d=0,_=p.length;_>d;i=++d)o=p[i],l=s[i+1],e[o]=l}return[u,e]},e.prototype._sortRoutes=function(t,e){return t.numLabels<e.numLabels?-1:t.numLabels>e.numLabels?1:t.numSlashes<e.numSlashes?-1:t.numSlashes>e.numSlashes?1:t.route===e.route?0:t.route<e.route?-1:t.route>e.route?1:0
},e.prototype._getParams=function(){var t,e,n,r,i;r=this._parsePath(this._currentPath),n=r.params;for(e in n){i=n[e],i=decodeURIComponent(i);try{t=JSON.parse(i),"string"!=typeof t&&(i=t)}catch(o){}n[e]=i}return n},e.prototype._setParams=function(t){var e,n,r,i,o;i=this._parsePath(this._currentPath),n=[];for(e in t){o=t[e];try{"string"!=typeof o&&(o=JSON.stringify(o))}catch(s){}n.push(e+"="+encodeURIComponent(o)),t[e]=o}return r=i.path,n.length>0&&(r=r+"?"+n.join("&")),this.replace(r)},e.prototype.getParam=function(t){var e;return e=this._getParams(),e[t]},e.prototype.setParam=function(t,e){var n;return n=this._getParams(),n[t]=e,this._setParams(n)},e.prototype.removeParam=function(t){var e;return e=this._getParams(),e[t]=null,delete e[t],this._setParams(e)},e}(EventDispatcher);var Main;Main=function(){function t(){this._routeChange=__bind(this._routeChange,this),this._navReady=__bind(this._navReady,this),this._emptyCallback=__bind(this._emptyCallback,this),this._nav=new Nav,this._content=new Content,this._nav.on("ready",this._navReady),this._shortcutPrevent=new slikland.utils.keyboard.Shortcut(window),this._shortcutPrevent.addShortcut("[cmd]s",this._emptyCallback)}return t.prototype._emptyCallback=function(){},t.prototype._navReady=function(){return app.router=new NavigationRouter(app.basePath),app.router.on(NavigationRouter.CHANGE,this._routeChange),app.router.setup(app.basePath)},t.prototype._routeChange=function(t,e){var n;return n=e.path,n=n.trim("/"),!this._nav.isValid(n)&&n.length>0?void app.router.goto("/"):(0===n.length&&(n="index"),this._nav.select(n),this._content.show(n))},t}(),app.on("windowLoad",function(){return new Main})}).call(this);